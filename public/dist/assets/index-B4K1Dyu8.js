const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/flv-BrAw5_su.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/shaka-player.compiled-B5vUFVij.js"])))=>i.map(i=>d[i]);
import{r as ae,o as pr,a as Sr,c as W,b as U,d as l,e as vt,t as He,f as wt,g as De,u as et,F as ft,h as _t,w as it,i as kt,v as ar,j as Wt,k as jt,l as Gr,n as ma,m as yt,T as Da,p as Tr,q as Pr,s as Ha,x as za,y as ga,z as Va,A as Ua}from"./bootstrap-Bn5f6dfe.js";const $r=new Map,lr=new Map,Wa=200,ka=()=>Date.now(),Sa=a=>{const p=typeof a=="string"?a.trim():"";return p||""},Ka=(a,p,s)=>{const x=Sa(p),t=String(a||"GET").toUpperCase(),e=s==null?"":typeof s=="string"?s:JSON.stringify(s);return`${t} ${x} ${e}`},Xa=(a,p)=>{if(!(p>0))return null;const s=lr.get(a);return!s||!s.t?null:ka()-s.t>=p?(lr.delete(a),null):(lr.delete(a),lr.set(a,s),s.v)},Ga=(a,p)=>{for(lr.set(a,{t:ka(),v:p});lr.size>Wa;){const s=lr.keys().next().value;if(!s)break;lr.delete(s)}},Ya=async(a,p)=>{const s=Number(p);if(!Number.isFinite(s)||s<=0)return await a;let x=0;const t=new Promise((e,u)=>{x=setTimeout(()=>u(new Error("请求超时")),s)});try{return await Promise.race([a,t])}finally{clearTimeout(x)}},Br=a=>{const p=a&&typeof a=="object"?a:null;if(!p)return"";const s=new URLSearchParams;Object.keys(p).forEach(t=>{const e=p[t];if(e!=null){if(Array.isArray(e)){e.forEach(u=>{u!=null&&s.append(t,String(u))});return}s.set(t,String(e))}});const x=s.toString();return x?`?${x}`:""},Za=async a=>{try{return await a.json()}catch{return null}};class Ja extends Error{constructor(p,s,x){super(p||"请求失败"),this.name="ApiError",this.status=typeof s=="number"?s:0,this.data=x}}const Fr=async(a,p={})=>{const s=Sa(a);if(!s)throw new Error("url 不能为空");const x=p&&typeof p=="object"?p:{},t=String(x.method||"GET").toUpperCase(),e=x.timeoutMs!=null?Number(x.timeoutMs):15e3,u=x.dedupe!==!1,r=x.cacheMs!=null?Number(x.cacheMs):0,n=x.body!=null?x.body:null,o=Ka(t,s,n),i=Xa(o,r);if(i!=null)return i;if(u&&$r.has(o))return await $r.get(o);const c=(async()=>{const f=Object.assign({},x.headers||{}),g={method:t,credentials:x.credentials||"same-origin",cache:x.cache||"no-store",headers:f};n!=null&&(g.body=typeof n=="string"?n:JSON.stringify(n),!f["Content-Type"]&&!f["content-type"]&&(f["Content-Type"]="application/json"));const y=await Ya(fetch(s,g),e),C=y&&typeof y.status=="number"?y.status:0,A=await Za(y);if(!y||!y.ok){const H=A&&typeof A=="object"?String(A.message||A.error||A.msg||`HTTP ${C}`):`HTTP ${C||0}`;throw new Ja(H||"请求失败",C,A)}return r>0&&Ga(o,A),A})();$r.set(o,c);try{return await c}finally{$r.get(o)===c&&$r.delete(o)}},sr=async(a,p={})=>await Fr(a,{...p||{},method:"GET"}),ir=async(a,p,s={})=>await Fr(a,{...s||{},method:"POST",body:p}),Qa=async(a,p,s={})=>{const x=p&&typeof p=="object"?p:{},t=new URLSearchParams;return Object.keys(x).forEach(e=>{const u=x[e];u!=null&&t.set(e,String(u))}),await Fr(a,{...s||{},method:"POST",body:t.toString(),headers:{"Content-Type":"application/x-www-form-urlencoded",...s&&s.headers?s.headers:{}}})},ya=async(a,p,s={})=>await Fr(a,{...s||{},method:"PUT",body:p}),es={class:"flex"},ts={id:"desktopSidebar","data-sidebar":"true",class:"sidebar fixed top-0 left-0 h-screen bg-white/40 backdrop-blur-xl transition-all duration-300 border-r border-gray-200/50 z-10 shadow-lg w-64",style:{"backdrop-filter":"blur(20px)","-webkit-backdrop-filter":"blur(20px)"}},rs={class:"flex h-full flex-col min-h-0"},as={class:"relative h-16"},ss={class:"brand-box absolute inset-0 flex items-center justify-center transition-opacity duration-200 opacity-100"},ns={class:"w-[calc(100%-4rem)] flex justify-center"},os={class:"text-2xl font-bold text-green-600 tracking-tight"},is={class:"px-2 mt-4 space-y-1 flex-1 min-h-0 flex flex-col"},ls={class:"space-y-1 flex-shrink-0"},cs=["data-active"],us=["data-active"],ds=["data-active"],ps=["data-active"],fs=["data-active"],hs=["data-active"],vs=["data-active"],ms={key:0,class:"mt-6 flex-1 min-h-0 flex flex-col"},gs={class:"relative flex-1 min-h-0 flex flex-col"},ys=["id"],bs=["onClick","data-site-key","data-site-api","data-active"],ws={class:"nav-label whitespace-nowrap transition-opacity duration-200 opacity-100"},xs=["onClick","data-site-key","data-site-api","data-active"],ks={class:"nav-label whitespace-nowrap transition-opacity duration-200 opacity-100"},Ss={key:2,class:"px-4 py-2 text-sm text-gray-400 select-none"},jr="tv_server_last_site_key",Lr="tv_server_home_view",_s="tv_server_last_site_name",Es={__name:"AppSidebar",props:{bootstrap:{type:Object,required:!0},activePage:{type:String,default:""},doubanType:{type:String,default:""},activeSiteKey:{type:String,default:""},showSiteNav:{type:Boolean,default:!0},siteNavVariant:{type:String,default:"links"},showSiteNavOverlays:{type:Boolean,default:!1}},setup(a){const p=a,s=ae("home"),x=ae(""),t=ae((()=>{const $=p.bootstrap&&p.bootstrap.user&&p.bootstrap.user.role?String(p.bootstrap.user.role):"",S=p.bootstrap&&p.bootstrap.settings&&typeof p.bootstrap.settings.userCatPawOpenApiBase=="string"?p.bootstrap.settings.userCatPawOpenApiBase.trim():"";return $==="user"&&!S?[]:p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.homeSites)?p.bootstrap.settings.homeSites:[]})()),e=ae(!1),u=$=>(Array.isArray($)?$:[]).map(P=>({key:P&&typeof P.key=="string"?P.key:"",name:P&&typeof P.name=="string"?P.name:"",api:P&&typeof P.api=="string"?P.api:"",enabled:P&&typeof P.enabled=="boolean"?P.enabled:!0,home:P&&typeof P.home=="boolean"?P.home:!0})).filter(P=>P.key&&P.api),r=async()=>{if(!e.value){e.value=!0;try{const $=await sr("/api/user/sites",{cacheMs:2e3});if(!$||$.success!==!0)throw new Error($&&$.message||"加载失败");const S=u($.sites);t.value=S.filter(P=>P.enabled&&P.home).map(({key:P,name:J,api:oe})=>({key:P,name:J,api:oe}));try{typeof window<"u"&&requestAnimationFrame(()=>{window.dispatchEvent(new CustomEvent("tv:sidebar-sites-updated"))})}catch{}}catch{}finally{e.value=!1}}},n=()=>{try{const $=(localStorage.getItem(Lr)||"").trim();s.value=$&&$.startsWith("douban:")?$:"home"}catch{s.value="home"}try{const $=(localStorage.getItem(jr)||"").trim();x.value=$&&$!=="home"?$:""}catch{x.value=""}},o=$=>{const S=$&&$.key?String($.key):"";(!S||S===jr||S===Lr)&&n()},i=$=>{const S=$&&$.detail&&typeof $.detail.view=="string"?$.detail.view.trim():"";S&&(s.value=S==="search"?"search":S.startsWith("douban:")?S:"home",(S==="home"||S==="search"||S.startsWith("douban:"))&&(x.value=""))};typeof window<"u"&&n(),pr(()=>{typeof window>"u"||(window.addEventListener("storage",o),window.addEventListener("tv:home-view",i),window.addEventListener("tv:user-settings-updated",r),r())}),Sr(()=>{typeof window>"u"||(window.removeEventListener("storage",o),window.removeEventListener("tv:home-view",i),window.removeEventListener("tv:user-settings-updated",r))});const c=$=>{try{const S=$&&typeof $=="object"?typeof $.key=="string"?$.key.trim():"":typeof $=="string"?$.trim():"";if(!S)return;const P=$&&typeof $=="object"&&typeof $.name=="string"?$.name.trim():"";localStorage.setItem(jr,S),localStorage.setItem(Lr,"home"),P&&localStorage.setItem(_s,P),x.value=S,s.value="home"}catch{}},f=()=>{try{localStorage.setItem(jr,"home"),localStorage.setItem(Lr,"home"),x.value="",s.value="home"}catch{}},g=$=>{try{const S=typeof $=="string"?$.trim():"";if(!S)return;localStorage.setItem(jr,"home"),localStorage.setItem(Lr,`douban:${S}`),x.value="",s.value=`douban:${S}`}catch{}},y=()=>{try{x.value="",s.value="search"}catch{}},C=$=>{g($);try{window.dispatchEvent(new CustomEvent("tv:home-view",{detail:{view:`douban:${$}`}}))}catch{}},A=()=>{f();try{window.dispatchEvent(new CustomEvent("tv:home-view",{detail:{view:"home"}}))}catch{}},H=()=>{y();try{window.dispatchEvent(new CustomEvent("tv:home-view",{detail:{view:"search"}}))}catch{}},w=s,_=De(()=>p.activePage?p.activePage:typeof window>"u"?"":"home"),M=x;return($,S)=>(U(),W("div",es,[l("aside",ts,[l("div",rs,[l("div",as,[l("div",ss,[l("div",ns,[l("span",os,He(a.bootstrap.siteName),1)])]),S[8]||(S[8]=vt('<button id="sidebarToggleBtn" class="absolute top-1/2 -translate-y-1/2 flex items-center justify-center w-8 h-8 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100/50 transition-colors duration-200 z-10 right-2" type="button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu h-4 w-4"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button>',1))]),l("nav",is,[l("div",ls,[_.value==="home"||_.value==="play"?(U(),W("button",{key:0,type:"button",class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start w-full","data-active":_.value==="home"&&et(w)==="home"&&!et(M),onClick:A},[...S[9]||(S[9]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path><path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">首页</span>',2)])],8,cs)):(U(),W("a",{key:1,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/","data-active":_.value==="home"&&et(w)==="home"&&!et(M),onClick:f},[...S[10]||(S[10]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path><path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">首页</span>',2)])],8,us)),_.value!=="home"&&_.value!=="play"?(U(),W("a",{key:2,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/",onClick:y},[...S[11]||(S[11]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">搜索</span>',2)])])):(U(),W("button",{key:3,type:"button",class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start w-full","data-active":_.value==="home"&&et(w)==="search",onClick:H},[...S[12]||(S[12]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">搜索</span>',2)])],8,ds)),_.value==="home"||_.value==="play"?(U(),W("button",{key:4,type:"button",class:"nav-item group flex items-center rounded-lg px-2 mt-4 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start w-full","data-active":_.value==="home"&&!et(M)&&et(w)==="douban:movie",onClick:S[0]||(S[0]=P=>C("movie"))},[...S[13]||(S[13]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-film h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M7 3v18"></path><path d="M3 7.5h4"></path><path d="M3 12h18"></path><path d="M3 16.5h4"></path><path d="M17 3v18"></path><path d="M17 7.5h4"></path><path d="M17 16.5h4"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">电影</span>',2)])],8,ps)):(U(),W("a",{key:5,class:"nav-item group flex items-center rounded-lg px-2 mt-4 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/",onClick:S[1]||(S[1]=P=>g("movie"))},[...S[14]||(S[14]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-film h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M7 3v18"></path><path d="M3 7.5h4"></path><path d="M3 12h18"></path><path d="M3 16.5h4"></path><path d="M17 3v18"></path><path d="M17 7.5h4"></path><path d="M17 16.5h4"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">电影</span>',2)])])),_.value==="home"||_.value==="play"?(U(),W("button",{key:6,type:"button",class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start w-full","data-active":_.value==="home"&&!et(M)&&et(w)==="douban:tv",onClick:S[2]||(S[2]=P=>C("tv"))},[...S[15]||(S[15]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tv h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><rect width="20" height="15" x="2" y="7" rx="2" ry="2"></rect><polyline points="17 2 12 7 7 2"></polyline></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">剧集</span>',2)])],8,fs)):(U(),W("a",{key:7,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/",onClick:S[3]||(S[3]=P=>g("tv"))},[...S[16]||(S[16]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tv h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><rect width="20" height="15" x="2" y="7" rx="2" ry="2"></rect><polyline points="17 2 12 7 7 2"></polyline></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">剧集</span>',2)])])),_.value==="home"||_.value==="play"?(U(),W("button",{key:8,type:"button",class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start w-full","data-active":_.value==="home"&&!et(M)&&et(w)==="douban:anime",onClick:S[4]||(S[4]=P=>C("anime"))},[...S[17]||(S[17]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cat h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><path d="M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21s-9-3-9-7.56c0-1.25.5-2.4 1-3.44 0 0-1.89-6.42-.5-7 1.39-.58 4.72.23 6.5 2.23A9.04 9.04 0 0 1 12 5Z"></path><path d="M8 14v.5"></path><path d="M16 14v.5"></path><path d="M11.25 16.25h1.5L12 17l-.75-.75Z"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">动漫</span>',2)])],8,hs)):(U(),W("a",{key:9,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/",onClick:S[5]||(S[5]=P=>g("anime"))},[...S[18]||(S[18]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cat h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><path d="M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21s-9-3-9-7.56c0-1.25.5-2.4 1-3.44 0 0-1.89-6.42-.5-7 1.39-.58 4.72.23 6.5 2.23A9.04 9.04 0 0 1 12 5Z"></path><path d="M8 14v.5"></path><path d="M16 14v.5"></path><path d="M11.25 16.25h1.5L12 17l-.75-.75Z"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">动漫</span>',2)])])),_.value==="home"||_.value==="play"?(U(),W("button",{key:10,type:"button",class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start w-full","data-active":_.value==="home"&&!et(M)&&et(w)==="douban:show",onClick:S[6]||(S[6]=P=>C("show"))},[...S[19]||(S[19]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clover h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><path d="M16.17 7.83 2 22"></path><path d="M4.02 12a2.827 2.827 0 1 1 3.81-4.17A2.827 2.827 0 1 1 12 4.02a2.827 2.827 0 1 1 4.17 3.81A2.827 2.827 0 1 1 19.98 12a2.827 2.827 0 1 1-3.81 4.17A2.827 2.827 0 0 1 12 19.98a2.827 2.827 0 0 1-4.17-3.81A1 1 0 1 1 4 12"></path><path d="m7.83 7.83 8.34 8.34"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">综艺</span>',2)])],8,vs)):(U(),W("a",{key:11,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/",onClick:S[7]||(S[7]=P=>g("show"))},[...S[20]||(S[20]=[vt('<div class="w-4 h-4 flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clover h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700"><path d="M16.17 7.83 2 22"></path><path d="M4.02 12a2.827 2.827 0 1 1 3.81-4.17A2.827 2.827 0 1 1 12 4.02a2.827 2.827 0 1 1 4.17 3.81A2.827 2.827 0 1 1 19.98 12a2.827 2.827 0 1 1-3.81 4.17A2.827 2.827 0 0 1 12 19.98a2.827 2.827 0 0 1-4.17-3.81A1 1 0 1 1 4 12"></path><path d="m7.83 7.83 8.34 8.34"></path></svg></div><span class="nav-label whitespace-nowrap transition-opacity duration-200 opacity-100">综艺</span>',2)])]))]),a.showSiteNav?(U(),W("div",ms,[S[22]||(S[22]=l("div",{class:"px-4 mb-2 text-xs font-semibold text-gray-400 tracking-wider select-none flex-shrink-0"}," 站点导航 ",-1)),l("div",gs,[l("div",{id:a.siteNavVariant==="index"?"homeSiteNavList":void 0,class:"flex-1 min-h-0 space-y-1 overflow-y-auto"},[a.siteNavVariant==="index"?(U(!0),W(ft,{key:0},_t(t.value||[],P=>(U(),W("a",{key:P.key,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 dark:data-[active=true]:text-green-300 transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"#",onClick:it(J=>c(P),["prevent"]),"data-site-key":P.key,"data-site-api":P.api,"data-active":et(M)&&et(M)===P.key},[l("span",ws,He(P.name||P.key),1)],8,bs))),128)):(U(!0),W(ft,{key:1},_t(t.value||[],P=>(U(),W("a",{key:P.key,class:"nav-item group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 dark:data-[active=true]:text-green-300 transition-colors duration-200 min-h-[40px] mx-0 gap-3 justify-start",href:"/",onClick:J=>c(P),"data-site-key":P.key,"data-site-api":P.api,"data-active":et(M)&&et(M)===P.key},[l("span",ks,He(P.name||P.key),1)],8,xs))),128)),!t.value||t.value.length===0?(U(),W("div",Ss," 无数据 ")):wt("",!0)],8,ys),a.showSiteNavOverlays?(U(),W(ft,{key:0},[S[21]||(S[21]=vt('<div id="homeSiteNavOverlayTop" class="hidden absolute top-0 left-0 right-0 h-10"><button id="homeSiteNavScrollUp" type="button" class="w-full h-full flex items-start justify-center pt-2 bg-gradient-to-b from-gray-200/95 via-gray-100/70 to-transparent dark:from-[#0d1624]/95 dark:via-[#0d1624]/70 dark:to-transparent text-gray-700 dark:text-gray-200" aria-label="向上滚动"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m18 15-6-6-6 6"></path></svg></button></div><div id="homeSiteNavOverlayBottom" class="hidden absolute bottom-0 left-0 right-0 h-10"><button id="homeSiteNavScrollDown" type="button" class="w-full h-full flex items-end justify-center pb-2 bg-gradient-to-t from-gray-200/95 via-gray-100/70 to-transparent dark:from-[#0d1624]/95 dark:via-[#0d1624]/70 dark:to-transparent text-gray-700 dark:text-gray-200" aria-label="向下滚动"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg></button></div>',2))],64)):wt("",!0)])])):wt("",!0)])])]),S[23]||(S[23]=l("div",{id:"sidebarOffset",class:"sidebar-offset transition-all duration-300 w-64"},null,-1))]))}};function er(a){const p=typeof a=="string"?a.trim():"";if(!p)return"";try{const s=new URL(p);s.hash="",s.search="";let x=s.pathname||"/";const t=x.indexOf("/spider/");return t>=0&&(x=x.slice(0,t)||"/"),x=x.replace(/\/spider\/?$/,"/"),x=x.replace(/\/(full-config|config|website)\/?$/,"/"),x.endsWith("/")||(x+="/"),s.pathname=x,s.toString()}catch{return""}}async function kr({apiBase:a,username:p,action:s,spiderApi:x,payload:t,query:e,headers:u}){const r=typeof s=="string"?s.trim():"",n=typeof x=="string"?x.trim():"",o=t&&typeof t=="object"?t:{},i=e&&typeof e=="object"?e:null,c=u&&typeof u=="object"?u:null;if(!r)throw new Error("action 不能为空");if(!n||!n.startsWith("/spider/"))throw new Error("站点 API 无效");const f=er(a);if(!f)throw new Error("CatPawOpen 接口地址未设置");const g=n.endsWith("/")?n.slice(0,-1):n,y=new URL(`${g}/${encodeURIComponent(r)}`,f);i&&Object.entries(i).forEach(([M,$])=>{const S=typeof M=="string"?M.trim():"";S&&$!=null&&y.searchParams.set(S,String($))});const C={"Content-Type":"application/json",...c||{}},A=typeof p=="string"?p.trim():"";A&&(C["X-TV-User"]=A);const H=await fetch(y.toString(),{method:"POST",headers:C,body:JSON.stringify(o),credentials:"omit"}),w=H&&typeof H.status=="number"?H.status:0,_=await H.json().catch(()=>({}));if(!H.ok){const M=_&&_.message?String(_.message):"请求失败",$=new Error(M);throw $.status=w,$}return _}const Cs='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" class="tv-card-play-icon"><circle cx="12" cy="12" r="10"></circle><polygon points="10 8 16 12 10 16 10 8"></polygon></svg>';function $s(a,p){!a||typeof p!="function"||(a.addEventListener("click",p),a.addEventListener("keydown",s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),p())}))}function Kr(a){if(!a)return;const p=document.createElement("div");p.className="tv-card-hover-gradient",a.appendChild(p);const s=document.createElement("div");s.className="tv-card-hover-play",s.innerHTML=Cs,a.appendChild(s)}function js(a,{poster:p,alt:s,io:x,placeholder:t=!0}={}){if(!a)return;const e=typeof p=="string"?p.trim():"";if(!e)return;let u=null;t&&(u=document.createElement("div"),u.className="absolute inset-0 bg-gray-300 dark:bg-white/10 animate-pulse",a.appendChild(u));const r=document.createElement("img");r.dataset.src=e,r.alt=typeof s=="string"?s:"",r.loading="lazy",r.decoding="async",r.referrerPolicy="no-referrer",r.className="w-full h-full object-cover opacity-0 transition-opacity transition-transform duration-300 ease-out group-hover:scale-105",r.addEventListener("load",()=>{r.classList.remove("opacity-0"),r.classList.add("opacity-100"),u&&u.remove()},{once:!0}),r.addEventListener("error",()=>{u&&u.remove(),r.remove()},{once:!0}),a.appendChild(r),x?x.observe(r):r.setAttribute("src",e)}function Ar({wrapperEl:a,wrapperClass:p,cardClass:s="douban-card group w-full",io:x=null,detail:t,title:e,poster:u,remark:r,siteName:n,placeholder:o=!0,overlays:i=!0}={}){const c=t&&typeof t=="object"?t:null;if(!c)return null;const f=a||document.createElement("div");p?f.className=p:a||(f.className="w-full");const g=document.createElement("div");g.className=s,g.setAttribute("role","link"),g.setAttribute("tabindex","0"),$s(g,()=>{try{if(typeof window>"u")return;window.dispatchEvent(new CustomEvent("tv:open-play",{detail:c}))}catch{}});const C=document.createElement("div");C.className="douban-poster",js(C,{poster:u,alt:e,io:x,placeholder:o}),i&&Kr(C);const A=typeof r=="string"?r.trim():"";if(A){const _=document.createElement("div");_.className="tv-card-badge",_.textContent=A,C.appendChild(_)}const H=document.createElement("div");H.className="douban-card-title",H.textContent=typeof e=="string"?e:"",g.appendChild(C),g.appendChild(H);const w=typeof n=="string"?n.trim():"";if(w){const _=document.createElement("div");_.className="tv-site-badge-wrap";const M=document.createElement("div");M.className="tv-site-badge",M.title=w,M.textContent=w,_.appendChild(M),g.appendChild(_)}return f.appendChild(g),f}function Ls(){const a="/api/searchhistory",p="/api/user/sites",s="tv:search:aggregate:sources:v1",x=document.getElementById("searchForm"),t=document.getElementById("searchInput"),e=document.getElementById("clearQueryBtn"),u=document.getElementById("searchResultsSection"),r=document.getElementById("searchResultsSummary"),n=document.getElementById("searchResultsStatus"),o=document.getElementById("searchResultsList"),i=document.getElementById("searchHistorySection"),c=document.getElementById("searchHistoryChips"),f=document.getElementById("clearHistoryBtn");if(!x||!t||!e||!u||!r||!n||!o||!i||!c||!f)return;const g=document.getElementById("homeDoubanConfig");let y=g&&g.getAttribute("data-cat-api-base")||"";const C=g&&g.getAttribute("data-tv-user")||"";let A=5,H="",w=[],_=new Map;const M=K=>{try{const ke=JSON.parse(typeof K=="string"?K:"");return Array.isArray(ke)?ke:[]}catch{return[]}},$=()=>{y=g&&g.getAttribute("data-cat-api-base")||"";const K=g&&g.getAttribute("data-search-thread-count")||"5",ke=Number(K);A=Number.isFinite(ke)&&ke>0?Math.min(50,Math.floor(ke)):5;const ce=g&&g.getAttribute("data-search-site-order")||"[]";w=M(ce).map(q=>typeof q=="string"?q.trim():"").filter(Boolean),_=new Map,w.forEach((q,Z)=>{_.has(q)||_.set(q,Z)}),H=(g&&g.getAttribute("data-search-cover-site")||"").trim();const G=g&&g.getAttribute("data-magic-aggregate-rules")||"[]";M(G).map(q=>typeof q=="string"?q.trim():"").filter(Boolean)};$();const S=async(K,ke={})=>{const ce=await fetch(K,ke),G=await ce.json().catch(()=>null);if(!ce.ok){const q=G&&(G.error||G.message)?G.error||G.message:"请求失败";throw new Error(q)}return G},P=(K,ke=!1)=>{const ce=K||"";n.textContent=ce,n.classList.toggle("hidden",!ce),n.classList.remove("text-red-500","dark:text-red-400","text-gray-500","dark:text-gray-400"),ce&&(n.classList.add(ke?"text-red-500":"text-gray-500"),n.classList.add(ke?"dark:text-red-400":"dark:text-gray-400"))},J=K=>{const ke=K||"";r.textContent=ke,r.classList.toggle("hidden",!ke)};let oe=!1;const me=K=>{oe=K,u.classList.toggle("hidden",!K),i.classList.toggle("hidden",K)},Se=K=>(K&&Array.isArray(K.list)?K.list:[]).map(ce=>({id:ce&&(ce.vod_id!=null?String(ce.vod_id):ce.id!=null?String(ce.id):""),name:ce&&(ce.vod_name!=null?String(ce.vod_name):ce.name!=null?String(ce.name):""),pic:ce&&(ce.vod_pic!=null?String(ce.vod_pic):ce.pic!=null?String(ce.pic):""),remark:ce&&(ce.vod_remarks!=null?String(ce.vod_remarks):ce.remark!=null?String(ce.remark):"")})).filter(ce=>ce.name),je=({gridEl:K,items:ke,siteKey:ce,siteApi:G,siteName:q,seenKeys:Z,insertCardSorted:O,computeMatchScore:D,siteOrderOverride:ve,scoreOverride:te,isAggregate:ue})=>{const pe=Array.isArray(ke)?ke:[];if(!pe.length)return 0;let be=0,Le=null;if(typeof IntersectionObserver<"u")try{Le=new IntersectionObserver(fe=>{fe.forEach(Re=>{if(!Re.isIntersecting)return;const ne=Re.target,$e=ne&&ne.dataset?ne.dataset.src:"";$e&&!ne.getAttribute("src")&&ne.setAttribute("src",$e),Le&&Le.unobserve(ne)})},{root:null,rootMargin:"0px",threshold:.01})}catch{Le=null}return pe.forEach(fe=>{const Re=fe&&fe.id?String(fe.id):"",ne=`${ce||""}::${Re}`;if(Re&&Z&&Z.has(ne))return;Re&&Z&&Z.add(ne);const $e=document.createElement("div");$e.className="w-full",$e.dataset.siteKey=ce||"",$e.dataset.videoId=Re||"",fe&&typeof fe.__aggKey=="string"&&fe.__aggKey&&($e.dataset.titleAggKey=fe.__aggKey),ue&&($e.dataset.aggregate="1"),$e.dataset.siteOrder=String(Number.isFinite(Number(ve))?Number(ve):_.has(ce)?_.get(ce):999999),typeof D=="function"&&D(fe&&fe.name?fe.name:"")===1e3&&($e.dataset.exactMatch="1");const he=fe&&fe.name?String(fe.name):"";if(Ar({wrapperEl:$e,wrapperClass:"w-full",io:Le,detail:{siteKey:ce||"",spiderApi:G||"",videoId:fe&&fe.id?String(fe.id):"",videoTitle:he,videoPoster:fe&&fe.pic?String(fe.pic):"",videoRemark:fe&&fe.remark?String(fe.remark):""},title:he,poster:fe&&fe.pic?String(fe.pic):"",remark:fe&&fe.remark?String(fe.remark):"",siteName:typeof q=="string"?q:"",placeholder:!0})){if(typeof O=="function"){const Xe=Number.isFinite(Number(te))?Number(te):typeof D=="function"?D(fe&&fe.name?fe.name:""):0;O($e,Xe)}else K.appendChild($e);be+=1}}),be};let T=null;const V=async()=>T||(T=S(p,{method:"GET",credentials:"same-origin"}).then(K=>K&&Array.isArray(K.sites)?K.sites:[]).catch(()=>[]),T);try{window.addEventListener("tv:user-settings-updated",()=>{T=null,$()})}catch{}let Y=0;const _e=async K=>{const ke=Y+=1,ce=(K||"").trim();if(!ce)return;try{sessionStorage.removeItem(s)}catch{}me(!0),o.innerHTML="",J(""),P("搜索中...");const G=document.createElement("div");G.className="douban-grid",o.appendChild(G);const q=ge=>String(ge||"").toLowerCase().replace(/[\s\u200b\u200c\u200d\ufeff]+/g,"").trim(),Z=ge=>String(ge||"").replace(/[\s\u200b\u200c\u200d\ufeff]+/g,"").trim(),O=q(ce),D=Z(ce),ve=ge=>{const Ie=q(ge);if(!O||!Ie)return 0;if(Ie===O)return 1e3;if(Ie.startsWith(O))return 900;const Je=Ie.indexOf(O);if(Je>=0){const B=60-Math.min(60,Je),le=40-Math.min(40,Math.max(0,Ie.length-O.length));return 800+B+le}const L=ce.toLowerCase().split(/\s+/g).map(B=>B.trim()).filter(Boolean);if(L.length>=2){let B=0;if(L.forEach(le=>{le&&Ie.includes(le)&&(B+=1)}),B)return 600+B*20}return 0};let te=0;const ue=(ge,Ie)=>{ge.dataset.score=String(Ie),ge.dataset.seq=String(te+=1);const Je=Number(ge.dataset.score||0),L=Number(ge.dataset.siteOrder||999999),B=Number(ge.dataset.seq||0),le=Array.from(G.children||[]);for(let re=0;re<le.length;re+=1){const Be=le[re],qe=Number(Be&&Be.dataset?Be.dataset.score:0),mt=Number(Be&&Be.dataset?Be.dataset.siteOrder:999999),Ne=Number(Be&&Be.dataset?Be.dataset.seq:0);if(Number.isFinite(qe)&&qe<Je){G.insertBefore(ge,Be);return}if(Number.isFinite(qe)&&qe===Je){if(Number.isFinite(mt)&&mt>L){G.insertBefore(ge,Be);return}if(Number.isFinite(mt)&&mt===L&&Number.isFinite(Ne)&&Ne>B){G.insertBefore(ge,Be);return}}}G.appendChild(ge)},pe=ge=>{const Ie=ge&&typeof ge.api=="string"?ge.api:"",Je=ge&&typeof ge.key=="string"?ge.key:"";return Ie.includes("/spider/baseset/")||Je.toLowerCase().includes("baseset")},be=(await V()).filter(ge=>ge&&ge.enabled!==!1&&ge.api&&!pe(ge));if(ke!==Y)return;if(!be.length){P("暂无可用站点"),o.innerHTML="";return}let Le=0,fe=0,Re=0;const ne=new Map,$e=new Set;let he=null,Te="",Xe=!1;const Qe=ge=>{if(!ge)return 0;let Ie=0;return Array.from(G.children||[]).forEach(L=>{if(!L||!L.dataset||L.dataset.aggregate==="1")return;const B=(L.dataset.titleAggKey||"").trim();if(B&&B===ge){try{L.remove(),Ie+=1}catch{}return}if((L.dataset.exactMatch||"")==="1"){try{L.remove(),Ie+=1}catch{}return}const le=L.querySelector&&L.querySelector(".douban-card-title"),re=le&&le.textContent?String(le.textContent):"";if(!(!re||Z(re)!==ge&&q(re)!==O))try{L.remove(),Ie+=1}catch{}}),Ie},st=ge=>{const Ie=Je=>{const L=ge.get(Je);return!L||!L.matches?null:Array.from(L.matches.values())[0]||null};if(H){const Je=Ie(H);if(Je)return Je}for(const Je of w){const L=Ie(Je);if(L)return L}for(const Je of ge.values()){if(!Je||!Je.matches)continue;const L=Array.from(Je.matches.values())[0];if(L)return L}return null},xt=(ge,Ie)=>{if(!(!ge||!ge.siteKey||!ge.videoId))try{sessionStorage.setItem(s,JSON.stringify({q:ce,key:D,forSiteKey:ge.siteKey,forVideoId:ge.videoId,createdAt:Date.now(),sources:Ie}))}catch{}},bt=()=>{if(!D)return;const ge=Array.from(ne.values()).flatMap(le=>!le||!le.matches?[]:Array.from(le.matches.values())),Ie=st(ne);if(!Ie||!Ie.siteKey||!Ie.videoId||ge.length<1)return;Xe=!0;const Je=Qe(D);Je&&(Re=Math.max(0,Re-Je));const L=`${Ie.siteKey}::${String(Ie.videoId)}`;if(he&&Te&&Te!==L){try{he.remove(),Re=Math.max(0,Re-1)}catch{}he=null,Te=""}if($e.delete(L),Array.from(G.children||[]).forEach(le=>{if(!(!le||!le.dataset)&&le.dataset.aggregate!=="1"&&(le.dataset.siteKey||"")===Ie.siteKey&&(le.dataset.videoId||"")===String(Ie.videoId))try{le.remove(),Re=Math.max(0,Re-1)}catch{}}),he)xt(Ie,ge);else{xt(Ie,ge),je({gridEl:G,items:[{id:Ie.videoId,name:Ie.videoTitle||ce,pic:Ie.videoPoster||"",remark:Ie.videoRemark||""}],siteKey:Ie.siteKey,siteApi:Ie.spiderApi,siteName:"聚合",seenKeys:$e,insertCardSorted:ue,computeMatchScore:ve,siteOrderOverride:-1,scoreOverride:1e9,isAggregate:!0});const le=Array.from(G.children||[]).find(re=>re&&re.dataset&&re.dataset.aggregate==="1"&&re.dataset.siteKey===Ie.siteKey&&re.dataset.videoId===String(Ie.videoId));le&&(he=le,Te=L,Re+=1)}},ot=()=>{const ge=`已完成 ${Le}/${be.length}，共 ${Re} 条结果（并发 ${A}）`;J(fe?`${ge}，失败 ${fe}`:ge)};ot();const ht=be.slice(),Ae=new Array(Math.max(1,A)).fill(null).map(async()=>{for(;ht.length;){const ge=ht.shift();if(ge)try{const Ie=await kr({apiBase:y,username:C,action:"search",spiderApi:ge.api,payload:{wd:ce,page:1}});if(ke!==Y)return;const Je=Se(Ie),L=[];if(Je.forEach(re=>{const Be=re&&re.name?String(re.name):"",qe=Be?Z(Be):"",mt=re&&re.id!=null?String(re.id):"";!D||!qe||q(Be)===O&&mt&&L.push(re)}),L.length&&ge&&ge.key){const re=String(ge.key),Be=ne.get(re)||{siteKey:re,spiderApi:ge.api,siteName:ge.name||ge.key||"",matches:new Map};L.forEach(qe=>{const mt=qe&&qe.id?String(qe.id):"";mt&&(Be.matches.has(mt)||Be.matches.set(mt,{siteKey:re,spiderApi:ge.api,siteName:ge.name||ge.key||"",videoId:mt,videoTitle:qe&&qe.name?String(qe.name):"",videoPoster:qe&&qe.pic?String(qe.pic):"",videoRemark:qe&&qe.remark?String(qe.remark):""}))}),ne.set(re,Be)}bt();let le=Je.slice(0,12).map(re=>({...re,__aggKey:re&&re.name?Z(re.name):"",__exact:re&&re.name?q(re.name)===O:!1}));Xe&&D&&(le=le.filter(re=>!(!re||re.__exact))),Re+=je({gridEl:G,items:le,siteKey:ge.key,siteApi:ge.api,siteName:ge.name||ge.key||"",seenKeys:$e,insertCardSorted:ue,computeMatchScore:ve}),bt()}catch{if(ke!==Y)return;fe+=1}finally{Le+=1,ot(),Le>=be.length&&P(Re?fe?`部分站点搜索失败（${fe}）`:"":"暂无搜索结果")}}});await Promise.allSettled(Ae),ke===Y&&(bt(),ot(),P(Re?fe?`部分站点搜索失败（${fe}）`:"":"暂无搜索结果"))},Pe=(K,{saveHistory:ke}={saveHistory:!0})=>{const ce=(K||"").trim().replace(/\s+/g," ");t.value=ce,se(),ce&&(ke&&S(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyword:ce})}).then(G=>de(G)).catch(()=>{}),_e(ce))},se=()=>{const K=(t.value||"").trim();e.classList.toggle("hidden",!K)},de=K=>{if(c.innerHTML="",!Array.isArray(K)||K.length===0){i.classList.add("hidden");return}i.classList.toggle("hidden",oe);const ke=document.createDocumentFragment();K.forEach(ce=>{const G=(ce||"").trim();if(!G)return;const q=document.createElement("div");q.className="relative group";const Z=document.createElement("button");Z.type="button",Z.className="px-4 py-2 bg-gray-500/10 hover:bg-gray-300 rounded-full text-sm text-gray-700 transition-colors duration-200 dark:bg-gray-700/50 dark:hover:bg-gray-600 dark:text-gray-300",Z.textContent=G,Z.addEventListener("click",()=>{t.value=G,se(),_e(G)});const O=document.createElement("button");O.type="button",O.setAttribute("aria-label","删除搜索历史"),O.className="absolute -top-1 -right-1 w-4 h-4 opacity-0 group-hover:opacity-100 bg-gray-400 hover:bg-red-500 text-white rounded-full flex items-center justify-center text-[10px] transition-colors",O.innerHTML="&times;",O.addEventListener("click",async D=>{D.stopPropagation(),D.preventDefault();try{await S(`${a}?keyword=${encodeURIComponent(G)}`,{method:"DELETE"}),await Me()}catch{}}),q.appendChild(Z),q.appendChild(O),ke.appendChild(q)}),c.appendChild(ke)},Me=async()=>{try{const K=await S(a,{method:"GET"});de(K)}catch{de([])}};f.addEventListener("click",async()=>{try{await S(a,{method:"DELETE"}),await Me()}catch{}}),x.addEventListener("submit",K=>{K.preventDefault(),Pe(t.value,{saveHistory:!0})}),e.addEventListener("click",()=>{t.value="",se(),me(!1),J(""),P(""),o.innerHTML="",t.focus()}),t.addEventListener("input",()=>se()),window.addEventListener("tv:search",K=>{const ke=K&&K.detail&&typeof K.detail.q=="string"?K.detail.q:"";Pe(ke,{saveHistory:!0})}),t.value="",se(),me(!1),Me()}function Xr(a,p=1e3){if(!a)return;const s=a.parentElement;if(!s||s.querySelector(".tv-scroll-control"))return;let x=!1;const t=n=>{const o=document.createElement("div");o.className=`tv-scroll-control tv-scroll-control-${n}`,o.style.opacity="0";const i=document.createElement("div");i.className="tv-scroll-control-inner";const c=document.createElement("button");return c.type="button",c.className="tv-scroll-btn",c.setAttribute("aria-label",n==="left"?"向左滚动":"向右滚动"),c.innerHTML=n==="left"?'<svg xmlns="http://www.w3.org/2000/svg" class="tv-scroll-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" class="tv-scroll-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>',c.addEventListener("click",f=>{f.preventDefault(),a.scrollBy({left:n==="left"?-p:p,behavior:"smooth"})}),i.appendChild(c),o.appendChild(i),s.appendChild(o),o},e=t("left"),u=t("right"),r=()=>{const{scrollWidth:n,clientWidth:o,scrollLeft:i}=a,c=1,f=n-(i+o)>c,g=i>c;e.style.display=g?"":"none",u.style.display=f?"":"none",e.style.opacity=x&&g?"1":"0",u.style.opacity=x&&f?"1":"0"};s.addEventListener("mouseenter",()=>{x=!0,r()}),s.addEventListener("mouseleave",()=>{x=!1,r()}),a.addEventListener("scroll",r),window.addEventListener("resize",r),typeof ResizeObserver<"u"&&new ResizeObserver(()=>r()).observe(a),typeof MutationObserver<"u"&&new MutationObserver(()=>{setTimeout(r,100)}).observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),r()}function As(){const a=document.getElementById("homeSiteNavList"),p=document.getElementById("homeSiteNavOverlayTop"),s=document.getElementById("homeSiteNavOverlayBottom"),x=document.getElementById("homeSiteNavScrollUp"),t=document.getElementById("homeSiteNavScrollDown");if(!a||!p||!s||!x||!t)return;let e=!1;const u=()=>{e=!1;const n=2,o=a.scrollTop||0,i=o>n,c=(a.scrollHeight||0)-(o+(a.clientHeight||0))>n;p.classList.toggle("hidden",!i),s.classList.toggle("hidden",!c)},r=()=>{e||(e=!0,window&&window.requestAnimationFrame?window.requestAnimationFrame(u):setTimeout(u,0))};x.addEventListener("click",n=>{n.preventDefault(),a.scrollBy({top:-240,behavior:"smooth"})}),t.addEventListener("click",n=>{n.preventDefault(),a.scrollBy({top:240,behavior:"smooth"})}),a.addEventListener("scroll",r),window.addEventListener("resize",r),typeof ResizeObserver<"u"&&new ResizeObserver(()=>r()).observe(a),typeof MutationObserver<"u"&&new MutationObserver(()=>r()).observe(a,{childList:!0,subtree:!0}),r()}function Ms(){const a=document.getElementById("homePage"),p=document.getElementById("searchPage"),s=document.getElementById("homeSegToggle"),x=document.getElementById("segHomeBtn"),t=document.getElementById("segFavBtn"),e=document.getElementById("homeSiteNavList"),u=document.getElementById("homeSiteSections"),r=document.getElementById("homeDoubanSections"),n=document.getElementById("homeDoubanBrowse"),o=document.getElementById("homeContinueSection"),i=document.getElementById("homeContinueRow"),c=document.getElementById("homeFavoritesSection"),f=document.getElementById("homeFavoritesGrid"),g=document.getElementById("homeFavoritesEmpty"),y=document.getElementById("homeDoubanConfig");if(!e||!u||!r||!n||!y)return;const C=I=>{const k=typeof I=="string"?I.trim():"";x&&x.classList.toggle("active",k==="home"),t&&t.classList.toggle("active",k==="fav")};let A=!1,H=null,w=!0,_=!1,M=[],$=!0,S=!1,P=!1,J=[],oe=!0,me=!1,Se={};const je=async({includePlayHistory:I=!0,includeFavorites:k=!0,includePanLoginSettings:h=!0,playHistoryLimit:b=20,favoritesLimit:F=50}={})=>{const ee=await sr(`/api/home${Br({includePlayHistory:I?1:0,includeFavorites:k?1:0,includePanLoginSettings:h?1:0,playHistoryLimit:b,favoritesLimit:F})}`,{cacheMs:2e3});return ee&&typeof ee=="object"?ee:{}},T=()=>{let I=null;return()=>{if(I)return I;if(typeof IntersectionObserver>"u")return null;try{return I=new IntersectionObserver(k=>{k.forEach(h=>{if(!h.isIntersecting)return;const b=h.target,F=b&&b.dataset?b.dataset.src:"";F&&!b.getAttribute("src")&&b.setAttribute("src",F),I&&I.unobserve(b)})},{root:null,rootMargin:"0px",threshold:.01}),I}catch{return I=null,null}}},V=T(),Y=T(),_e=()=>{if(!o)return;const I=w&&Array.isArray(M)&&M.length>0;o.classList.toggle("hidden",!I)},Pe=()=>{c&&c.classList.toggle("hidden",S!==!0)},se=()=>{if(!i||(i.innerHTML="",!Array.isArray(M)||!M.length))return;const I=Y(),k=document.createDocumentFragment();M.forEach(h=>{const b=h&&typeof h.siteKey=="string"?h.siteKey:"",F=h&&typeof h.spiderApi=="string"?h.spiderApi:"",j=h&&typeof h.videoId=="string"?h.videoId:"",ee=h&&typeof h.videoTitle=="string"?h.videoTitle:"";if(!b||!F||!j||!ee)return;const Ee=Ar({wrapperClass:"min-w-[96px] w-24 sm:min-w-[180px] sm:w-44",io:I,detail:{siteKey:b,spiderApi:F,videoId:j,videoTitle:ee,videoPoster:h&&typeof h.videoPoster=="string"?h.videoPoster:"",videoRemark:h&&typeof h.videoRemark=="string"?h.videoRemark:""},title:ee,poster:h&&typeof h.videoPoster=="string"?h.videoPoster:"",remark:h&&typeof h.videoRemark=="string"?h.videoRemark:"",siteName:h&&typeof h.siteName=="string"?h.siteName:"",placeholder:!0});Ee&&k.appendChild(Ee)}),i.appendChild(k);try{Xr(i)}catch{}},de=async()=>{if(!_){if(!$){_e(),w&&se();return}_=!0;try{const I=await je({includePlayHistory:!0,includeFavorites:!1,includePanLoginSettings:!1,playHistoryLimit:20});M=Array.isArray(I&&I.playHistory)?I.playHistory:[],$=!1}catch{M=[],$=!1}finally{_=!1,_e(),w&&se()}}},Me=()=>{if(!f||!g)return;f.innerHTML="";const I=Array.isArray(J)?J:[];if(g.classList.toggle("hidden",I.length>0),!I.length)return;const k=V(),h=document.createDocumentFragment();I.forEach(b=>{const F=b&&typeof b.siteKey=="string"?b.siteKey:"",j=b&&typeof b.spiderApi=="string"?b.spiderApi:"",ee=b&&typeof b.videoId=="string"?b.videoId:"",Ee=b&&typeof b.videoTitle=="string"?b.videoTitle:"";if(!F||!j||!ee||!Ee)return;const Oe=Ar({wrapperClass:"w-full",io:k,detail:{siteKey:F,spiderApi:j,videoId:ee,videoTitle:Ee,videoPoster:b&&typeof b.videoPoster=="string"?b.videoPoster:"",videoRemark:b&&typeof b.videoRemark=="string"?b.videoRemark:""},title:Ee,poster:b&&typeof b.videoPoster=="string"?b.videoPoster:"",remark:b&&typeof b.videoRemark=="string"?b.videoRemark:"",siteName:b&&typeof b.siteName=="string"?b.siteName:"",placeholder:!0});Oe&&h.appendChild(Oe)}),f.appendChild(h)},K=async()=>{if(S){if(!oe){Me();return}if(!P){P=!0;try{const I=await je({includePlayHistory:!1,includeFavorites:!0,includePanLoginSettings:!1,favoritesLimit:50});J=Array.isArray(I&&I.favorites)?I.favorites:[],oe=!1}catch{J=[],oe=!1}finally{P=!1,Me()}}}},ke=()=>{H={segHidden:!!(s&&s.classList.contains("hidden")),siteHidden:!!u.classList.contains("hidden"),doubanHidden:!!r.classList.contains("hidden"),browseHidden:!!n.classList.contains("hidden"),continueAllowed:w},S=!0,A=!0,C("fav"),Z(),s&&s.classList.remove("hidden"),u.classList.add("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),w=!1,_e(),Pe(),K()},ce=()=>{if(S=!1,A=!1,Pe(),C("home"),!H){D();return}Z(),s&&s.classList.toggle("hidden",H.segHidden),u.classList.toggle("hidden",H.siteHidden),r.classList.toggle("hidden",H.doubanHidden),n.classList.toggle("hidden",H.browseHidden),w=!!H.continueAllowed,_e(),w&&se()};let G=!1;const q=()=>{G||(G=!0,Ls())},Z=()=>{a&&a.classList.remove("hidden"),p&&p.classList.add("hidden")},O=()=>{a&&a.classList.add("hidden"),p&&p.classList.remove("hidden"),q()},D=()=>{Z(),s&&s.classList.remove("hidden"),A&&ce(),C("home"),u.classList.add("hidden"),r.classList.remove("hidden"),Array.from(r.querySelectorAll("section")).forEach(I=>I.classList.remove("hidden")),n.classList.add("hidden"),w=!0,_e(),w&&se()},ve=I=>{Z(),s&&s.classList.add("hidden"),A&&ce(),C("home"),u.classList.add("hidden"),r.classList.add("hidden"),n.classList.remove("hidden"),w=!1,_e(),te&&te.backBtn&&te.backBtn.classList.add("hidden"),te&&te.areaRow&&(te.areaRow.style.display=""),te&&te.secondaryLabelEl&&(te.secondaryLabelEl.textContent="地区"),te&&te.subtitleEl&&(te.subtitleEl.textContent="来自豆瓣的精选内容");const k=String(I||"").trim();window.dispatchEvent(new CustomEvent("tv:douban-browse",{detail:{type:k}}))},te=(()=>{const I=document.getElementById("doubanBrowseBackBtn"),k=document.getElementById("doubanBrowseTitle"),h=n?n.querySelector(".douban-browse-subtitle"):null,b=document.getElementById("doubanBrowseStatus"),F=document.getElementById("doubanFilterSecondaryLabel"),j=document.getElementById("doubanFilterCategory"),ee=document.getElementById("doubanFilterArea"),Ee=document.getElementById("doubanBrowseGrid");if(!k||!h||!b||!F||!j||!ee||!Ee)return null;const Oe=ee.closest?ee.closest(".douban-filter-row"):null;let Ue=document.getElementById("siteBrowseSentinel");return!Ue&&n&&n.insertBefore&&(Ue=document.createElement("div"),Ue.id="siteBrowseSentinel",Ue.className="h-10",n.insertBefore(Ue,Ee.nextSibling)),{backBtn:I,titleEl:k,subtitleEl:h,statusEl:b,secondaryLabelEl:F,filterCategoryEl:j,filterAreaEl:ee,areaRow:Oe,gridEl:Ee,sentinel:Ue}})(),ue=()=>{te&&(Z(),s&&s.classList.add("hidden"),A&&ce(),C("home"),u.classList.add("hidden"),r.classList.add("hidden"),n.classList.remove("hidden"),w=!1,_e(),te.areaRow&&(te.areaRow.style.display="none"),te.filterAreaEl.innerHTML="",te.secondaryLabelEl.textContent="",te.backBtn&&te.backBtn.classList.remove("hidden"))};te&&te.backBtn&&!te.backBtn.dataset.bound&&(te.backBtn.dataset.bound="1",te.backBtn.addEventListener("click",I=>{if(I.preventDefault(),Qe(),te&&te.backBtn&&te.backBtn.classList.add("hidden"),re){Z(),s&&s.classList.remove("hidden"),n.classList.add("hidden"),r.classList.add("hidden"),u.classList.remove("hidden"),w=!0,_e(),w&&se();return}D()}));try{const I=typeof navigator<"u"&&navigator.userAgent||"";if(/iPhone|iPod/i.test(I)&&n&&te&&te.backBtn){let h=!1,b=0,F=0,j=!1;const ee=20,Ee=70,Oe=at=>{const gt=at&&at.touches&&at.touches[0]?at.touches[0]:null;return gt?{x:gt.clientX||0,y:gt.clientY||0}:null},Ue=at=>{const gt=Oe(at);gt&&(b=gt.x,F=gt.y,h=b<=ee,j=!1)},We=at=>{if(!h)return;const gt=Oe(at);if(!gt)return;const At=gt.x-b,Ct=gt.y-F;if(!(At<=0)){if(Math.abs(Ct)>12&&Math.abs(Ct)>Math.abs(At)){h=!1,j=!1;return}if(At>=Ee&&At>Math.abs(Ct)*1.4){j=!0;try{at.preventDefault()}catch{}}}},Ve=()=>{h=!1,j=!1},Ze=()=>{const at=te&&te.backBtn?te.backBtn:null,gt=at&&!at.classList.contains("hidden");if(h&&j&&gt)try{at.click()}catch{}Ve()};n.dataset.tvIphoneSwipeBound||(n.dataset.tvIphoneSwipeBound="1",n.addEventListener("touchstart",Ue,{passive:!0}),n.addEventListener("touchmove",We,{passive:!1}),n.addEventListener("touchend",Ze,{passive:!0}),n.addEventListener("touchcancel",Ve,{passive:!0}))}}catch{}const pe=I=>{try{const k=typeof I=="string"?I.trim():"";if(!k)return"";const h=typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(k):k,b=e.querySelector(`a[data-site-key="${h}"]`);if(!b)return k;const F=b.querySelector(".nav-label"),j=(F?F.textContent:b.textContent)||"";return String(j).trim()||k}catch{return typeof I=="string"?I.trim():""}},be=I=>{const k=typeof I=="string"?I.trim():"";if(!k)return[];try{const h=localStorage.getItem(`${le}${k}`)||"";if(!h)return[];const b=JSON.parse(h);return(b&&Array.isArray(b.classes)?b.classes:[]).map(j=>({id:j&&typeof j.id=="string"?j.id:j&&j.type_id!=null?String(j.type_id):"",name:j&&typeof j.name=="string"?j.name:j&&j.type_name!=null?String(j.type_name):""})).filter(j=>j.id&&j.name)}catch{return[]}},Le=(I,k,h)=>{if(!te)return;const b=Array.isArray(I)?I:[];te.filterCategoryEl.innerHTML="",b.forEach(F=>{const j=document.createElement("button");j.type="button",j.className="douban-chip",j.textContent=F.name,j.setAttribute("data-value",F.id),F.id===k&&j.classList.add("is-active"),j.addEventListener("click",()=>h(F.id)),te.filterCategoryEl.appendChild(j)})},fe=(I,k=!1)=>{if(!te)return;const h=typeof I=="string"?I.trim():"";te.statusEl.textContent=h,te.statusEl.classList.toggle("hidden",!h),te.statusEl.classList.remove("text-red-500","dark:text-red-400","text-gray-500","dark:text-gray-400"),h&&(te.statusEl.classList.add(k?"text-red-500":"text-gray-500"),te.statusEl.classList.add(k?"dark:text-red-400":"dark:text-gray-400"))},Re=()=>{te&&(te.gridEl.innerHTML="")},ne=(()=>{let I=null;if(typeof IntersectionObserver<"u")try{I=new IntersectionObserver(h=>{h.forEach(b=>{if(!b.isIntersecting)return;const F=b.target,j=F&&F.dataset?F.dataset.src:"";j&&!F.getAttribute("src")&&F.setAttribute("src",j),I&&I.unobserve(F)})},{root:null,rootMargin:"0px",threshold:.01})}catch{I=null}return h=>{if(!te)return;const b=Array.isArray(h)?h:[],F=document.createDocumentFragment();b.forEach(j=>{const ee=j&&j.name?String(j.name):"",Ee=Ar({wrapperClass:"w-full",io:I,detail:{siteKey:Be||"",spiderApi:re||"",videoId:j&&j.id?String(j.id):"",videoTitle:ee,videoPoster:j&&j.pic?String(j.pic):"",videoRemark:j&&j.remark?String(j.remark):""},title:ee,poster:j&&j.pic?String(j.pic):"",remark:j&&j.remark?String(j.remark):"",placeholder:!1});Ee&&F.appendChild(Ee)}),te.gridEl.appendChild(F)}})(),$e=I=>(I&&Array.isArray(I.list)?I.list:[]).slice(0,24).map(b=>({id:b&&(b.vod_id!=null?String(b.vod_id):b.id!=null?String(b.id):""),name:b&&(b.vod_name!=null?String(b.vod_name):b.name!=null?String(b.name):""),pic:b&&(b.vod_pic!=null?String(b.vod_pic):b.pic!=null?String(b.pic):""),remark:b&&(b.vod_remarks!=null?String(b.vod_remarks):b.remark!=null?String(b.remark):"")})).filter(b=>b.name);let he=0,Te={siteKey:"",siteApi:"",categoryId:"",page:1,loading:!1,ended:!1},Xe=null;const Qe=()=>{Xe&&typeof Xe.disconnect=="function"&&Xe.disconnect(),Xe=null},st=async I=>{if(!te)return;const k=he,h=Te.categoryId;if(h&&!(Te.loading||Te.ended)){Te.loading=!0,fe(I===1?"加载中...":"加载更多中...");try{const b=await Ht("category",Te.siteApi,{id:h,page:I,filter:!0,filters:{}});if(k!==he)return;const F=$e(b);if(!F.length){Te.ended=!0,fe("已经是末页");return}ne(F),Te.page=I,fe("")}catch(b){if(k!==he)return;fe(Lt(b),!0)}finally{k===he&&(Te.loading=!1)}}},xt=async({siteKey:I,siteApi:k,categoryId:h})=>{var Ue;if(!te)return;const b=typeof I=="string"?I.trim():"",F=typeof k=="string"?k.trim():"",j=typeof h=="string"?h.trim():"";if(!b||!F||!j)return;Be=b,re=F;const ee=be(b);if(!ee.length){ue(),te.titleEl.textContent="无分类数据",te.subtitleEl.textContent=pe(b)||b,Le([],"",()=>{}),Re(),fe("无分类数据");return}const Oe=ee.some(We=>We.id===j)?j:ee[0].id;if(he+=1,Te={siteKey:b,siteApi:F,categoryId:Oe,page:1,loading:!1,ended:!1},ue(),te.titleEl.textContent=((Ue=ee.find(We=>We.id===Oe))==null?void 0:Ue.name)||"",te.subtitleEl.textContent=pe(b)||b,Le(ee,Oe,We=>{var Ze;const Ve=typeof We=="string"?We.trim():"";if(!(!Ve||Ve===Te.categoryId)&&(Qe(),he+=1,Te={...Te,categoryId:Ve,page:1,loading:!1,ended:!1},te.titleEl.textContent=((Ze=ee.find(at=>at.id===Ve))==null?void 0:Ze.name)||"",Re(),fe("加载中..."),st(1),Qe(),te.sentinel&&typeof IntersectionObserver<"u"))try{const at=he;Xe=new IntersectionObserver(gt=>{at===he&&(!gt||!gt.some(At=>At.isIntersecting)||Te.loading||Te.ended||st((Te.page||1)+1))},{root:null,rootMargin:"300px 0px",threshold:.01}),Xe.observe(te.sentinel)}catch{Xe=null}}),Re(),fe("加载中..."),await st(1),Qe(),te.sentinel&&typeof IntersectionObserver<"u")try{const We=he;Xe=new IntersectionObserver(Ve=>{We===he&&(!Ve||!Ve.some(Ze=>Ze.isIntersecting)||Te.loading||Te.ended||st((Te.page||1)+1))},{root:null,rootMargin:"300px 0px",threshold:.01}),Xe.observe(te.sentinel)}catch{Xe=null}},bt=()=>{Array.from(e.querySelectorAll("a[data-site-api]")).forEach(I=>I.setAttribute("data-active","false"))},ot=(I,k)=>{try{const h=typeof I=="string"?I.trim():"";if(!h)return;window.dispatchEvent(new CustomEvent("tv:mobile-context",{detail:{kind:h,siteName:k||""}}))}catch{}};let ht=!1,Ae=null;const ge=()=>{Ae={segHidden:!!(s&&s.classList.contains("hidden")),siteHidden:!!u.classList.contains("hidden"),doubanHidden:!!r.classList.contains("hidden"),browseHidden:!!n.classList.contains("hidden"),favoritesActive:!!A,continueAllowed:w},ht=!0,A&&ce(),Z(),s&&s.classList.add("hidden"),u.classList.add("hidden"),r.classList.add("hidden"),n.classList.add("hidden"),w=!0,_e(),w&&se(),de()},Ie=()=>{ht&&(ht=!1,Ae&&(Z(),s&&s.classList.toggle("hidden",Ae.segHidden),u.classList.toggle("hidden",Ae.siteHidden),r.classList.toggle("hidden",Ae.doubanHidden),n.classList.toggle("hidden",Ae.browseHidden),w=!!Ae.continueAllowed,_e(),w&&se(),Ae.favoritesActive&&ke(),Ae=null))},Je=I=>{const k=I&&I.detail&&typeof I.detail.view=="string"?I.detail.view.trim():"";if(k){if(k==="home"){Ie(),Qe(),bt(),D(),ot("home","");return}if(k==="search"){Ie(),Qe(),bt(),A&&ce(),O(),ot("search","");return}if(k==="fav"){Ie(),Qe(),bt(),ke(),ot("favorites","");return}if(k==="history"){Qe(),bt(),ge(),ot("history","");return}if(k.startsWith("douban:")){Ie(),Qe();const h=k.slice(7);bt(),ve(h),ot("douban","");return}}};window.addEventListener("tv:home-view",Je),x&&x.addEventListener("click",I=>{I.preventDefault(),A?ce():D()}),t&&t.addEventListener("click",I=>{I.preventDefault(),ke()}),window.addEventListener("tv:favorites-updated",()=>{oe=!0,A&&K()});try{const k=(localStorage.getItem("tv_server_home_view")||"").trim();if(k&&k.startsWith("douban:")){const h=k.slice(7);ve(h)}}catch{}const L="tv_server_last_site_key",B="tv_server_home_view",le="tv_server_site_classes_";let re="",Be="",qe=0;const mt=2,Ne=new Map,we=I=>{const k=typeof I=="string"?I.trim():"";if(!k)return null;const h=Ne.get(k);return h?(Ne.delete(k),Ne.set(k,h),h):null},Ge=(I,k)=>{const h=typeof I=="string"?I.trim():"";if(!(!h||!k))for(Ne.delete(h),Ne.set(h,k);Ne.size>mt;){const b=Ne.keys().next().value;if(b)Ne.delete(b);else break}},Ye=(y.getAttribute("data-tv-user")||"").trim(),lt=()=>(y.getAttribute("data-cat-api-base")||"").trim(),tt=(y.getAttribute("data-user-role")||"").trim(),nt=(y.getAttribute("data-user-cat-api-base")||"").trim(),St=I=>{const k=String(I||"").trim();if(!k)return"";try{return new URL(k).toString().replace(/\/?$/,"/")}catch{return""}},Kt=async(I,k,h={})=>{const b=St(I);if(!b)throw new Error("CatPawOpen 接口地址未设置");const F=new URL(String(k||"").replace(/^\//,""),b),j=Object.assign({},h.headers&&typeof h.headers=="object"?h.headers:{});j["Content-Type"]=j["Content-Type"]||"application/json",Ye&&(j["X-TV-User"]=Ye);const ee=await fetch(F.toString(),{method:h.method||"GET",headers:j,body:h.body,credentials:"omit"}),Ee=await ee.json().catch(()=>({}));if(!ee.ok){const Oe=Ee&&(Ee.message||Ee.error)?String(Ee.message||Ee.error):`HTTP ${ee.status}`,Ue=new Error(Oe);throw Ue.status=ee.status,Ue}if(Ee&&typeof Ee=="object"&&Object.prototype.hasOwnProperty.call(Ee,"code")){if(Ee.code===0)return Ee.data;throw new Error(Ee&&Ee.message||"CatPawOpen 网站接口返回异常")}return Ee},Yt=async()=>{if(tt!=="shared")return;const I=St(nt);if(I)try{if(!me)try{const b=await je({includePlayHistory:!1,includeFavorites:!1,includePanLoginSettings:!0}),F=b&&typeof b.panLoginSettings=="object"?b.panLoginSettings:{};Se=F&&typeof F=="object"?F:{}}catch{Se={}}finally{me=!0}const k=Se&&typeof Se=="object"?Se:{},h=Object.keys(k||{});for(let b=0;b<h.length;b+=1){const F=typeof h[b]=="string"?h[b].trim():"";if(!F)continue;const j=k[F];if(!(!j||typeof j!="object"))try{typeof j.cookie=="string"?await Kt(I,`website/${encodeURIComponent(F)}/cookie`,{method:"PUT",body:JSON.stringify({cookie:j.cookie})}):(typeof j.username=="string"||typeof j.password=="string")&&await Kt(I,`website/${encodeURIComponent(F)}/account`,{method:"PUT",body:JSON.stringify({username:typeof j.username=="string"?j.username:"",password:typeof j.password=="string"?j.password:""})})}catch{}}}catch{}},Ht=(I,k,h)=>kr({apiBase:lt(),username:Ye,action:I,spiderApi:k,payload:h}),Lt=I=>{const k=I&&typeof I.status=="number"?I.status:0,h=I&&I.message?String(I.message):"请求失败";return k?`HTTP ${k}：${h}`:h},Xt=I=>(I&&Array.isArray(I.class)?I.class:I&&Array.isArray(I.classes)?I.classes:[]).map(h=>({id:h&&(h.type_id!=null?String(h.type_id):h.tid!=null?String(h.tid):""),name:h&&(h.type_name!=null?String(h.type_name):h.name!=null?String(h.name):"")})).filter(h=>h.id&&h.name),Tt=I=>(I&&Array.isArray(I.list)?I.list:[]).slice(0,20).map(b=>({id:b&&(b.vod_id!=null?String(b.vod_id):b.id!=null?String(b.id):""),name:b&&(b.vod_name!=null?String(b.vod_name):b.name!=null?String(b.name):""),pic:b&&(b.vod_pic!=null?String(b.vod_pic):b.pic!=null?String(b.pic):""),remark:b&&(b.vod_remarks!=null?String(b.vod_remarks):b.remark!=null?String(b.remark):"")})).filter(b=>b.name),Rt=T(),Pt=(I,k)=>{I.innerHTML="";const h=Array.isArray(k)?k:[];if(!h.length){const j=document.createElement("div");j.className="px-4 sm:px-6 text-sm text-gray-500 dark:text-gray-400",j.textContent="暂无相关内容",I.appendChild(j);return}const b=Rt(),F=document.createDocumentFragment();h.forEach(j=>{const ee=j&&j.name?String(j.name):"",Ee=Ar({wrapperClass:"min-w-[96px] w-24 sm:min-w-[180px] sm:w-44",io:b,detail:{siteKey:Be||"",spiderApi:re||"",videoId:j&&j.id?String(j.id):"",videoTitle:ee,videoPoster:j&&j.pic?String(j.pic):"",videoRemark:j&&j.remark?String(j.remark):""},title:ee,poster:j&&j.pic?String(j.pic):"",remark:j&&j.remark?String(j.remark):"",placeholder:!0});Ee&&F.appendChild(Ee)}),I.appendChild(F)},fr=I=>{const k=document.createElement("section");k.className="tv-section";const h=document.createElement("div");h.className="tv-section-head";const b=document.createElement("h2");b.className="tv-section-title",b.textContent=I&&I.name||"",h.appendChild(b);const F=document.createElement("div");F.className="tv-section-actions";const j=document.createElement("div");j.className="tv-section-status",j.classList.add("hidden"),F.appendChild(j);const ee=document.createElement("button");ee.type="button",ee.className="more-link",ee.textContent="查看更多",ee.addEventListener("click",()=>{const Ue=I&&I.id?String(I.id):"";!Ue||!re||window.dispatchEvent(new CustomEvent("tv:site-category-more",{detail:{site:Be||"",api:re,cid:Ue,cname:I&&I.name?String(I.name):""}}))}),F.appendChild(ee),h.appendChild(F);const Ee=document.createElement("div");Ee.className="relative";const Oe=document.createElement("div");return Oe.className="tv-scroll-row",Oe.style.minHeight="clamp(210px,35vw,380px)",Ee.appendChild(Oe),Xr(Oe),k.appendChild(h),k.appendChild(Ee),{section:k,status:j,more:ee,row:Oe}},hr=I=>{const k=I&&Array.isArray(I.classes)?I.classes:[];if(u.innerHTML="",!k.length){const b=document.createElement("div");b.className="text-sm text-gray-500 dark:text-gray-400 px-4",b.textContent="无分类数据",u.appendChild(b);return}const h=document.createDocumentFragment();k.forEach(b=>{const F={id:b.id,name:b.name},j=fr(F);j.row.innerHTML="";const ee=Array.isArray(b.items)?b.items:[];Pt(j.row,ee),j.status.textContent="",j.status.classList.add("hidden"),j.more.classList.toggle("hidden",!ee.length),h.appendChild(j.section)}),u.appendChild(h)},Nt=async(I,k)=>{const h=qe+=1;re=I,u.innerHTML="",u.classList.remove("hidden"),r.classList.add("hidden"),n.classList.add("hidden");const b=typeof k=="string"?k.trim():Be,F=we(b);if(F&&F.api===I){try{hr(F)}catch{}return}try{const j=document.createElement("div");j.className="px-4 text-sm text-gray-500 dark:text-gray-400",j.textContent="加载中...",u.appendChild(j);const ee=await Ht("home",re,{});if(h!==qe)return;u.innerHTML="";const Ee=Xt(ee);try{Be&&localStorage.setItem(`${le}${Be}`,JSON.stringify({ts:Date.now(),classes:Ee}))}catch{}if(!Ee.length){const Ve=document.createElement("div");Ve.className="text-sm text-gray-500 dark:text-gray-400 px-4",Ve.textContent="无分类数据",u.appendChild(Ve);return}const Oe={api:re,classes:Ee.map(Ve=>({id:Ve.id,name:Ve.name,items:[]}))},Ue=document.createDocumentFragment();Ee.forEach(Ve=>{const Ze=fr(Ve);Ze.row.innerHTML="",Ze.status.textContent="加载中...",Ze.status.classList.remove("text-red-500","dark:text-red-400"),Ze.status.classList.remove("hidden"),Ze.more.classList.add("hidden"),Ue.appendChild(Ze.section),Ve.__ui=Ze}),u.appendChild(Ue);const We=async()=>{if(window&&typeof window.requestAnimationFrame=="function"){await new Promise(Ve=>window.requestAnimationFrame(()=>Ve()));return}await new Promise(Ve=>setTimeout(Ve,0))};await We();for(let Ve=0;Ve<Ee.length;Ve+=1){if(h!==qe)return;const Ze=Ee[Ve],at=Ze&&Ze.__ui?Ze.__ui:null;if(at){try{const gt=Ze&&Ze.id?Ze.id:"",At=await Ht("category",re,{id:gt,page:1,filter:!0,filters:{}});if(h!==qe)return;const Ct=Tt(At);Pt(at.row,Ct);const Vt=Oe.classes.findIndex(Ot=>Ot.id===gt);Vt>=0&&(Oe.classes[Vt].items=Ct),at.status.textContent="",at.status.classList.add("hidden"),at.more.classList.remove("hidden")}catch(gt){if(h!==qe)return;at.status.textContent=Lt(gt),at.status.classList.add("text-red-500","dark:text-red-400"),at.status.classList.remove("hidden"),at.more.classList.add("hidden"),Pt(at.row,[]);const At=Ze&&Ze.id?Ze.id:"",Ct=Oe.classes.findIndex(Vt=>Vt.id===At);Ct>=0&&(Oe.classes[Ct].items=[])}await We()}}Ge(b,Oe)}catch(j){if(h!==qe)return;u.innerHTML="",u.classList.remove("hidden"),r.classList.add("hidden"),n.classList.add("hidden");const ee=document.createElement("div");ee.className="text-sm text-red-500 dark:text-red-400 px-4",ee.textContent=Lt(j),u.appendChild(ee)}};e.addEventListener("click",I=>{const k=I.target;if(!k||!k.closest)return;const h=k.closest("a[data-site-api]");if(!h)return;const b=(h.getAttribute("data-site-api")||"").trim(),F=(h.getAttribute("data-site-key")||"").trim();if(b){try{window.dispatchEvent(new CustomEvent("tv:exit-play"))}catch{}A&&ce(),Ie(),Z(),s&&s.classList.remove("hidden"),Qe(),Array.from(e.querySelectorAll("a[data-site-api]")).forEach(j=>{j.setAttribute("data-active",j===h?"true":"false")}),Be=F,C("home"),w=!0,_e(),w&&se(),Nt(b,F);try{const j=h.querySelector(".nav-label"),ee=j?(j.textContent||"").trim():(h.textContent||"").trim();ot("site",ee)}catch{}try{F&&localStorage.setItem(L,F)}catch{}}});try{window.addEventListener("tv:site-category-more",I=>{const k=I&&I.detail&&typeof I.detail=="object"?I.detail:{},h=typeof k.site=="string"?k.site:typeof k.siteKey=="string"?k.siteKey:"",b=typeof k.api=="string"?k.api:"",F=typeof k.cid=="string"?k.cid:"";!h||!b||!F||xt({siteKey:h,siteApi:b,categoryId:F})})}catch{}const Et=()=>{try{const I=(localStorage.getItem(L)||"").trim();if(!I||I==="home")return!1;const k=typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(I):I,h=e.querySelector(`a[data-site-key="${k}"]`);if(h)return h.scrollIntoView({block:"nearest"}),h.click(),!0}catch{}return!1},tr=()=>{try{const I=(localStorage.getItem(B)||"").trim();I&&I.startsWith("douban:")?ve(I.slice(7)):D()}catch{D()}};let nr=!1;try{const I=(localStorage.getItem(L)||"").trim();nr=!!(I&&I!=="home")}catch{nr=!1}let zt=Et();if(!zt&&nr){let I=null;const k=()=>{if(zt=Et(),zt){try{I&&clearTimeout(I)}catch{}I=null;try{window.removeEventListener("tv:sidebar-sites-updated",k)}catch{}}};try{window.addEventListener("tv:sidebar-sites-updated",k)}catch{}try{I=setTimeout(()=>{try{window.removeEventListener("tv:sidebar-sites-updated",k)}catch{}zt||tr()},1200)}catch{tr()}}else zt||tr();try{window.addEventListener("tv:play-history-updated",()=>{$=!0,de()})}catch{}(async()=>{try{const I=await je({includePlayHistory:!0,includeFavorites:!0,includePanLoginSettings:tt==="shared",playHistoryLimit:20,favoritesLimit:50});M=Array.isArray(I&&I.playHistory)?I.playHistory:[],$=!1,J=Array.isArray(I&&I.favorites)?I.favorites:[],oe=!1,I&&typeof I.panLoginSettings=="object"&&(Se=I.panLoginSettings,me=!0),Yt()}catch{$=!0}finally{_e(),w&&se()}$&&de()})()}function Is(){try{As()}catch{}try{Ms()}catch{}const a=document.getElementById("homeDoubanConfig");if(!a)return;const p={doubanDataProxy:(a.getAttribute("data-douban-data-proxy")||"direct").trim(),doubanDataCustom:(a.getAttribute("data-douban-data-custom")||"").trim(),doubanImgProxy:(a.getAttribute("data-douban-img-proxy")||"direct-browser").trim(),doubanImgCustom:(a.getAttribute("data-douban-img-custom")||"").trim()},s=document.getElementById("homeHotMovieRow"),x=document.getElementById("homeHotTvRow"),t=document.getElementById("homeBangumiRow"),e=document.getElementById("homeHotShowRow"),u=document.getElementById("homeDoubanBrowse"),r=document.getElementById("doubanBrowseTitle"),n=document.getElementById("doubanBrowseStatus"),o=document.getElementById("doubanBrowseGrid"),i=document.getElementById("doubanFilterCategory"),c=document.getElementById("doubanFilterArea");if(!s||!x||!t||!e||!u||!r||!n||!o||!i||!c)return;document.querySelectorAll(".tv-scroll-row").forEach(O=>Xr(O));const f=O=>{const D=typeof O=="string"?O.trim():"";return D?/[?&=]$/.test(D)||D.endsWith("/")?D:`${D}/`:""},g=(O,D)=>{if(!D)return O;const ve=f(D);return ve.includes("cors-anywhere.com/")?`${ve}${O}`:`${ve}${encodeURIComponent(O)}`},y=()=>{const O=p.doubanDataProxy;return O==="cdn-tx"||O==="cmliussss-cdn-tencent"?{m:"https://m.douban.cmliussss.net",proxyBase:""}:O==="cdn-ali"||O==="cmliussss-cdn-ali"?{m:"https://m.douban.cmliussss.com",proxyBase:""}:O==="cors"||O==="cors-proxy-zwei"?{m:"https://m.douban.com",proxyBase:"https://ciao-cors.is-an.org/"}:O==="cors-anywhere"?{m:"https://m.douban.com",proxyBase:"https://cors-anywhere.com/"}:O==="custom"?{m:"https://m.douban.com",proxyBase:p.doubanDataCustom}:{m:"https://m.douban.com",proxyBase:""}},C=O=>{const D=typeof O=="string"?O.trim():"";return D?D.startsWith("//")?`https:${D}`:D.startsWith("http://")?`https://${D.slice(7)}`:D:""},A=O=>{const D=C(O),ve=H(D),te=[];if(ve&&te.push(ve),D&&D.includes("doubanio.com")){te.push(D.replace(/img\\d+\\.doubanio\\.com/g,"img3.doubanio.com")),te.push(D);const be=p.doubanImgProxy;be!=="server-proxy"&&be!=="custom"&&te.push(`/api/douban/image?url=${encodeURIComponent(D)}`)}const ue=[],pe=new Set;return te.forEach(be=>{const Le=typeof be=="string"?be.trim():"";!Le||pe.has(Le)||(pe.add(Le),ue.push(Le))}),ue},H=O=>{const D=C(O);if(!D)return D;const ve=p.doubanImgProxy;if(ve==="server-proxy")return`/api/douban/image?url=${encodeURIComponent(D)}`;if(ve==="custom")return p.doubanImgCustom?`${f(p.doubanImgCustom)}${encodeURIComponent(D)}`:D;if(!D.includes("doubanio.com"))return D;switch(ve){case"douban-cdn-ali":case"img3":return D.replace(/img\\d+\\.doubanio\\.com/g,"img3.doubanio.com");case"cdn-tx":case"cmliussss-cdn-tencent":return D.replace(/img\\d+\\.doubanio\\.com/g,"img.doubanio.cmliussss.net");case"cdn-ali":case"cmliussss-cdn-ali":return D.replace(/img\\d+\\.doubanio\\.com/g,"img.doubanio.cmliussss.com");case"direct-browser":case"direct":default:return D}},w=async(O,D=1e4)=>{const ve=new AbortController,te=setTimeout(()=>ve.abort(),D);try{const ue=await fetch(O,{signal:ve.signal,headers:{Accept:"application/json, text/plain, */*"}});if(!ue.ok)throw new Error(`HTTP ${ue.status}`);return await ue.json()}finally{clearTimeout(te)}},_=async({kind:O,category:D,hotType:ve,start:te,limit:ue})=>{const{m:pe,proxyBase:be}=y(),Le=new URL(`${pe}/rexxar/api/v2/subject/recent_hot/${O}`);Le.searchParams.set("start",String(te)),Le.searchParams.set("limit",String(ue)),Le.searchParams.set("category",D),Le.searchParams.set("type",ve);const fe=Le.toString(),Re=be?g(fe,be):fe,ne=await w(Re);return(Array.isArray(ne==null?void 0:ne.items)?ne.items:[]).map(he=>{var Te,Xe,Qe,st;return{id:String((he==null?void 0:he.id)||""),title:(he==null?void 0:he.title)||"",poster:((Te=he==null?void 0:he.pic)==null?void 0:Te.normal)||((Xe=he==null?void 0:he.pic)==null?void 0:Xe.large)||"",rate:(Qe=he==null?void 0:he.rating)!=null&&Qe.value?Number(he.rating.value).toFixed(1):"",year:((st=((he==null?void 0:he.card_subtitle)||"").match(/(\\d{4})/))==null?void 0:st[1])||"",isBangumi:!1}})},M=async(O=12e3)=>{const D=await w("https://api.bgm.tv/calendar",O);return Array.isArray(D)?D:[]},$=async()=>{const O=await w("https://api.bgm.tv/calendar",12e3),D=Array.isArray(O)?O:[],te=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date().getDay()],ue=D.find(be=>{var Le;return((Le=be==null?void 0:be.weekday)==null?void 0:Le.en)===te});return(Array.isArray(ue==null?void 0:ue.items)?ue.items:[]).filter(be=>be==null?void 0:be.images).map(be=>{var Le,fe,Re,ne,$e,he,Te;return{id:String((be==null?void 0:be.id)||""),title:(be==null?void 0:be.name_cn)||(be==null?void 0:be.name)||"",poster:((Le=be==null?void 0:be.images)==null?void 0:Le.large)||((fe=be==null?void 0:be.images)==null?void 0:fe.common)||((Re=be==null?void 0:be.images)==null?void 0:Re.medium)||((ne=be==null?void 0:be.images)==null?void 0:ne.small)||(($e=be==null?void 0:be.images)==null?void 0:$e.grid)||"",rate:(he=be==null?void 0:be.rating)!=null&&he.score?Number(be.rating.score).toFixed(1):"",year:((Te=((be==null?void 0:be.air_date)||"").split("-"))==null?void 0:Te[0])||"",isBangumi:!0}})},S=(O,D)=>{O.innerHTML="";const ve=document.createElement("div");ve.className="px-4 sm:px-6 text-sm text-gray-500",ve.textContent=D,O.appendChild(ve)},P=O=>O!=null&&O.id?(O==null?void 0:O.isBangumi)===!0?`https://bgm.tv/subject/${O.id}`:`https://movie.douban.com/subject/${O.id}`:"",J=(O,D,ve)=>{O.innerHTML="";const te=document.createDocumentFragment(),ue=[];D.forEach(pe=>{const be=document.createElement("div");be.className="min-w-[96px] w-24 sm:min-w-[180px] sm:w-44";const Le=document.createElement("div");Le.className="douban-card group w-full hover:z-[500]",Le.setAttribute("role","link"),Le.setAttribute("tabindex","0");const fe=()=>se(String((pe==null?void 0:pe.title)||""));Le.addEventListener("click",fe),Le.addEventListener("keydown",he=>{(he.key==="Enter"||he.key===" ")&&(he.preventDefault(),fe())});const Re=document.createElement("div");if(Re.className="douban-poster",pe.poster){const he=document.createElement("img"),Te=A(pe.poster),Xe=Te[0]||"";he.alt=pe.title||"",he.loading="lazy",he.decoding="async",he.className="w-full h-full object-cover opacity-0 transition-opacity transition-transform duration-300 ease-out group-hover:scale-105",he.dataset.src=Xe,he.dataset.started="0",he.dataset.fallbackStep="0",he.addEventListener("load",()=>{he.classList.remove("opacity-0")}),he.addEventListener("error",()=>{const Qe=Number(he.dataset.fallbackStep||"0"),st=Te[Qe+1];st&&(he.dataset.fallbackStep=String(Qe+1),he.setAttribute("src",st))}),Re.appendChild(he),ue.push(he)}Kr(Re);const ne=P(pe);if(ne){const he=document.createElement("a");he.href=ne,he.target="_blank",he.rel="noopener noreferrer",he.className="absolute top-2 left-2 opacity-0 -translate-x-2 pointer-events-none transition-all duration-300 ease-in-out delay-100 sm:group-hover:opacity-100 sm:group-hover:translate-x-0 sm:group-hover:pointer-events-auto",he.addEventListener("click",Te=>Te.stopPropagation()),he.innerHTML='<div class="bg-green-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md hover:bg-green-600 hover:scale-[1.1] transition-all duration-300 ease-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div>',Re.appendChild(he)}if(pe.rate){const he=document.createElement("div");he.className="absolute top-2 right-2 bg-pink-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md transition-all duration-300 ease-out group-hover:scale-110",he.textContent=pe.rate,Re.appendChild(he)}const $e=document.createElement("div");$e.className="douban-card-title",$e.textContent=pe.title||"",Le.appendChild(Re),Le.appendChild($e),be.appendChild(Le),te.appendChild(be)}),O.appendChild(te),requestAnimationFrame(()=>{requestAnimationFrame(()=>{ue.forEach(pe=>{if(pe.dataset.started==="1")return;const be=pe.dataset.src||"";be&&(pe.dataset.started="1",pe.setAttribute("src",be))})})})},oe=20,me={movie:"电影",tv:"剧集",anime:"动漫",show:"综艺"},Se={movie:{kind:"movie",showArea:!0,secondaryLabel:"地区",defaultCategory:"热门",defaultArea:"全部",categories:[{label:"热门电影",value:"热门"},{label:"最新电影",value:"最新"},{label:"豆瓣高分",value:"豆瓣高分"},{label:"冷门佳片",value:"冷门佳片"}],areas:[{label:"全部",value:"全部"},{label:"华语",value:"华语"},{label:"欧美",value:"欧美"},{label:"韩国",value:"韩国"},{label:"日本",value:"日本"}]},tv:{kind:"tv",showArea:!0,secondaryLabel:"类型",categoryConst:"tv",defaultCategory:"all",defaultArea:"tv",categories:[{label:"全部",value:"all"},{label:"动漫",value:"tv_animation"},{label:"纪录片",value:"tv_documentary"}],areas:[{label:"全部",value:"tv"},{label:"国产",value:"tv_domestic"},{label:"欧美",value:"tv_american"},{label:"日本",value:"tv_japanese"},{label:"韩国",value:"tv_korean"}]},anime:{kind:"bangumi",showArea:!0,secondaryLabel:"星期",defaultCategory:"week",defaultArea:"Mon",categories:[{label:"本周",value:"week"},{label:"今日",value:"today"}],areas:[{label:"周一",value:"Mon"},{label:"周二",value:"Tue"},{label:"周三",value:"Wed"},{label:"周四",value:"Thu"},{label:"周五",value:"Fri"},{label:"周六",value:"Sat"},{label:"周日",value:"Sun"}]},show:{kind:"tv",showArea:!0,secondaryLabel:"类型",categoryConst:"show",defaultCategory:"all",defaultArea:"show",categories:[{label:"全部",value:"all"}],areas:[{label:"全部",value:"show"},{label:"国内",value:"show_domestic"},{label:"国外",value:"show_foreign"}]}};let je=0,T={type:"movie",category:Se.movie.defaultCategory,area:Se.movie.defaultArea};const V=()=>{o.innerHTML=""},Y=O=>{if(!O){n.classList.add("hidden"),n.textContent="";return}n.textContent=O,n.classList.remove("hidden")},_e=(O,D)=>{Array.from(O.querySelectorAll("button.douban-chip")).forEach(ve=>{ve.classList.toggle("is-active",(ve.getAttribute("data-value")||"")===D)})},Pe=(O,D,ve,te)=>{O.innerHTML="",D.forEach(ue=>{const pe=document.createElement("button");pe.type="button",pe.className="douban-chip",pe.textContent=ue.label,pe.setAttribute("data-value",ue.value),ue.value===ve&&pe.classList.add("is-active"),pe.addEventListener("click",()=>te(ue.value)),O.appendChild(pe)})},se=O=>{const D=typeof O=="string"?O.trim():"";if(D){try{window.dispatchEvent(new CustomEvent("tv:home-view",{detail:{view:"search"}}))}catch{}try{window.dispatchEvent(new CustomEvent("tv:search",{detail:{q:D}}))}catch{}}},de=(O,D)=>{if(o.innerHTML="",!Array.isArray(O)||!O.length){Y("暂无相关内容");return}Y("");let ve=null;if(typeof IntersectionObserver<"u")try{ve=new IntersectionObserver(ue=>{ue.forEach(pe=>{if(!pe.isIntersecting)return;const be=pe.target,Le=be&&be.dataset?be.dataset.src:"";Le&&!be.getAttribute("src")&&be.setAttribute("src",Le),ve&&ve.unobserve(be)})},{root:null,rootMargin:"0px",threshold:.01})}catch{ve=null}const te=document.createDocumentFragment();O.forEach(ue=>{const pe=document.createElement("div");pe.className="w-full";const be=()=>se(String((ue==null?void 0:ue.title)||"")),Le=document.createElement("div");Le.className="douban-card group w-full",Le.setAttribute("role","link"),Le.setAttribute("tabindex","0"),Le.addEventListener("click",be),Le.addEventListener("keydown",$e=>{($e.key==="Enter"||$e.key===" ")&&($e.preventDefault(),be())});const fe=document.createElement("div");if(fe.className="douban-poster",ue.poster){const $e=document.createElement("img"),he=A(ue.poster),Te=he[0]||"";$e.alt=ue.title||"",$e.loading="lazy",$e.decoding="async",$e.className="w-full h-full object-cover opacity-0 transition-opacity transition-transform duration-300 ease-out group-hover:scale-105",$e.dataset.src=Te,$e.dataset.fallbackStep="0",$e.addEventListener("load",()=>{$e.classList.remove("opacity-0")}),$e.addEventListener("error",()=>{const Xe=Number($e.dataset.fallbackStep||"0"),Qe=he[Xe+1];Qe&&($e.dataset.fallbackStep=String(Xe+1),$e.setAttribute("src",Qe))}),fe.appendChild($e),ve?ve.observe($e):$e.setAttribute("src",$e.dataset.src||"")}if(ue.rate){const $e=document.createElement("div");$e.className="absolute top-2 right-2 bg-pink-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md transition-all duration-300 ease-out group-hover:scale-110",$e.textContent=ue.rate,fe.appendChild($e)}Kr(fe);const Re=P(ue);if(Re){const $e=document.createElement("a");$e.href=Re,$e.target="_blank",$e.rel="noopener noreferrer",$e.className="absolute top-2 left-2 opacity-0 -translate-x-2 pointer-events-none transition-all duration-300 ease-in-out delay-100 sm:group-hover:opacity-100 sm:group-hover:translate-x-0 sm:group-hover:pointer-events-auto",$e.addEventListener("click",he=>he.stopPropagation()),$e.innerHTML='<div class="bg-green-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md hover:bg-green-600 hover:scale-[1.1] transition-all duration-300 ease-out"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></div>',fe.appendChild($e)}const ne=document.createElement("div");ne.className="douban-card-title",ne.textContent=ue.title||"",Le.appendChild(fe),Le.appendChild(ne),pe.appendChild(Le),te.appendChild(pe)}),o.appendChild(te)},Me=async({type:O,category:D,area:ve})=>{const te=je+=1,ue=Se[O]?O:"movie",pe=Se[ue];r.textContent=me[ue]||"豆瓣";const be=document.getElementById("doubanFilterSecondaryLabel");be&&(be.textContent=ue==="movie"?"地区":pe.secondaryLabel?String(pe.secondaryLabel):"筛选");const Le=c&&c.closest?c.closest(".douban-filter-row"):null;pe.showArea?Le&&Le.classList.remove("hidden"):(Le&&Le.classList.add("hidden"),c.innerHTML="");const fe=D||pe.defaultCategory||(pe.categories&&pe.categories[0]?pe.categories[0].value:"");let Re=ve||pe.defaultArea||(pe.areas&&pe.areas[0]?pe.areas[0].value:"");ue==="anime"&&fe==="today"&&(Re=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date().getDay()]),Pe(i,pe.categories,fe,ne=>{if(T={...T,type:ue,category:ne},ue==="anime"&&ne==="today"){const $e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];T.area=$e[new Date().getDay()]}_e(i,ne),Me({type:ue,category:ne,area:T.area})}),pe.showArea&&Pe(c,pe.areas,Re,ne=>{T={...T,type:ue,area:ne},_e(c,ne),Me({type:ue,category:T.category,area:ne})}),Y("加载中..."),V();try{if(ue==="anime"){const Xe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][new Date().getDay()],st=(fe==="today"?"today":"week")==="today"?Xe:Re,xt=await M(12e3);if(te!==je)return;const bt=new Map;(Array.isArray(xt)?xt:[]).forEach(Ae=>{var Ie;const ge=String(((Ie=Ae==null?void 0:Ae.weekday)==null?void 0:Ie.en)||"").trim();ge&&bt.set(ge,Array.isArray(Ae==null?void 0:Ae.items)?Ae.items:[])});const ht=(bt.get(st)||[]).filter(Ae=>Ae&&Ae.images).map(Ae=>{var ge,Ie,Je,L,B,le,re;return{id:String((Ae==null?void 0:Ae.id)||""),title:(Ae==null?void 0:Ae.name_cn)||(Ae==null?void 0:Ae.name)||"",poster:((ge=Ae==null?void 0:Ae.images)==null?void 0:ge.large)||((Ie=Ae==null?void 0:Ae.images)==null?void 0:Ie.common)||((Je=Ae==null?void 0:Ae.images)==null?void 0:Je.medium)||((L=Ae==null?void 0:Ae.images)==null?void 0:L.small)||((B=Ae==null?void 0:Ae.images)==null?void 0:B.grid)||"",rate:(le=Ae==null?void 0:Ae.rating)!=null&&le.score?Number(Ae.rating.score).toFixed(1):"",year:((re=((Ae==null?void 0:Ae.air_date)||"").split("-"))==null?void 0:re[0])||"",isBangumi:!0}});de(ht,"tv");return}const ne=ue==="movie"?fe:pe.categoryConst||"tv",$e=ue==="movie"?Re:ue==="tv"?fe&&fe!=="all"?fe:Re:ue==="show"?Re:fe,he=await _({kind:pe.kind,category:ne,hotType:$e,start:0,limit:60});if(te!==je)return;de(he,ue==="movie"?"movie":"tv")}catch(ne){if(te!==je)return;Y(`加载失败：${ne&&ne.message?ne.message:"未知错误"}`),V()}};window.addEventListener("tv:douban-browse",O=>{const D=O&&O.detail&&typeof O.detail.type=="string"?O.detail.type.trim():"",ve=Se[D]?D:"movie",te=Se[ve];if(T={type:ve,category:te.defaultCategory||(te.categories&&te.categories[0]?te.categories[0].value:""),area:te.defaultArea||(te.areas&&te.areas[0]?te.areas[0].value:"")},ve==="anime"&&T.category==="today"){const ue=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];T.area=ue[new Date().getDay()]}Me({type:T.type,category:T.category,area:T.area})});try{const D=(localStorage.getItem("tv_server_home_view")||"").trim();if(D&&D.startsWith("douban:")){const ve=D.slice(7),te=Se[ve]?ve:"movie",ue=Se[te];if(T={type:te,category:ue.defaultCategory||(ue.categories&&ue.categories[0]?ue.categories[0].value:""),area:ue.defaultArea||(ue.areas&&ue.areas[0]?ue.areas[0].value:"")},te==="anime"&&T.category==="today"){const pe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];T.area=pe[new Date().getDay()]}Me({type:T.type,category:T.category,area:T.area})}}catch{}let K=0;const ke=async()=>{const O=K+=1;try{const D=await _({kind:"movie",category:"热门",hotType:"全部",start:0,limit:oe});if(O!==K)return;Array.isArray(D)&&D.length?J(s,D,"movie"):S(s,"暂无相关内容")}catch{if(O!==K)return;S(s,"暂无相关内容")}try{const D=await _({kind:"tv",category:"tv",hotType:"tv",start:0,limit:oe});if(O!==K)return;Array.isArray(D)&&D.length?J(x,D,""):S(x,"暂无相关内容")}catch{if(O!==K)return;S(x,"暂无相关内容")}try{const D=await $();if(O!==K)return;Array.isArray(D)&&D.length?J(t,D.slice(0,oe),""):S(t,"暂无相关内容")}catch{if(O!==K)return;S(t,"暂无相关内容")}try{const D=await _({kind:"tv",category:"show",hotType:"show",start:0,limit:oe});if(O!==K)return;Array.isArray(D)&&D.length?J(e,D,""):S(e,"暂无相关内容")}catch{if(O!==K)return;S(e,"暂无相关内容")}};let ce=!1;const G=()=>{ce||(ce=!0,ke())};try{window.addEventListener("tv:home-view",O=>{(O&&O.detail&&typeof O.detail.view=="string"?O.detail.view.trim():"")==="home"&&G()})}catch{}if((()=>{try{const D=(localStorage.getItem("tv_server_last_site_key")||"").trim();if(!D||D==="home")return!1;const ve=document.getElementById("homeSiteNavList");if(!ve)return!1;const te=D,ue=typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(te):te;return!!ve.querySelector(`a[data-site-key="${ue}"]`)}catch{return!1}})()){const O=document.getElementById("homeSiteSections"),D=document.getElementById("homeDoubanSections"),ve=document.getElementById("homeDoubanBrowse");O&&O.classList.remove("hidden"),D&&D.classList.add("hidden"),ve&&ve.classList.add("hidden")}else try{const D=(localStorage.getItem("tv_server_home_view")||"").trim();(!D||D==="home")&&G()}catch{G()}}const Rr=(a,p)=>{const s=a.__vccOpts||a;for(const[x,t]of p)s[x]=t;return s},Ts={class:"tv-us-body"},Ps={class:"tv-us-form"},Bs={class:"tv-us-row"},Fs=["disabled"],Rs={class:"tv-us-row"},Ns=["disabled"],Os={class:"tv-us-row"},qs=["disabled","placeholder"],Ds={class:"tv-us-row"},Hs=["disabled"],zs={class:"tv-us-accordion"},Vs={key:0,class:"tv-us-acc-item"},Us=["data-open"],Ws={class:"tv-us-acc-body"},Ks={key:0,class:"tv-us-acc-status"},Xs={key:1,class:"tv-us-acc-status error"},Gs={key:2,class:"tv-us-pan-list"},Ys={key:0,class:"tv-us-acc-status"},Zs={key:1,class:"tv-us-pan-table"},Js={class:"tv-us-pan-col name"},Qs={class:"tv-us-pan-name"},en={class:"tv-us-pan-col enable"},tn=["data-on","disabled","onClick"],rn={class:"tv-us-pan-col order"},an={class:"tv-us-order-btns"},sn=["disabled","onClick"],nn=["disabled","onClick"],on={key:2,class:"tv-us-acc-status"},ln={key:3,class:"tv-us-acc-status success"},cn={key:4,class:"tv-us-acc-status error"},un={key:1,class:"tv-us-acc-item"},dn=["data-open"],pn={class:"tv-us-acc-body"},fn={class:"tv-us-pan-cookie"},hn={class:"tv-us-pan-tabs"},vn=["data-active","onClick"],mn={key:0,class:"tv-us-acc-status"},gn={key:1,class:"tv-us-acc-status error"},yn={key:2,class:"tv-us-pan-editor"},bn=["disabled","placeholder"],wn={key:1,class:"tv-us-pan-account"},xn={class:"tv-us-row"},kn=["disabled"],Sn={class:"tv-us-row"},_n=["disabled"],En={class:"tv-us-pan-actions"},Cn={key:0,class:"tv-us-acc-status success"},$n={key:1,class:"tv-us-acc-status error"},jn=["disabled"],Ln={key:2,class:"tv-us-acc-item"},An=["data-open"],Mn={class:"tv-us-acc-body"},In={key:0,class:"tv-us-acc-status"},Tn={key:1,class:"tv-us-acc-status error"},Pn={key:2,class:"tv-us-pan-list"},Bn={key:0,class:"tv-us-acc-status"},Fn={key:1,class:"tv-us-pan-table","data-kind":"sites"},Rn={key:0,class:"tv-us-sites-actions"},Nn={class:"tv-us-acc-status"},On={class:"tv-us-sites-actions__btns"},qn=["disabled"],Dn=["disabled"],Hn=["disabled"],zn={class:"tv-us-pan-head"},Vn={class:"tv-us-pan-col select"},Un=["checked"],Wn={class:"tv-us-pan-col select"},Kn=["checked","onChange"],Xn={class:"tv-us-pan-col name"},Gn={class:"tv-us-pan-name"},Yn={class:"tv-us-pan-col availability"},Zn=["data-status"],Jn={class:"tv-us-availability-text"},Qn={class:"tv-us-pan-col enable"},eo=["data-on","disabled","onClick"],to={class:"tv-us-pan-col enable"},ro=["data-on","disabled","onClick"],ao={class:"tv-us-pan-col order"},so={class:"tv-us-order-btns"},no=["disabled","onClick"],oo=["disabled","onClick"],io={key:3,class:"tv-us-acc-item"},lo=["data-open"],co={class:"tv-us-acc-body"},uo={key:0,class:"tv-us-acc-status"},po={key:1,class:"tv-us-acc-status error"},fo={key:2,class:"tv-us-pan-list"},ho={key:0,class:"tv-us-acc-status"},vo={key:1,class:"tv-us-pan-table","data-kind":"search"},mo={class:"tv-us-pan-col name"},go={class:"tv-us-pan-name"},yo={class:"tv-us-pan-col enable"},bo=["data-on","disabled","onClick"],wo={class:"tv-us-pan-col order"},xo={class:"tv-us-order-btns"},ko=["disabled","onClick"],So=["disabled","onClick"],_o={class:"tv-us-footer"},Eo=["data-kind"],Co=["disabled"],$o={__name:"UserSettingsModal",props:{bootstrap:{type:Object,required:!1,default:null}},setup(a){const p=a,s=ae(!1),x=ae(!1),t=ae(!1),e=ae(""),u=ae(""),r=ae(""),n=ae(""),o=ae(!1),i=ae("idle"),c=ae("5"),f=ae([]),g=ae(""),y=De(()=>{const k=p&&p.bootstrap&&p.bootstrap.user&&p.bootstrap.user.role;return typeof k=="string"?k:""}),C=De(()=>{const k=p&&p.bootstrap&&p.bootstrap.user&&p.bootstrap.user.username;return typeof k=="string"?k:""}),A=De(()=>y.value!=="admin"&&y.value!=="shared"),H=De(()=>y.value!=="admin"&&y.value!=="shared"),w=ae(""),_=ae(""),M=()=>{w.value="",_.value=""},$=()=>{o.value=!1,i.value="idle",ge.value=!1,Ie.value=!1,Je.value=!1,L.value="",B.value="",le.value="",re.value=[],Ye.value=!1,lt.value=!1,tt.value=!1,nt.value="",St.value="",Kt.value="",Yt.value=Ge[0]?Ge[0].key:"",Lt.value="",Xt.value="",Tt.value="",Ht.value=new Set,Pe.value=!1,se.value=!1,de.value=!1,Me.value="",K.value=[],ke.value=new Set,Te.value=!1,Xe.value=!1,Qe.value=""},S=()=>{ge.value=!1,Ie.value=!1,Je.value=!1,L.value="",B.value="",le.value="",re.value=[],Ye.value=!1,lt.value=!1,tt.value=!1,nt.value="",St.value="",Kt.value="",Lt.value="",Xt.value="",Tt.value="",Ht.value=new Set,Pe.value=!1,se.value=!1,de.value=!1,Me.value="",K.value=[],ke.value=new Set,Te.value=!1,Xe.value=!1,Qe.value=""},P=()=>{s.value=!1,M(),$()},J=()=>P(),oe=async()=>{x.value=!0,M();try{const k=await sr("/api/user/settings",{cacheMs:0});if(!k||k.success!==!0)throw new Error(k&&k.message||"加载失败");const h=k.settings&&typeof k.settings=="object"?k.settings:{};e.value=typeof h.catApiBase=="string"?h.catApiBase:"",u.value=typeof h.catApiBase=="string"?h.catApiBase:"",r.value=typeof h.catApiKey=="string"?h.catApiKey:"";const b=h.searchThreadCount!=null?Number(h.searchThreadCount):5;c.value=String(Number.isFinite(b)&&b>0?Math.floor(b):5),n.value=typeof h.catProxy=="string"?h.catProxy:"",f.value=Array.isArray(h.searchSiteOrder)?h.searchSiteOrder:[],g.value=typeof h.searchCoverSite=="string"?h.searchCoverSite:"",i.value="idle"}catch(k){_.value="error",w.value=k&&k.message||"加载失败"}finally{x.value=!1}},me=async()=>{const k=er(e.value);if(!k){i.value="idle";return}if(!o.value){o.value=!0;try{const h=new URL("admin/settings",k),b={},F=(C.value||"").trim();F&&(b["X-TV-User"]=F);const j=await fetch(h.toString(),{method:"GET",headers:b,credentials:"omit"}),ee=await j.json().catch(()=>({}));if(!j.ok){const Oe=ee&&(ee.message||ee.error)?String(ee.message||ee.error):`HTTP ${j.status}`;throw new Error(Oe)}let Ee="";ee&&typeof ee=="object"&&ee.success===!0&&ee.settings&&typeof ee.settings.proxy=="string"&&(Ee=ee.settings.proxy),n.value=Ee||"",i.value="ok"}catch{i.value="error"}finally{o.value=!1}}},Se=De(()=>er(e.value)?o.value?"读取中...":i.value==="error"?"CatPawOpen 接口异常":"保存后将同步到 CatPawOpen 并立即生效（留空关闭）":"CatPawOpen 接口地址未设置"),je=async()=>{if(t.value)return;M();const k=Number(c.value),h=Number.isFinite(k)?Math.floor(k):NaN;if(!Number.isFinite(h)||h<1||h>50){_.value="error",w.value="搜索线程数必须是 1-50 的整数";return}t.value=!0;const b=er(u.value),F=er(e.value),j=!!(F&&F!==b);let ee=null,Ee="";if(er(e.value))try{const Ue=await T("full-config",{method:"GET"});ee=(Ue&&Ue.video&&Array.isArray(Ue.video.sites)?Ue.video.sites:[]).map(Ve=>({key:Ve&&typeof Ve.key=="string"?Ve.key:"",name:Ve&&typeof Ve.name=="string"?Ve.name:"",api:Ve&&typeof Ve.api=="string"?Ve.api:""})).filter(Ve=>Ve.key&&Ve.api)}catch(Ue){Ee=Ue&&Ue.message?String(Ue.message):"站点列表更新失败",ee=null}try{const Ue=await ya("/api/user/settings",{catApiBase:String(e.value||"").trim(),catApiKey:String(r.value||""),catProxy:j?void 0:String(n.value||""),searchThreadCount:h,searchSiteOrder:Array.isArray(f.value)?f.value:[],searchCoverSite:String(g.value||""),sites:Array.isArray(ee)?ee:void 0},{dedupe:!1});if(!Ue||Ue.success!==!0)throw new Error(Ue&&Ue.message||"保存失败");u.value=F;try{const Ze=document.getElementById("homeDoubanConfig");Ze&&(Ze.setAttribute("data-cat-api-base",u.value||""),Ze.setAttribute("data-search-thread-count",String(h)),Ze.setAttribute("data-search-site-order",JSON.stringify(f.value||[])),Ze.setAttribute("data-search-cover-site",String(g.value||""))),window.dispatchEvent(new CustomEvent("tv:user-settings-updated",{detail:{catApiBase:u.value||"",searchThreadCount:h,searchSiteOrder:f.value||[],searchCoverSite:String(g.value||"")}}))}catch{}const We=Ue&&Ue.sitesSync&&typeof Ue.sitesSync=="object"?Ue.sitesSync:null;if(We&&We.ok===!1){_.value="error",w.value=We&&We.message?`站点列表更新失败：${We.message}`:"站点列表更新失败",S();return}if(Ee){_.value="success",w.value=`保存成功（站点列表更新失败：${Ee}）`,S();return}const Ve=[];if(u.value)try{if(!j)await T("admin/settings",{method:"PUT",body:JSON.stringify({proxy:String(n.value||"")})}),i.value="ok";else{await me();try{await ya("/api/user/settings",{catApiBase:String(e.value||"").trim(),catApiKey:String(r.value||""),catProxy:String(n.value||""),searchThreadCount:h},{dedupe:!1})}catch{}}}catch(Ze){i.value="error",Ve.push(Ze&&Ze.message?String(Ze.message):"同步失败")}if(y.value==="shared"&&u.value){const Ze=[];try{const at=await sr("/api/user/pan-login-settings",{cacheMs:0});if(!at||at.success!==!0)throw new Error(at&&at.message||"读取失败");const gt=at.settings&&typeof at.settings=="object"?at.settings:{},At=Object.keys(gt||{});for(let Ct=0;Ct<At.length;Ct+=1){const Vt=typeof At[Ct]=="string"?At[Ct].trim():"";if(!Vt)continue;const Ot=gt[Vt];if(!(!Ot||typeof Ot!="object"))try{typeof Ot.cookie=="string"?await T(`website/${encodeURIComponent(Vt)}/cookie`,{method:"PUT",body:JSON.stringify({cookie:Ot.cookie})}):(typeof Ot.username=="string"||typeof Ot.password=="string")&&await T(`website/${encodeURIComponent(Vt)}/account`,{method:"PUT",body:JSON.stringify({username:typeof Ot.username=="string"?Ot.username:"",password:typeof Ot.password=="string"?Ot.password:""})})}catch(Mr){Ze.push(`${Vt}: ${Mr&&Mr.message||"同步失败"}`)}}}catch(at){Ze.push(`读取后台 Cookie 配置失败：${at&&at.message||"未知错误"}`)}if(Ze.length>0){_.value="success",w.value=`保存成功，但 Cookie 同步失败：${Ze.slice(0,3).join("；")}${Ze.length>3?`…（共 ${Ze.length} 项）`:""}`,S();return}}_.value="success",Ve.length>0?w.value=`保存成功，但 CatPawOpen 代理同步失败：${Ve[0]}`:w.value=We&&We.refreshed?`保存成功（站点 ${We.count||0}）`:"保存成功",S()}catch(Ue){_.value="error",w.value=Ue&&Ue.message||"保存失败"}finally{t.value=!1}},T=async(k,h={})=>{const b=er(e.value);if(!b)throw new Error("CatPawOpen 接口地址未设置");const F=new URL(k.replace(/^\//,""),b),j=Object.assign({},h.headers&&typeof h.headers=="object"?h.headers:{});j["Content-Type"]=j["Content-Type"]||"application/json";const ee=(C.value||"").trim();ee&&(j["X-TV-User"]=ee);const Ee=await fetch(F.toString(),{method:h.method||"GET",headers:j,body:h.body,credentials:"omit"}),Oe=await Ee.json().catch(()=>({}));if(!Ee.ok){const Ue=Oe&&(Oe.message||Oe.error)?String(Oe.message||Oe.error):`HTTP ${Ee.status}`,We=new Error(Ue);throw We.status=Ee.status,We}if(Oe&&typeof Oe=="object"&&Object.prototype.hasOwnProperty.call(Oe,"code")){if(Oe.code===0)return Oe.data;throw new Error(Oe&&Oe.message||"CatPawOpen 网站接口返回异常")}return Oe},V=De(()=>!!er(e.value)),Y=De(()=>y.value==="user"),_e=De(()=>y.value!=="shared"||!!(u.value||"").trim()),Pe=ae(!1),se=ae(!1),de=ae(!1),Me=ae(""),K=ae([]),ke=ae(new Set),ce=De(()=>ke.value?ke.value.size:0),G=De(()=>{const h=(Array.isArray(K.value)?K.value:[]).map(F=>F&&typeof F.key=="string"?F.key:"").filter(F=>F);if(!h.length)return!1;const b=ke.value||new Set;return h.every(F=>b.has(F))}),q=()=>{ke.value=new Set},Z=k=>{const h=typeof k=="string"?k:"";if(!h)return;const b=new Set(ke.value||[]);b.has(h)?b.delete(h):b.add(h),ke.value=b},O=k=>{const h=typeof k=="string"?k:"";return!!(h&&ke.value&&ke.value.has(h))},D=()=>{const h=(Array.isArray(K.value)?K.value:[]).map(b=>b&&typeof b.key=="string"?b.key:"").filter(b=>b);h.length&&(ke.value=G.value?new Set:new Set(h))},ve=async()=>{if(Y.value&&!V.value){Me.value="CatPawOpen 接口地址未设置",K.value=[],q();return}if(!se.value){se.value=!0,Me.value="";try{const k=await sr("/api/user/sites",{cacheMs:0});if(!k||k.success!==!0)throw new Error(k&&k.message||"加载失败");K.value=Array.isArray(k.sites)?k.sites:[],q()}catch(k){Me.value=k&&k.message||"加载失败",K.value=[],q()}finally{se.value=!1}}},te=async()=>{if(Pe.value=!Pe.value,Pe.value){if(Y.value&&!V.value){se.value=!1,Me.value="CatPawOpen 接口地址未设置",K.value=[];return}await ve()}},ue=async(k,h)=>{const b=typeof k=="string"?k.trim():"";if(!b)return;const F=await ir("/api/user/sites/availability",{key:b,availability:String(h||"")},{dedupe:!1});if(!F||F.success!==!0)throw new Error(F&&F.message||"保存失败")},pe=k=>{const h=typeof k=="string"?k.trim():"";if(!h)return"";const b=h.match(/\/spider\/([^/]+)\//);return b&&b[1]?String(b[1]):""},be=async k=>{const h=er(e.value);if(!h)throw new Error("CatPawOpen 接口地址未设置");const b=k&&typeof k.api=="string"?k.api:"";if(pe(b)==="baseset"){const Ee=new URL("website",h),Oe={},Ue=(C.value||"").trim();Ue&&(Oe["X-TV-User"]=Ue);const We=await fetch(Ee.toString(),{method:"GET",headers:Oe,credentials:"omit"});if(!We.ok)throw new Error(`HTTP ${We.status}`);return"valid"}const j=await kr({apiBase:h,username:C.value,action:"search",spiderApi:b,payload:{wd:"斗破",page:1}});return(j&&Array.isArray(j.list)&&j.list||j&&j.data&&Array.isArray(j.data.list)&&j.data.list||[]).length>0?"valid":"unknown"},Le=async()=>{if(ce.value){if(!V.value){Me.value="CatPawOpen 接口地址未设置";return}de.value=!0,Me.value="";try{const k=Array.isArray(K.value)?K.value:[];for(let h=0;h<k.length;h+=1){const b=k[h],F=b&&typeof b.key=="string"?b.key:"";if(!F||!O(F))continue;let j="invalid";try{j=await be(b)}catch{j="invalid"}K.value=K.value.map(ee=>ee&&ee.key===F?{...ee,availability:j}:ee),await ue(F,j)}}catch(k){Me.value=k&&k.message||"检测失败"}finally{de.value=!1}}},fe=async k=>{const h=!!k;if(ce.value){de.value=!0,Me.value="";try{const b=Array.isArray(K.value)?K.value:[];for(let F=0;F<b.length;F+=1){const j=b[F],ee=j&&typeof j.key=="string"?j.key:"";if(!ee||!O(ee))continue;const Ee=await ir("/api/user/sites/status",{key:ee,enabled:h},{dedupe:!1});if(!Ee||Ee.success!==!0)throw new Error(Ee&&Ee.message||"保存失败");K.value=K.value.map(Oe=>Oe&&Oe.key===ee?{...Oe,enabled:h}:Oe)}}catch(b){Me.value=b&&b.message||"操作失败"}finally{de.value=!1}}},Re=async()=>{const k=(K.value||[]).map(h=>h&&h.key).filter(h=>typeof h=="string"&&h.trim());de.value=!0;try{const h=await ir("/api/user/sites/order",{order:k},{dedupe:!1});if(!h||h.success!==!0)throw new Error(h&&h.message||"保存失败")}finally{de.value=!1}},ne=async(k,h)=>{const b=K.value.slice(),F=k+h;if(F<0||F>=b.length)return;const j=b[k];b[k]=b[F],b[F]=j,K.value=b;try{await Re()}catch(ee){Me.value=ee&&ee.message||"排序保存失败",await ve()}},$e=async k=>{const h=K.value[k];if(!h||!h.key)return;const b=!h.enabled;de.value=!0;try{const F=await ir("/api/user/sites/status",{key:h.key,enabled:b},{dedupe:!1});if(!F||F.success!==!0)throw new Error(F&&F.message||"保存失败");K.value[k]={...h,enabled:b}}catch(F){Me.value=F&&F.message||"保存失败"}finally{de.value=!1}},he=async k=>{const h=K.value[k];if(!h||!h.key)return;const b=!h.home;de.value=!0;try{const F=await ir("/api/user/sites/home",{key:h.key,home:b},{dedupe:!1});if(!F||F.success!==!0)throw new Error(F&&F.message||"保存失败");K.value[k]={...h,home:b}}catch(F){Me.value=F&&F.message||"保存失败"}finally{de.value=!1}},Te=ae(!1),Xe=ae(!1),Qe=ae(""),st=k=>{const h=Array.isArray(k)?k:[],b=h.map(We=>We&&typeof We.key=="string"?We.key:"").filter(We=>We);if(!b.length){f.value=[],g.value="";return}const F=new Set(b),j=Array.isArray(f.value)?f.value:[],ee=[],Ee=new Set;j.forEach(We=>{const Ve=typeof We=="string"?We.trim():"";!Ve||!F.has(Ve)||Ee.has(Ve)||(Ee.add(Ve),ee.push(Ve))}),b.forEach(We=>{!We||Ee.has(We)||(Ee.add(We),ee.push(We))}),f.value=ee;const Oe=typeof g.value=="string"?g.value.trim():"";if(Oe&&F.has(Oe))return;const Ue=h.find(We=>We&&We.enabled)||null;g.value=Ue&&Ue.key||ee[0]||""},xt=De(()=>{const k=Array.isArray(K.value)?K.value:[],h=new Map;k.forEach(ee=>{ee&&typeof ee.key=="string"&&h.set(ee.key,ee)});const b=Array.isArray(f.value)?f.value:[],F=[],j=new Set;return b.forEach(ee=>{const Ee=typeof ee=="string"?ee.trim():"";if(!Ee||j.has(Ee))return;const Oe=h.get(Ee);Oe&&(j.add(Ee),F.push(Oe))}),k.forEach(ee=>{const Ee=ee&&typeof ee.key=="string"?ee.key:"";!Ee||j.has(Ee)||(j.add(Ee),F.push(ee))}),F}),bt=async()=>{Xe.value=!0,Qe.value="";try{(!Array.isArray(K.value)||K.value.length===0)&&await ve(),st(K.value)}catch(k){Qe.value=k&&k.message||"加载失败"}finally{Xe.value=!1}},ot=async()=>{Te.value=!Te.value,Te.value&&await bt()},ht=k=>{const h=typeof k=="string"?k.trim():"";h&&(g.value=h)},Ae=(k,h)=>{const b=xt.value,F=b[k],j=b[k+h];if(!F||!j)return;const ee=Array.isArray(f.value)?f.value.slice():[],Ee=ee.findIndex(We=>We===F.key),Oe=ee.findIndex(We=>We===j.key);if(Ee<0||Oe<0)return;const Ue=ee[Ee];ee[Ee]=ee[Oe],ee[Oe]=Ue,f.value=ee},ge=ae(!1),Ie=ae(!1),Je=ae(!1),L=ae(""),B=ae(""),le=ae(""),re=ae([]),Be=async()=>{if(!Ie.value){Ie.value=!0,L.value="",B.value="",le.value="";try{const k=await T("website/pans/list"),h=Array.isArray(k)?k:[];re.value=h.map(b=>({key:b&&typeof b.key=="string"?b.key:"",name:b&&typeof b.name=="string"?b.name:"",enable:!!(b&&b.enable)})).filter(b=>b.key)}catch(k){L.value=k&&k.message||"加载失败",re.value=[]}finally{Ie.value=!1}}},qe=async()=>{if(!Je.value){Je.value=!0,B.value="",le.value="";try{const k=(re.value||[]).map(h=>({key:h.key,name:h.name,enable:!!h.enable}));await T("website/pans/list",{method:"PUT",body:JSON.stringify({list:k})}),B.value="同步成功"}catch(k){le.value=k&&k.message||"同步失败"}finally{Je.value=!1}}},mt=()=>{ge.value=!ge.value,ge.value&&!re.value.length&&Be()},Ne=k=>{const h=Array.isArray(re.value)?re.value.slice():[],b=h[k];b&&(h[k]={...b,enable:!b.enable},re.value=h,qe())},we=(k,h)=>{const b=Array.isArray(re.value)?re.value.slice():[],F=k+h;if(k<0||k>=b.length||F<0||F>=b.length)return;const j=b[k];b[k]=b[F],b[F]=j,re.value=b,qe()},Ge=[{key:"baidu",name:"百度",type:"cookie"},{key:"quark",name:"夸克",type:"cookie"},{key:"uc",name:"UC",type:"cookie"},{key:"115",name:"115",type:"cookie"},{key:"tianyi",name:"天翼",type:"account"},{key:"pan123",name:"123",type:"account"},{key:"bili",name:"Bilibili",type:"cookie"},{key:"wuming",name:"观影",type:"cookie"},{key:"yunchao",name:"云巢",type:"account"},{key:"pan123ziyuan",name:"123资源网",type:"cookie"}],Ye=ae(!1),lt=ae(!1),tt=ae(!1),nt=ae(""),St=ae(""),Kt=ae(""),Yt=ae(Ge[0]?Ge[0].key:""),Ht=ae(new Set),Lt=ae(""),Xt=ae(""),Tt=ae(""),Rt=De(()=>Ge.find(k=>k.key===Yt.value)||Ge[0]||null),Pt=De(()=>Rt.value&&Rt.value.type||"cookie"),fr=De(()=>Rt.value&&Rt.value.name||""),hr=()=>{Lt.value="",Xt.value="",Tt.value=""},Nt=async k=>{const h=Ge.find(b=>b.key===k);if(h&&!(Ht.value&&Ht.value.has(k))){lt.value=!0,nt.value="",St.value="",Kt.value="",hr();try{const b=await T(`website/${encodeURIComponent(k)}/${h.type==="account"?"account":"cookie"}`),F=b&&typeof b=="object"?b:{};h.type==="cookie"?Lt.value=typeof F.cookie=="string"?F.cookie:"":(Xt.value=typeof F.username=="string"?F.username:"",Tt.value=typeof F.password=="string"?F.password:"");const j=new Set(Array.from(Ht.value||[]));j.add(k),Ht.value=j}catch(b){nt.value=b&&b.message||"加载失败"}finally{lt.value=!1}}},Et=k=>{const h=typeof k=="string"?k:"";!h||h===Yt.value||(Yt.value=h,Nt(h))},tr=()=>{Ye.value=!Ye.value,Ye.value&&Nt(Yt.value)},nr=async()=>{if(tt.value)return;const k=Rt.value;if(k){tt.value=!0,St.value="",Kt.value="",nt.value="";try{k.type==="cookie"?await T(`website/${encodeURIComponent(k.key)}/cookie`,{method:"PUT",body:JSON.stringify({cookie:String(Lt.value||"")})}):await T(`website/${encodeURIComponent(k.key)}/account`,{method:"PUT",body:JSON.stringify({username:String(Xt.value||""),password:String(Tt.value||"")})}),St.value="保存成功"}catch(h){Kt.value=h&&h.message||"保存失败"}finally{tt.value=!1}}},zt=()=>{s.value=!0,$(),oe()},I=k=>{s.value&&k.key==="Escape"&&P()};return pr(()=>{window.addEventListener("tv:open-user-settings",zt),window.addEventListener("keydown",I)}),Sr(()=>{window.removeEventListener("tv:open-user-settings",zt),window.removeEventListener("keydown",I)}),(k,h)=>s.value?(U(),W("div",{key:0,class:"tv-us-backdrop",role:"dialog","aria-modal":"true",onClick:J},[l("div",{class:"tv-us-card",onClick:h[9]||(h[9]=it(()=>{},["stop"]))},[l("div",{class:"tv-us-header"},[h[11]||(h[11]=l("div",{class:"tv-us-title"},"用户设置",-1)),l("button",{class:"tv-us-close",type:"button","aria-label":"关闭",onClick:P},[...h[10]||(h[10]=[l("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M18 6 6 18M6 6l12 12"})],-1)])])]),l("div",Ts,[l("div",Ps,[l("div",Bs,[h[12]||(h[12]=l("div",{class:"tv-us-label"},"CatPawOpen 接口地址：",-1)),kt(l("input",{class:"tv-us-input",disabled:x.value||t.value,"onUpdate:modelValue":h[0]||(h[0]=b=>e.value=b),placeholder:"http://YOUR_Catpawopen:Port/",autocomplete:"off",spellcheck:"false"},null,8,Fs),[[ar,e.value]])]),l("div",Rs,[h[13]||(h[13]=l("div",{class:"tv-us-label"},"CatPawOpen 接口密钥：",-1)),kt(l("input",{class:"tv-us-input",disabled:x.value||t.value,"onUpdate:modelValue":h[1]||(h[1]=b=>r.value=b),placeholder:"可留空",autocomplete:"off",spellcheck:"false"},null,8,Ns),[[ar,r.value]])]),l("div",Os,[h[14]||(h[14]=l("div",{class:"tv-us-label"},"CatPawOpen 全局代理：",-1)),kt(l("input",{class:"tv-us-input",disabled:x.value||t.value,"onUpdate:modelValue":h[2]||(h[2]=b=>n.value=b),placeholder:Se.value,autocomplete:"off",spellcheck:"false"},null,8,qs),[[ar,n.value]])]),l("div",Ds,[h[15]||(h[15]=l("div",{class:"tv-us-label"},"搜索线程数：",-1)),kt(l("input",{class:"tv-us-input",disabled:x.value||t.value,"onUpdate:modelValue":h[3]||(h[3]=b=>c.value=b),type:"number",min:"1",max:"50",step:"1",inputmode:"numeric",placeholder:"默认 5"},null,8,Hs),[[ar,c.value]])])]),h[40]||(h[40]=l("div",{class:"tv-us-divider"},null,-1)),l("div",zs,[A.value?(U(),W("div",Vs,[l("button",{class:"tv-us-acc-head",type:"button",onClick:mt},[h[17]||(h[17]=l("span",null,"网盘设置",-1)),l("span",{class:"tv-us-acc-icon","data-open":ge.value},[...h[16]||(h[16]=[l("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,Us)]),kt(l("div",Ws,[Ie.value?(U(),W("div",Ks,"加载中...")):L.value?(U(),W("div",Xs,He(L.value),1)):(U(),W("div",Gs,[re.value.length?(U(),W("div",Zs,[h[21]||(h[21]=l("div",{class:"tv-us-pan-head"},[l("div",{class:"tv-us-pan-col name"},"网盘名称"),l("div",{class:"tv-us-pan-col enable"},"是否启用"),l("div",{class:"tv-us-pan-col order"},"排序")],-1)),(U(!0),W(ft,null,_t(re.value,(b,F)=>(U(),W("div",{class:"tv-us-pan-row",key:b.key},[l("div",Js,[l("span",Qs,He(b.name||b.key),1)]),l("div",en,[l("button",{class:"tv-us-switch",type:"button","data-on":b.enable?"true":"false",disabled:Je.value,onClick:j=>Ne(F)},[...h[18]||(h[18]=[l("span",{class:"tv-us-switch-dot"},null,-1)])],8,tn)]),l("div",rn,[l("div",an,[l("button",{class:"tv-us-order-btn",type:"button",disabled:Je.value||F===0,onClick:j=>we(F,-1)},[...h[19]||(h[19]=[l("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 15l6-6 6 6"})],-1)])],8,sn),l("button",{class:"tv-us-order-btn",type:"button",disabled:Je.value||F===re.value.length-1,onClick:j=>we(F,1)},[...h[20]||(h[20]=[l("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,nn)])])]))),128))])):(U(),W("div",Ys,"暂无数据")),Je.value?(U(),W("div",on,"同步中...")):B.value?(U(),W("div",ln,He(B.value),1)):le.value?(U(),W("div",cn,He(le.value),1)):wt("",!0)]))],512),[[Wt,ge.value]])])):wt("",!0),A.value?(U(),W("div",un,[l("button",{class:"tv-us-acc-head",type:"button",onClick:tr},[h[23]||(h[23]=l("span",null,"网盘 Cookie 设置",-1)),l("span",{class:"tv-us-acc-icon","data-open":Ye.value},[...h[22]||(h[22]=[l("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,dn)]),kt(l("div",pn,[l("div",fn,[l("div",hn,[(U(),W(ft,null,_t(Ge,b=>l("button",{key:b.key,class:"tv-us-pan-tab",type:"button","data-active":Yt.value===b.key?"true":"false",onClick:F=>Et(b.key)},He(b.name),9,vn)),64))]),lt.value?(U(),W("div",mn,"加载中...")):nt.value?(U(),W("div",gn,He(nt.value),1)):(U(),W("div",yn,[Pt.value==="cookie"?kt((U(),W("textarea",{key:0,class:"tv-us-textarea",disabled:tt.value,"onUpdate:modelValue":h[4]||(h[4]=b=>Lt.value=b),placeholder:`请输入${fr.value} Cookie`,rows:"3",spellcheck:"false"},null,8,bn)),[[ar,Lt.value]]):(U(),W("div",wn,[l("div",xn,[h[24]||(h[24]=l("div",{class:"tv-us-label"},"账号：",-1)),kt(l("input",{class:"tv-us-input",disabled:tt.value,"onUpdate:modelValue":h[5]||(h[5]=b=>Xt.value=b),autocomplete:"off"},null,8,kn),[[ar,Xt.value]])]),l("div",Sn,[h[25]||(h[25]=l("div",{class:"tv-us-label"},"密码：",-1)),kt(l("input",{class:"tv-us-input",disabled:tt.value,"onUpdate:modelValue":h[6]||(h[6]=b=>Tt.value=b),type:"password",autocomplete:"new-password"},null,8,_n),[[ar,Tt.value]])])])),l("div",En,[St.value?(U(),W("div",Cn,He(St.value),1)):Kt.value?(U(),W("div",$n,He(Kt.value),1)):wt("",!0),l("button",{class:"tv-us-save mini",type:"button",disabled:tt.value,onClick:nr},He(tt.value?"保存中...":"保存"),9,jn)])]))])],512),[[Wt,Ye.value]])])):wt("",!0),_e.value?(U(),W("div",Ln,[l("button",{class:"tv-us-acc-head",type:"button",onClick:te},[h[27]||(h[27]=l("span",null,"站点列表",-1)),l("span",{class:"tv-us-acc-icon","data-open":Pe.value},[...h[26]||(h[26]=[l("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,An)]),kt(l("div",Mn,[se.value?(U(),W("div",In,"加载中...")):Me.value?(U(),W("div",Tn,He(Me.value),1)):(U(),W("div",Pn,[K.value.length?(U(),W("div",Fn,[ce.value>0?(U(),W("div",Rn,[l("div",Nn,"已选择 "+He(ce.value)+" 个",1),l("div",On,[l("button",{class:"tv-us-batch-btn",type:"button",disabled:de.value,onClick:Le}," 批量检测 ",8,qn),l("button",{class:"tv-us-batch-btn ok",type:"button",disabled:de.value,onClick:h[7]||(h[7]=b=>fe(!0))}," 批量启用 ",8,Dn),l("button",{class:"tv-us-batch-btn danger",type:"button",disabled:de.value,onClick:h[8]||(h[8]=b=>fe(!1))}," 批量禁用 ",8,Hn)])])):wt("",!0),l("div",zn,[l("div",Vn,[l("input",{class:"tv-us-checkbox",type:"checkbox",checked:G.value,onChange:D},null,40,Un)]),h[28]||(h[28]=vt('<div class="tv-us-pan-col name" data-v-5d93d16f>站点名称</div><div class="tv-us-pan-col availability" data-v-5d93d16f>站点可用性</div><div class="tv-us-pan-col enable" data-v-5d93d16f>是否启用</div><div class="tv-us-pan-col enable" data-v-5d93d16f>首页显示</div><div class="tv-us-pan-col order" data-v-5d93d16f>排序</div>',5))]),(U(!0),W(ft,null,_t(K.value,(b,F)=>(U(),W("div",{class:"tv-us-pan-row",key:b.key},[l("div",Wn,[l("input",{class:"tv-us-checkbox",type:"checkbox",checked:O(b.key),onChange:j=>Z(b.key)},null,40,Kn)]),l("div",Xn,[l("span",Gn,He(b.name||b.key),1)]),l("div",Yn,[l("span",{class:"tv-us-availability","data-status":b.availability||"unchecked"},[h[29]||(h[29]=l("span",{class:"tv-us-availability-dot"},null,-1)),l("span",Jn,He((b.availability||"unchecked")==="valid"?"有效":(b.availability||"unchecked")==="invalid"?"无效":(b.availability||"unchecked")==="unknown"?"未知":"未检测"),1)],8,Zn)]),l("div",Qn,[l("button",{class:"tv-us-switch",type:"button","data-on":b.enabled?"true":"false",disabled:de.value,onClick:j=>$e(F)},[...h[30]||(h[30]=[l("span",{class:"tv-us-switch-dot"},null,-1)])],8,eo)]),l("div",to,[l("button",{class:"tv-us-switch",type:"button","data-on":b.home?"true":"false",disabled:de.value,onClick:j=>he(F)},[...h[31]||(h[31]=[l("span",{class:"tv-us-switch-dot"},null,-1)])],8,ro)]),l("div",ao,[l("div",so,[l("button",{class:"tv-us-order-btn",type:"button",disabled:de.value||F===0,onClick:j=>ne(F,-1)},[...h[32]||(h[32]=[l("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 15l6-6 6 6"})],-1)])],8,no),l("button",{class:"tv-us-order-btn",type:"button",disabled:de.value||F===K.value.length-1,onClick:j=>ne(F,1)},[...h[33]||(h[33]=[l("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,oo)])])]))),128))])):(U(),W("div",Bn,"暂无数据"))]))],512),[[Wt,Pe.value]])])):wt("",!0),H.value?(U(),W("div",io,[l("button",{class:"tv-us-acc-head",type:"button",onClick:ot},[h[35]||(h[35]=l("span",null,"站点搜索结果设置",-1)),l("span",{class:"tv-us-acc-icon","data-open":Te.value},[...h[34]||(h[34]=[l("svg",{viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,lo)]),kt(l("div",co,[Xe.value?(U(),W("div",uo,"加载中...")):Qe.value?(U(),W("div",po,He(Qe.value),1)):(U(),W("div",fo,[xt.value.length?(U(),W("div",vo,[h[39]||(h[39]=l("div",{class:"tv-us-pan-head"},[l("div",{class:"tv-us-pan-col name"},"站点名称"),l("div",{class:"tv-us-pan-col enable"},"聚合图片显示"),l("div",{class:"tv-us-pan-col order"},"排序")],-1)),(U(!0),W(ft,null,_t(xt.value,(b,F)=>(U(),W("div",{class:"tv-us-pan-row",key:b.key},[l("div",mo,[l("span",go,He(b.name||b.key),1)]),l("div",yo,[l("button",{class:"tv-us-switch",type:"button","data-on":g.value===b.key?"true":"false",disabled:t.value,onClick:j=>ht(b.key)},[...h[36]||(h[36]=[l("span",{class:"tv-us-switch-dot"},null,-1)])],8,bo)]),l("div",wo,[l("div",xo,[l("button",{class:"tv-us-order-btn",type:"button",disabled:t.value||F===0,onClick:j=>Ae(F,-1)},[...h[37]||(h[37]=[l("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 15l6-6 6 6"})],-1)])],8,ko),l("button",{class:"tv-us-order-btn",type:"button",disabled:t.value||F===xt.value.length-1,onClick:j=>Ae(F,1)},[...h[38]||(h[38]=[l("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 9l6 6 6-6"})],-1)])],8,So)])])]))),128))])):(U(),W("div",ho,"暂无数据"))]))],512),[[Wt,Te.value]])])):wt("",!0)]),l("div",_o,[w.value?(U(),W("div",{key:0,class:"tv-us-msg","data-kind":_.value},He(w.value),9,Eo)):wt("",!0),l("button",{class:"tv-us-save",type:"button",disabled:x.value||t.value,onClick:je},He(t.value?"保存中...":"保存"),9,Co)])])])])):wt("",!0)}},jo=Rr($o,[["__scopeId","data-v-5d93d16f"]]);function Lo(){const a=document.getElementById("mobileBackBtn");a&&a.addEventListener("click",()=>window.history.back());const p=document.getElementById("episodePanelToggle"),s=document.getElementById("episodePanelToggleLabel"),x=document.getElementById("episodePanelToggleIcon"),t=document.getElementById("episodePanelToggleDot"),e=document.getElementById("playGrid"),u=document.getElementById("playerArea"),r=document.getElementById("episodePanel");if(p&&s&&x&&t&&e&&u&&r){let n=!1;const o=()=>{r.classList.toggle("lg:hidden",n),e.classList.toggle("md:grid-cols-4",!n),u.classList.toggle("md:col-span-3",!n),e.classList.toggle("episode-panel-collapsed",n),s.textContent=n?"显示":"隐藏",x.classList.toggle("rotate-180",n),t.classList.toggle("bg-orange-400",n),t.classList.toggle("animate-pulse",n),t.classList.toggle("bg-green-400",!n),p.title=n?"显示选集面板":"隐藏选集面板"};p.addEventListener("click",()=>{n=!n,o()}),o()}}const Ao="modulepreload",Mo=function(a){return"/"+a},ba={},Vr=function(p,s,x){let t=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),r=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));t=Promise.allSettled(s.map(n=>{if(n=Mo(n),n in ba)return;ba[n]=!0;const o=n.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${i}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Ao,o||(c.as="script"),c.crossOrigin="",c.href=n,r&&c.setAttribute("nonce",r),document.head.appendChild(c),o)return new Promise((f,g)=>{c.addEventListener("load",f),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${n}`)))})}))}function e(u){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=u,window.dispatchEvent(r),!r.defaultPrevented)throw u}return t.then(u=>{for(const r of u||[])r.status==="rejected"&&e(r.reason);return p().catch(e)})};/*!
 * artplayer.js v5.3.0
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2025 Harvey Zack
 * Released under the MIT License.
 */(function(a,p,s,x,t,e,u,r){var n=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{},o=typeof n[x]=="function"&&n[x],i=o.i||{},c=o.cache||{},f=typeof module<"u"&&typeof module.require=="function"&&module.require.bind(module);function g(A,H){if(!c[A]){if(!a[A]){if(t[A])return t[A];var w=typeof n[x]=="function"&&n[x];if(!H&&w)return w(A,!0);if(o)return o(A,!0);if(f&&typeof A=="string")return f(A);var _=Error("Cannot find module '"+A+"'");throw _.code="MODULE_NOT_FOUND",_}$.resolve=function(S){var P=a[A][1][S];return P??S},$.cache={};var M=c[A]=new g.Module(A);a[A][0].call(M.exports,$,M,M.exports,n)}return c[A].exports;function $(S){var P=$.resolve(S);return P===!1?{}:g(P)}}g.isParcelRequire=!0,g.Module=function(A){this.id=A,this.bundle=g,this.require=f,this.exports={}},g.modules=a,g.cache=c,g.parent=o,g.distDir=void 0,g.publicUrl=void 0,g.devServer=void 0,g.i=i,g.register=function(A,H){a[A]=[function(w,_){_.exports=H},{}]},Object.defineProperty(g,"root",{get:function(){return n[x]}}),n[x]=g;for(var y=0;y<p.length;y++)g(p[y]);{var C=g(s);typeof exports=="object"&&typeof module<"u"?module.exports=C:typeof define=="function"&&define.amd&&define(function(){return C})}})({esqvp:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("bundle-text:./style/index.less"),u=t.interopDefault(e),r=a("option-validator"),n=t.interopDefault(r),o=a("../package.json"),i=a("./config"),c=t.interopDefault(i),f=a("./contextmenu"),g=t.interopDefault(f),y=a("./control"),C=t.interopDefault(y),A=a("./events"),H=t.interopDefault(A),w=a("./hotkey"),_=t.interopDefault(w),M=a("./i18n"),$=t.interopDefault(M),S=a("./icons"),P=t.interopDefault(S),J=a("./info"),oe=t.interopDefault(J),me=a("./layer"),Se=t.interopDefault(me),je=a("./loading"),T=t.interopDefault(je),V=a("./mask"),Y=t.interopDefault(V),_e=a("./notice"),Pe=t.interopDefault(_e),se=a("./player"),de=t.interopDefault(se),Me=a("./plugins"),K=t.interopDefault(Me),ke=a("./scheme"),ce=t.interopDefault(ke),G=a("./setting"),q=t.interopDefault(G),Z=a("./storage"),O=t.interopDefault(Z),D=a("./subtitle"),ve=t.interopDefault(D),te=a("./template"),ue=t.interopDefault(te),pe=a("./utils"),be=a("./utils/emitter"),Le=t.interopDefault(be);let fe=0,Re=[];class ne extends Le.default{constructor(he,Te){if(super(),!pe.isBrowser)throw Error("Artplayer can only be used in the browser environment");this.id=++fe;let Xe=pe.mergeDeep(ne.option,he);if(Xe.container=he.container,this.option=(0,n.default)(Xe,ce.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isRotate=!1,this.isDestroy=!1,this.template=new ue.default(this),this.events=new H.default(this),this.storage=new O.default(this),this.icons=new P.default(this),this.i18n=new $.default(this),this.notice=new Pe.default(this),this.player=new de.default(this),this.layers=new Se.default(this),this.controls=new C.default(this),this.contextmenu=new g.default(this),this.subtitle=new ve.default(this),this.info=new oe.default(this),this.loading=new T.default(this),this.hotkey=new _.default(this),this.mask=new Y.default(this),this.setting=new q.default(this),this.plugins=new K.default(this),typeof Te=="function"&&this.on("ready",()=>Te.call(this,this)),ne.DEBUG){let Qe=st=>console.log(`[ART.${this.id}] -> ${st}`);Qe(`Version@${ne.version}`);for(let st=0;st<c.default.events.length;st++)this.on(`video:${c.default.events[st]}`,xt=>Qe(`Event@${xt.type}`))}Re.push(this)}static get instances(){return Re}static get version(){return o.version}static get config(){return c.default}static get utils(){return pe}static get scheme(){return ce.default}static get Emitter(){return Le.default}static get validator(){return n.default}static get kindOf(){return n.default.kindOf}static get html(){return ue.default.html}static get option(){return{id:"",container:"#artplayer",url:"",poster:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,gesture:!0,fastForward:!1,autoPlayback:!1,autoOrientation:!1,airplay:!1,proxy:void 0,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],thumbnails:{url:"",number:60,column:10,width:0,height:0,scale:1},subtitle:{url:"",type:"",style:{},name:"",escape:!0,encoding:"utf-8",onVttLoad:he=>he},moreVideoAttr:{controls:!1,preload:pe.isSafari?"auto":"metadata"},i18n:{},icons:{},cssVar:{},customType:{},lang:navigator==null?void 0:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}get video(){return this.template.$video}destroy(he=!0){ne.REMOVE_SRC_WHEN_DESTROY&&this.video.removeAttribute("src"),this.events.destroy(),this.template.destroy(he),Re.splice(Re.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}s.default=ne,ne.STYLE=u.default,ne.DEBUG=!1,ne.CONTEXTMENU=!0,ne.NOTICE_TIME=2e3,ne.SETTING_WIDTH=250,ne.SETTING_ITEM_WIDTH=200,ne.SETTING_ITEM_HEIGHT=35,ne.RESIZE_TIME=200,ne.SCROLL_TIME=200,ne.SCROLL_GAP=50,ne.AUTO_PLAYBACK_MAX=10,ne.AUTO_PLAYBACK_MIN=5,ne.AUTO_PLAYBACK_TIMEOUT=3e3,ne.RECONNECT_TIME_MAX=5,ne.RECONNECT_SLEEP_TIME=1e3,ne.CONTROL_HIDE_TIME=3e3,ne.DBCLICK_TIME=300,ne.DBCLICK_FULLSCREEN=!0,ne.MOBILE_DBCLICK_PLAY=!0,ne.MOBILE_CLICK_PLAY=!1,ne.AUTO_ORIENTATION_TIME=200,ne.INFO_LOOP_TIME=1e3,ne.FAST_FORWARD_VALUE=3,ne.FAST_FORWARD_TIME=1e3,ne.TOUCH_MOVE_RATIO=.5,ne.VOLUME_STEP=.1,ne.SEEK_STEP=5,ne.PLAYBACK_RATE=[.5,.75,1,1.25,1.5,2],ne.ASPECT_RATIO=["default","4:3","16:9"],ne.FLIP=["normal","horizontal","vertical"],ne.FULLSCREEN_WEB_IN_BODY=!1,ne.LOG_VERSION=!0,ne.USE_RAF=!1,ne.REMOVE_SRC_WHEN_DESTROY=!0,pe.isBrowser&&(window.Artplayer=ne,pe.setStyleText("artplayer-style",u.default),setTimeout(()=>{ne.LOG_VERSION&&console.log(`%c ArtPlayer %c ${ne.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},100))},{"bundle-text:./style/index.less":"2wh8D","option-validator":"g7VGh","../package.json":"lh3R5","./config":"eJfh8","./contextmenu":"9zso8","./control":"dp1yk","./events":"jmVSD","./hotkey":"dswts","./i18n":"d9ktO","./icons":"fFHY0","./info":"kZ0F8","./layer":"j9lbi","./loading":"bMjWd","./mask":"k1nkQ","./notice":"fPVaU","./player":"uR0Sw","./plugins":"cjxJL","./scheme":"biLjm","./setting":"bwLGT","./storage":"kwqbK","./subtitle":"k5613","./template":"fwOA1","./utils":"aBlEo","./utils/emitter":"4NM7P","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2wh8D":[function(a,p,s,x){p.exports='.art-video-player{--art-theme:red;--art-font-color:#fff;--art-background-color:#000;--art-text-shadow-color:#00000080;--art-transition-duration:.2s;--art-padding:10px;--art-border-radius:3px;--art-progress-height:6px;--art-progress-color:#ffffff40;--art-hover-color:#ffffff40;--art-loaded-color:#ffffff40;--art-state-size:80px;--art-state-opacity:.8;--art-bottom-height:100px;--art-bottom-offset:20px;--art-bottom-gap:5px;--art-highlight-width:8px;--art-highlight-color:#ffffff80;--art-control-height:46px;--art-control-opacity:.75;--art-control-icon-size:36px;--art-control-icon-scale:1.1;--art-volume-height:120px;--art-volume-handle-size:14px;--art-lock-size:36px;--art-indicator-scale:0;--art-indicator-size:16px;--art-fullscreen-web-index:9999;--art-settings-icon-size:24px;--art-settings-max-height:300px;--art-selector-max-height:300px;--art-contextmenus-min-width:250px;--art-subtitle-font-size:20px;--art-subtitle-gap:5px;--art-subtitle-bottom:15px;--art-subtitle-border:#000;--art-widget-background:#000000d9;--art-tip-background:#000000b3;--art-scrollbar-size:4px;--art-scrollbar-background:#ffffff40;--art-scrollbar-background-hover:#ffffff80;--art-mini-progress-height:2px}.art-bg-cover{background-position:50%;background-repeat:no-repeat;background-size:cover}.art-bottom-gradient{background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x}.art-backdrop-filter{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-truncate{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.art-video-player{zoom:1;text-align:left;user-select:none;box-sizing:border-box;width:100%;height:100%;color:var(--art-font-color);background-color:var(--art-background-color);text-shadow:0 0 2px var(--art-text-shadow-color);-webkit-tap-highlight-color:#0000;-ms-touch-action:manipulation;touch-action:manipulation;-ms-high-contrast-adjust:none;direction:ltr;outline:0;margin:0 auto;padding:0;font-family:PingFang SC,Helvetica Neue,Microsoft YaHei,Roboto,Arial,sans-serif;font-size:14px;line-height:1.3;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box}.art-video-player ::-webkit-scrollbar{width:var(--art-scrollbar-size);height:var(--art-scrollbar-size)}.art-video-player ::-webkit-scrollbar-thumb{background-color:var(--art-scrollbar-background)}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:var(--art-scrollbar-background-hover)}.art-video-player img{vertical-align:top;max-width:100%}.art-video-player svg{fill:var(--art-font-color)}.art-video-player a{color:var(--art-font-color);text-decoration:none}.art-icon{justify-content:center;align-items:center;line-height:1;display:flex}.art-video-player.art-backdrop .art-contextmenus,.art-video-player.art-backdrop .art-info,.art-video-player.art-backdrop .art-settings,.art-video-player.art-backdrop .art-layer-auto-playback,.art-video-player.art-backdrop .art-selector-list,.art-video-player.art-backdrop .art-volume-inner{backdrop-filter:saturate(180%)blur(20px);background-color:#000000bf!important}.art-video{z-index:10;cursor:pointer;width:100%;height:100%;position:absolute;inset:0}.art-poster{z-index:11;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;width:100%;height:100%;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;text-align:center;pointer-events:none;justify-content:center;align-items:center;gap:var(--art-subtitle-gap);width:100%;bottom:var(--art-subtitle-bottom);font-size:var(--art-subtitle-font-size);transition:bottom var(--art-transition-duration)ease;text-shadow:var(--art-subtitle-border)1px 0 1px,var(--art-subtitle-border)0 1px 1px,var(--art-subtitle-border)-1px 0 1px,var(--art-subtitle-border)0 -1px 1px,var(--art-subtitle-border)1px 1px 1px,var(--art-subtitle-border)-1px -1px 1px,var(--art-subtitle-border)1px -1px 1px,var(--art-subtitle-border)-1px 1px 1px;flex-direction:column;padding:0 5%;display:none;position:absolute}.art-video-player.art-subtitle-show .art-subtitle{display:flex}.art-video-player.art-control-show .art-subtitle{bottom:calc(var(--art-control-height) + var(--art-subtitle-bottom))}.art-danmuku{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;pointer-events:none;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:flex}.art-video-player .art-mask{z-index:50;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:flex;position:absolute;inset:0}.art-video-player .art-mask .art-state{opacity:0;width:var(--art-state-size);height:var(--art-state-size);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;display:flex;transform:scale(2)}.art-video-player.art-mask-show .art-state{cursor:pointer;pointer-events:auto;opacity:var(--art-state-opacity);transform:scale(1)}.art-video-player.art-loading-show .art-state{display:none}.art-video-player .art-loading{z-index:70;pointer-events:none;justify-content:center;align-items:center;width:100%;height:100%;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;opacity:0;pointer-events:none;width:100%;height:100%;padding:0 var(--art-padding);transition:all var(--art-transition-duration)ease;background-size:100% var(--art-bottom-height);background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:flex-end;display:flex;position:absolute;inset:0;overflow:hidden}.art-video-player .art-bottom .art-controls,.art-video-player .art-bottom .art-progress{transform:translateY(var(--art-bottom-offset));transition:transform var(--art-transition-duration)ease}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1}.art-video-player.art-control-show .art-bottom .art-controls,.art-video-player.art-hover .art-bottom .art-controls,.art-video-player.art-control-show .art-bottom .art-progress,.art-video-player.art-hover .art-bottom .art-progress{transform:translateY(0)}.art-bottom .art-progress{z-index:0;pointer-events:auto;padding-bottom:var(--art-bottom-gap);position:relative}.art-bottom .art-progress .art-control-progress{cursor:pointer;height:var(--art-progress-height);justify-content:center;align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner{width:100%;height:50%;transition:height var(--art-transition-duration)ease;background-color:var(--art-progress-color);align-items:center;display:flex;position:relative}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-hover{z-index:0;background-color:var(--art-hover-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;background-color:var(--art-loaded-color);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;background-color:var(--art-theme);width:0%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;pointer-events:none;width:100%;height:100%;position:absolute;inset:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{z-index:0;pointer-events:auto;width:100%;height:100%;transform:translateX(calc(var(--art-highlight-width)/-2));background-color:var(--art-highlight-color);position:absolute;inset:0 auto 0 0;width:var(--art-highlight-width)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{z-index:40;width:var(--art-indicator-size);height:var(--art-indicator-size);transform:scale(var(--art-indicator-scale));margin-left:calc(var(--art-indicator-size)/-2);transition:transform var(--art-transition-duration)ease;border-radius:50%;justify-content:center;align-items:center;display:flex;position:absolute;left:0}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{pointer-events:none;width:100%;height:100%}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:hover{transform:scale(1.2)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator:active{transform:scale(1)!important}.art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;border-radius:var(--art-border-radius);white-space:nowrap;background-color:var(--art-tip-background);padding:3px 5px;font-size:12px;line-height:1;display:none;position:absolute;top:-25px;left:0}.art-bottom .art-progress .art-control-progress:hover .art-control-progress-inner{height:100%}.art-bottom .art-progress .art-control-thumbnails{bottom:calc(var(--art-bottom-gap) + 10px);border-radius:var(--art-border-radius);pointer-events:none;background-color:var(--art-widget-background);display:none;position:absolute;left:0;box-shadow:0 1px 3px #0003,0 1px 2px -1px #0003}.art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{transform:scale(1)}.art-controls{z-index:10;pointer-events:auto;height:var(--art-control-height);justify-content:space-between;align-items:center;display:flex;position:relative}.art-controls .art-controls-left,.art-controls .art-controls-right{height:100%;display:flex}.art-controls .art-controls-center{flex:1;justify-content:center;align-items:center;height:100%;padding:0 10px;display:none}.art-controls .art-controls-right{justify-content:flex-end}.art-controls .art-control{cursor:pointer;white-space:nowrap;opacity:var(--art-control-opacity);min-height:var(--art-control-height);min-width:var(--art-control-height);transition:opacity var(--art-transition-duration)ease;flex-shrink:0;justify-content:center;align-items:center;display:flex}.art-controls .art-control .art-icon{height:var(--art-control-icon-size);width:var(--art-control-icon-size);transform:scale(var(--art-control-icon-scale));transition:transform var(--art-transition-duration)ease}.art-controls .art-control .art-icon:active{transform:scale(calc(var(--art-control-icon-scale)*.8))}.art-controls .art-control:hover{opacity:1}.art-control-volume{position:relative}.art-control-volume .art-volume-panel{text-align:center;cursor:default;opacity:0;pointer-events:none;left:0;right:0;bottom:var(--art-control-height);width:var(--art-control-height);height:var(--art-volume-height);transition:all var(--art-transition-duration)ease;justify-content:center;align-items:center;padding:0 5px;font-size:12px;display:flex;position:absolute;transform:translateY(10px)}.art-control-volume .art-volume-panel .art-volume-inner{border-radius:var(--art-border-radius);background-color:var(--art-widget-background);flex-direction:column;align-items:center;gap:10px;width:100%;height:100%;padding:10px 0 12px;display:flex}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider{cursor:pointer;flex:1;justify-content:center;width:100%;display:flex;position:relative}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle{border-radius:var(--art-border-radius);background-color:#ffffff40;justify-content:center;width:2px;display:flex;position:relative;overflow:hidden}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-handle .art-volume-loaded{z-index:0;background-color:var(--art-theme);width:100%;height:100%;position:absolute;inset:0}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider .art-volume-indicator{width:var(--art-volume-handle-size);height:var(--art-volume-handle-size);margin-top:calc(var(--art-volume-handle-size)/-2);background-color:var(--art-theme);transition:transform var(--art-transition-duration)ease;border-radius:100%;flex-shrink:0;position:absolute;transform:scale(1)}.art-control-volume .art-volume-panel .art-volume-inner .art-volume-slider:active .art-volume-indicator{transform:scale(.9)}.art-control-volume:hover .art-volume-panel{opacity:1;pointer-events:auto;transform:translateY(0)}.art-video-player .art-notice{z-index:80;width:100%;height:auto;padding:var(--art-padding);pointer-events:none;display:none;position:absolute;inset:0 0 auto}.art-video-player .art-notice .art-notice-inner{border-radius:var(--art-border-radius);background-color:var(--art-tip-background);padding:5px;line-height:1;display:inline-flex}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);min-width:var(--art-contextmenus-min-width);flex-direction:column;padding:5px 0;font-size:12px;display:none;position:absolute}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;border-bottom:1px solid #ffffff1a;padding:10px 15px;display:flex}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 8px}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:var(--art-theme)}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;border-radius:var(--art-border-radius);max-height:var(--art-settings-max-height);left:auto;right:var(--art-padding);bottom:var(--art-control-height);transition:all var(--art-transition-duration)ease;background-color:var(--art-widget-background);flex-direction:column;display:none;position:absolute;overflow:hidden auto}.art-video-player .art-settings .art-setting-panel{flex-direction:column;display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item{cursor:pointer;transition:background-color var(--art-transition-duration)ease;justify-content:space-between;align-items:center;padding:0 5px;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover{background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:var(--art-theme)}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{flex-shrink:0;justify-content:center;align-items:center;gap:5px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:var(--art-settings-icon-size);width:var(--art-settings-icon-size);justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{justify-content:center;align-items:center;gap:5px;font-size:12px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{justify-content:center;align-items:center;min-width:32px;height:24px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{appearance:none;background-color:#fff3;outline:none;width:80px;height:3px}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:flex}.art-video-player .art-info{left:var(--art-padding);top:var(--art-padding);z-index:100;border-radius:var(--art-border-radius);background-color:var(--art-widget-background);padding:10px;font-size:12px;display:none;position:absolute}.art-video-player .art-info .art-info-panel{flex-direction:column;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item{align-items:center;gap:5px;display:flex}.art-video-player .art-info .art-info-panel .art-info-item .art-info-title{text-align:right;width:100px}.art-video-player .art-info .art-info-panel .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;user-select:all;width:250px;overflow:hidden}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio]{overflow:hidden}.art-video-player[data-aspect-ratio] .art-video{object-fit:fill;box-sizing:content-box}.art-fullscreen{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3}.art-fullscreen-web{--art-progress-height:8px;--art-indicator-size:20px;--art-control-height:60px;--art-control-icon-scale:1.3;z-index:var(--art-fullscreen-web-index);width:100%;height:100%;position:fixed;inset:0}.art-mini-popup{z-index:9999;border-radius:var(--art-border-radius);cursor:move;user-select:none;background:#000;width:320px;height:180px;transition:opacity .2s;position:fixed;overflow:hidden;box-shadow:0 0 5px #00000080}.art-mini-popup svg{fill:#fff}.art-mini-popup .art-video{pointer-events:none}.art-mini-popup .art-mini-close{z-index:20;cursor:pointer;opacity:0;transition:opacity .2s;position:absolute;top:10px;right:10px}.art-mini-popup .art-mini-state{z-index:30;pointer-events:none;opacity:0;background-color:#00000040;justify-content:center;align-items:center;width:100%;height:100%;transition:opacity .2s;display:flex;position:absolute;inset:0}.art-mini-popup .art-mini-state .art-icon{opacity:.75;cursor:pointer;pointer-events:auto;transition:transform .2s;transform:scale(3)}.art-mini-popup .art-mini-state .art-icon:active{transform:scale(2.5)}.art-mini-popup.art-mini-dragging{opacity:.9}.art-mini-popup:hover .art-mini-close,.art-mini-popup:hover .art-mini-state{opacity:1}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-lock{height:var(--art-lock-size);width:var(--art-lock-size);top:50%;left:var(--art-padding);background-color:var(--art-tip-background);border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;transform:translateY(-50%)}.art-video-player .art-layer-auto-playback{border-radius:var(--art-border-radius);left:var(--art-padding);bottom:calc(var(--art-control-height) + var(--art-bottom-gap) + 10px);background-color:var(--art-widget-background);align-items:center;gap:10px;padding:10px;line-height:1;display:none;position:absolute}.art-video-player .art-layer-auto-playback .art-auto-playback-close{cursor:pointer;justify-content:center;align-items:center;display:flex}.art-video-player .art-layer-auto-playback .art-auto-playback-close svg{width:15px;height:15px;fill:var(--art-theme)}.art-video-player .art-layer-auto-playback .art-auto-playback-jump{color:var(--art-theme);cursor:pointer}.art-video-player.art-lock .art-subtitle{bottom:var(--art-subtitle-bottom)!important}.art-video-player.art-mini-progress-bar .art-bottom,.art-video-player.art-lock .art-bottom{opacity:1;background-image:none;padding:0}.art-video-player.art-mini-progress-bar .art-bottom .art-controls,.art-video-player.art-lock .art-bottom .art-controls,.art-video-player.art-mini-progress-bar .art-bottom .art-progress,.art-video-player.art-lock .art-bottom .art-progress{transform:translateY(calc(var(--art-control-height) + var(--art-bottom-gap) + var(--art-progress-height)/4))}.art-video-player.art-mini-progress-bar .art-bottom .art-progress-indicator,.art-video-player.art-lock .art-bottom .art-progress-indicator{display:none!important}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-control-selector{justify-content:center;display:flex;position:relative}.art-control-selector .art-selector-list{text-align:center;border-radius:var(--art-border-radius);opacity:0;pointer-events:none;bottom:var(--art-control-height);max-height:var(--art-selector-max-height);background-color:var(--art-widget-background);transition:all var(--art-transition-duration)ease;flex-direction:column;align-items:center;display:flex;position:absolute;overflow:hidden auto;transform:translateY(10px)}.art-control-selector .art-selector-list .art-selector-item{flex-shrink:0;justify-content:center;align-items:center;width:100%;padding:10px 15px;line-height:1;display:flex}.art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-control-selector .art-selector-list .art-selector-item:hover,.art-control-selector .art-selector-list .art-selector-item.art-current{color:var(--art-theme)}.art-control-selector:hover .art-selector-list{opacity:1;pointer-events:auto;transform:translateY(0)}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}.art-video-player.art-mobile{--art-bottom-gap:10px;--art-control-height:38px;--art-control-icon-scale:1;--art-state-size:60px;--art-settings-max-height:180px;--art-selector-max-height:180px;--art-indicator-scale:1;--art-control-opacity:1}.art-video-player.art-mobile .art-controls-left{margin-left:calc(var(--art-padding)/-1)}.art-video-player.art-mobile .art-controls-right{margin-right:calc(var(--art-padding)/-1)}'},{}],g7VGh:[function(a,p,s,x){p.exports=function(){function t(c){return(t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(c)}var e=Object.prototype.toString,u=function(c){if(c===void 0)return"undefined";if(c===null)return"null";var f=t(c);if(f==="boolean")return"boolean";if(f==="string")return"string";if(f==="number")return"number";if(f==="symbol")return"symbol";if(f==="function")return r(c)==="GeneratorFunction"?"generatorfunction":"function";if(Array.isArray?Array.isArray(c):c instanceof Array)return"array";if(c.constructor&&typeof c.constructor.isBuffer=="function"&&c.constructor.isBuffer(c))return"buffer";if(function(g){try{if(typeof g.length=="number"&&typeof g.callee=="function")return!0}catch(y){if(y.message.indexOf("callee")!==-1)return!0}return!1}(c))return"arguments";if(c instanceof Date||typeof c.toDateString=="function"&&typeof c.getDate=="function"&&typeof c.setDate=="function")return"date";if(c instanceof Error||typeof c.message=="string"&&c.constructor&&typeof c.constructor.stackTraceLimit=="number")return"error";if(c instanceof RegExp||typeof c.flags=="string"&&typeof c.ignoreCase=="boolean"&&typeof c.multiline=="boolean"&&typeof c.global=="boolean")return"regexp";switch(r(c)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(typeof c.throw=="function"&&typeof c.return=="function"&&typeof c.next=="function")return"generator";switch(f=e.call(c)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return f.slice(8,-1).toLowerCase().replace(/\s/g,"")};function r(c){return c.constructor?c.constructor.name:null}function n(c,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return o(c,f,g),i(c,f,g),function(y,C,A){var H=u(C),w=u(y);if(H==="object"){if(w!=="object")throw Error("[Type Error]: '".concat(A.join("."),"' require 'object' type, but got '").concat(w,"'"));Object.keys(C).forEach(function(_){var M=y[_],$=C[_],S=A.slice();S.push(_),o(M,$,S),i(M,$,S),n(M,$,S)})}if(H==="array"){if(w!=="array")throw Error("[Type Error]: '".concat(A.join("."),"' require 'array' type, but got '").concat(w,"'"));y.forEach(function(_,M){var $=y[M],S=C[M]||C[0],P=A.slice();P.push(M),o($,S,P),i($,S,P),n($,S,P)})}}(c,f,g),c}function o(c,f,g){if(u(f)==="string"){var y=u(c);if(f[0]==="?"&&(f=f.slice(1)+"|undefined"),!(-1<f.indexOf("|")?f.split("|").map(function(C){return C.toLowerCase().trim()}).filter(Boolean).some(function(C){return y===C}):f.toLowerCase().trim()===y))throw Error("[Type Error]: '".concat(g.join("."),"' require '").concat(f,"' type, but got '").concat(y,"'"))}}function i(c,f,g){if(u(f)==="function"){var y=f(c,u(c),g);if(y!==!0){var C=u(y);throw C==="string"?Error(y):C==="error"?y:Error("[Validator Error]: The scheme for '".concat(g.join("."),"' validator require return true, but got '").concat(y,"'"))}}}return n.kindOf=u,n}()},{}],lh3R5:[function(a,p,s,x){p.exports=JSON.parse('{"name":"artplayer","version":"5.3.0","description":"ArtPlayer.js is a modern and full featured HTML5 video player","author":"Harvey Zack <laozhaochaguan@gmail.com>","license":"MIT","homepage":"https://artplayer.org","repository":{"type":"git","url":"git+https://github.com/zhw2590582/ArtPlayer.git"},"bugs":{"url":"https://github.com/zhw2590582/ArtPlayer/issues"},"keywords":["html5","video","player"],"exports":{".":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.mjs","require":"./dist/artplayer.js"},"./legacy":{"types":"./types/artplayer.d.ts","import":"./dist/artplayer.legacy.js","require":"./dist/artplayer.legacy.js"},"./i18n/*":{"types":"./types/i18n.d.ts","import":"./dist/i18n/*.mjs","require":"./dist/i18n/*.js"}},"main":"./dist/artplayer.js","module":"./dist/artplayer.mjs","types":"./types/artplayer.d.ts","typesVersions":{"*":{"i18n/*":["types/i18n.d.ts"],"legacy":["types/artplayer.d.ts"]}},"legacy":"./dist/artplayer.legacy.js","browserslist":"last 1 Chrome version","dependencies":{"option-validator":"^2.0.6"}}')},{}],eJfh8:[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s),s.default={properties:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],loqXi:[function(a,p,s,x){s.interopDefault=function(t){return t&&t.__esModule?t:{default:t}},s.defineInteropFlag=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.exportAll=function(t,e){return Object.keys(t).forEach(function(u){u==="default"||u==="__esModule"||Object.prototype.hasOwnProperty.call(e,u)||Object.defineProperty(e,u,{enumerable:!0,get:function(){return t[u]}})}),e},s.export=function(t,e,u){Object.defineProperty(t,e,{enumerable:!0,get:u})}},{}],"9zso8":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("../utils"),u=a("../utils/component"),r=t.interopDefault(u),n=a("./aspectRatio"),o=t.interopDefault(n),i=a("./close"),c=t.interopDefault(i),f=a("./flip"),g=t.interopDefault(f),y=a("./info"),C=t.interopDefault(y),A=a("./playbackRate"),H=t.interopDefault(A),w=a("./version"),_=t.interopDefault(w);class M extends r.default{constructor(S){super(S),this.name="contextmenu",this.$parent=S.template.$contextmenu,e.isMobile||this.init()}init(){let{option:S,proxy:P,template:{$player:J,$contextmenu:oe}}=this.art;S.playbackRate&&this.add((0,H.default)({name:"playbackRate",index:10})),S.aspectRatio&&this.add((0,o.default)({name:"aspectRatio",index:20})),S.flip&&this.add((0,g.default)({name:"flip",index:30})),this.add((0,C.default)({name:"info",index:40})),this.add((0,_.default)({name:"version",index:50})),this.add((0,c.default)({name:"close",index:60}));for(let me=0;me<S.contextmenu.length;me++)this.add(S.contextmenu[me]);P(J,"contextmenu",me=>{if(!this.art.constructor.CONTEXTMENU)return;me.preventDefault(),this.show=!0;let Se=me.clientX,je=me.clientY,{height:T,width:V,left:Y,top:_e}=(0,e.getRect)(J),{height:Pe,width:se}=(0,e.getRect)(oe),de=Se-Y,Me=je-_e;Se+se>Y+V&&(de=V-se),je+Pe>_e+T&&(Me=T-Pe),(0,e.setStyles)(oe,{top:`${Me}px`,left:`${de}px`})}),P(J,"click",me=>{(0,e.includeFromEvent)(me,oe)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}s.default=M},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"6XHP2","./close":"eF6AX","./flip":"7Wg1P","./info":"fjRnU","./playbackRate":"hm1DY","./version":"aJBeL","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBlEo:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./compatibility");t.exportAll(e,s);var u=a("./dom");t.exportAll(u,s);var r=a("./error");t.exportAll(r,s);var n=a("./file");t.exportAll(n,s);var o=a("./format");t.exportAll(o,s);var i=a("./property");t.exportAll(i,s);var c=a("./subtitle");t.exportAll(c,s);var f=a("./time");t.exportAll(f,s)},{"./compatibility":"jg0yq","./dom":"eANXw","./error":"4FwTI","./file":"i2JbS","./format":"dy9GH","./property":"jY49c","./subtitle":"ke7ox","./time":"f7gsx","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jg0yq:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"userAgent",()=>e),t.export(s,"isSafari",()=>u),t.export(s,"isIOS",()=>r),t.export(s,"isIOS13",()=>n),t.export(s,"isMobile",()=>o),t.export(s,"isBrowser",()=>i);let e=(globalThis==null?void 0:globalThis.CUSTOM_USER_AGENT)??(typeof navigator<"u"?navigator.userAgent:""),u=/^(?:(?!chrome|android).)*safari/i.test(e),r=/iPad|iPhone|iPod/i.test(e)&&!window.MSStream,n=r||e.includes("Macintosh")&&navigator.maxTouchPoints>=1,o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)||n,i=typeof window<"u"&&typeof document<"u"},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eANXw:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"query",()=>u),t.export(s,"queryAll",()=>r),t.export(s,"addClass",()=>n),t.export(s,"removeClass",()=>o),t.export(s,"hasClass",()=>i),t.export(s,"append",()=>c),t.export(s,"remove",()=>f),t.export(s,"setStyle",()=>g),t.export(s,"setStyles",()=>y),t.export(s,"getStyle",()=>C),t.export(s,"siblings",()=>A),t.export(s,"inverseClass",()=>H),t.export(s,"tooltip",()=>w),t.export(s,"isInViewport",()=>_),t.export(s,"includeFromEvent",()=>M),t.export(s,"replaceElement",()=>$),t.export(s,"createElement",()=>S),t.export(s,"getIcon",()=>P),t.export(s,"setStyleText",()=>J),t.export(s,"supportsFlex",()=>oe),t.export(s,"getRect",()=>me),t.export(s,"loadImg",()=>Se),t.export(s,"getComposedPath",()=>je);var e=a("./compatibility");function u(T,V=document){return V.querySelector(T)}function r(T,V=document){return Array.from(V.querySelectorAll(T))}function n(T,V){return T.classList.add(V)}function o(T,V){return T.classList.remove(V)}function i(T,V){return T.classList.contains(V)}function c(T,V){return V instanceof Element?T.appendChild(V):T.insertAdjacentHTML("beforeend",String(V)),T.lastElementChild||T.lastChild}function f(T){return T.parentNode.removeChild(T)}function g(T,V,Y){return T.style[V]=Y,T}function y(T,V){for(let Y in V)g(T,Y,V[Y]);return T}function C(T,V,Y=!0){let _e=window.getComputedStyle(T,null).getPropertyValue(V);return Y?Number.parseFloat(_e):_e}function A(T){return Array.from(T.parentElement.children).filter(V=>V!==T)}function H(T,V){A(T).forEach(Y=>o(Y,V)),n(T,V)}function w(T,V,Y="top"){e.isMobile||(T.setAttribute("aria-label",V),n(T,"hint--rounded"),n(T,`hint--${Y}`))}function _(T,V=0){let Y=T.getBoundingClientRect(),_e=window.innerHeight||document.documentElement.clientHeight,Pe=window.innerWidth||document.documentElement.clientWidth,se=Y.top-V<=_e&&Y.top+Y.height+V>=0,de=Y.left-V<=Pe+V&&Y.left+Y.width+V>=0;return se&&de}function M(T,V){return je(T).includes(V)}function $(T,V){return V.parentNode.replaceChild(T,V),T}function S(T){return document.createElement(T)}function P(T="",V=""){let Y=S("i");return n(Y,"art-icon"),n(Y,`art-icon-${T}`),c(Y,V),Y}function J(T,V){let Y=document.getElementById(T);Y||((Y=document.createElement("style")).id=T,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{document.head.appendChild(Y)}):(document.head||document.documentElement).appendChild(Y)),Y.textContent=V}function oe(){let T=document.createElement("div");return T.style.display="flex",T.style.display==="flex"}function me(T){return T.getBoundingClientRect()}function Se(T,V){return new Promise((Y,_e)=>{let Pe=new Image;Pe.onload=function(){if(V&&V!==1){let se=document.createElement("canvas"),de=se.getContext("2d");se.width=Pe.width*V,se.height=Pe.height*V,de.drawImage(Pe,0,0,se.width,se.height),se.toBlob(Me=>{let K=URL.createObjectURL(Me),ke=new Image;ke.onload=function(){Y(ke)},ke.onerror=function(){URL.revokeObjectURL(K),_e(Error(`Image load failed: ${T}`))},ke.src=K})}else Y(Pe)},Pe.onerror=function(){_e(Error(`Image load failed: ${T}`))},Pe.src=T})}function je(T){if(T.composedPath)return T.composedPath();let V=[],Y=T.target;for(;Y;)V.push(Y),Y=Y.parentNode;return V.includes(window)||window===void 0||V.push(window),V}},{"./compatibility":"jg0yq","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4FwTI":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"ArtPlayerError",()=>e),t.export(s,"errorHandle",()=>u);class e extends Error{constructor(n,o){super(n),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,o||this.constructor),this.name="ArtPlayerError"}}function u(r,n){if(!r)throw new e(n);return r}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i2JbS:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u,r){let n=document.createElement("a");n.style.display="none",n.href=u,n.download=r,document.body.appendChild(n),n.click(),document.body.removeChild(n)}t.defineInteropFlag(s),t.export(s,"getExt",()=>function u(r){return r.includes("?")?u(r.split("?")[0]):r.includes("#")?u(r.split("#")[0]):r.trim().toLowerCase().split(".").pop()}),t.export(s,"download",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dy9GH:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(i,c,f){return Math.max(Math.min(i,Math.max(c,f)),Math.min(c,f))}function u(i){return i.charAt(0).toUpperCase()+i.slice(1)}function r(i){if(!i)return"00:00";let c=Math.floor(i/3600),f=Math.floor((i-3600*c)/60),g=Math.floor(i-3600*c-60*f);return(c>0?[c,f,g]:[f,g]).map(y=>y<10?`0${y}`:String(y)).join(":")}function n(i){return i.replace(/[&<>'"]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[c]||c)}function o(i){let c={"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&quot;":'"'},f=RegExp(`(${Object.keys(c).join("|")})`,"g");return i.replace(f,g=>c[g]||g)}t.defineInteropFlag(s),t.export(s,"clamp",()=>e),t.export(s,"capitalize",()=>u),t.export(s,"secondToTime",()=>r),t.export(s,"escape",()=>n),t.export(s,"unescape",()=>o)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jY49c:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"def",()=>e),t.export(s,"has",()=>r),t.export(s,"get",()=>n),t.export(s,"mergeDeep",()=>function o(...i){let c=f=>f&&typeof f=="object"&&!Array.isArray(f);return i.reduce((f,g)=>(Object.keys(g).forEach(y=>{let C=f[y],A=g[y];Array.isArray(C)&&Array.isArray(A)?f[y]=C.concat(...A):c(C)&&c(A)?f[y]=o(C,A):f[y]=A}),f),{})});let e=Object.defineProperty,{hasOwnProperty:u}=Object.prototype;function r(o,i){return u.call(o,i)}function n(o,i){return Object.getOwnPropertyDescriptor(o,i)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ke7ox:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(n){return`WEBVTT \r
\r
`.concat(n.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(o,i,c)=>{let f=c.slice(0,3);return c.length===1&&(f=`${c}00`),c.length===2&&(f=`${c}0`),`${i},${f}`}).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/\{[\s\S]*?\}/g,"").concat(`\r
\r
`))}function u(n){return URL.createObjectURL(new Blob([n],{type:"text/vtt"}))}function r(n){let o=RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function i(c=""){return c.split(/[:.]/).map((f,g,y)=>{if(g===y.length-1){if(f.length===1)return`.${f}00`;if(f.length===2)return`.${f}0`}else if(f.length===1)return(g===0?"0":":0")+f;return g===0?f:g===y.length-1?`.${f}`:`:${f}`}).join("")}return`WEBVTT ${n.split(/\r?\n/).map(c=>{let f=c.match(o);return f?{start:i(f[1].trim()),end:i(f[2].trim()),text:f[5].replace(/\{[\s\S]*?\}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(g=>g.trim()).join(`
`)}:null}).filter(c=>c).map((c,f)=>c?`${f+1} ${c.start} --> ${c.end} ${c.text}`:"").filter(c=>c.trim()).join(`

`)}`}t.defineInteropFlag(s),t.export(s,"srtToVtt",()=>e),t.export(s,"vttToBlob",()=>u),t.export(s,"assToVtt",()=>r)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f7gsx:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(n=0){return new Promise(o=>setTimeout(o,n))}function u(n,o){let i;return function(...c){let f=()=>(i=null,n.apply(this,c));clearTimeout(i),i=setTimeout(f,o)}}function r(n,o){let i=!1;return function(...c){i||(n.apply(this,c),i=!0,setTimeout(()=>{i=!1},o))}}t.defineInteropFlag(s),t.export(s,"sleep",()=>e),t.export(s,"debounce",()=>u),t.export(s,"throttle",()=>r)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],idCEj:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("option-validator"),u=t.interopDefault(e),r=a("../scheme"),n=a("./dom"),o=a("./error");s.default=class{constructor(i){this.id=0,this.art=i,this.cache=new Map,this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.update=this.update.bind(this)}get show(){return(0,n.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(i){let{$player:c}=this.art.template,f=`art-${this.name}-show`;i?(0,n.addClass)(c,f):(0,n.removeClass)(c,f),this.art.emit(this.name,i)}toggle(){this.show=!this.show}add(i){let c=typeof i=="function"?i(this.art):i;if(c.html=c.html||"",(0,u.default)(c,r.ComponentOption),!this.$parent||!this.name||c.disable)return;let f=c.name||`${this.name}${this.id}`,g=this.cache.get(f);(0,o.errorHandle)(!g,`Can't add an existing [${f}] to the [${this.name}]`),this.id+=1;let y=(0,n.createElement)("div");(0,n.addClass)(y,`art-${this.name}`),(0,n.addClass)(y,`art-${this.name}-${f}`);let C=Array.from(this.$parent.children);y.dataset.index=c.index||this.id;let A=C.find(w=>Number(w.dataset.index)>=Number(y.dataset.index));A?A.insertAdjacentElement("beforebegin",y):(0,n.append)(this.$parent,y),c.html&&(0,n.append)(y,c.html),c.style&&(0,n.setStyles)(y,c.style),c.tooltip&&(0,n.tooltip)(y,c.tooltip);let H=[];if(c.click){let w=this.art.events.proxy(y,"click",_=>{_.preventDefault(),c.click.call(this.art,this,_)});H.push(w)}return c.selector&&["left","right"].includes(c.position)&&this.selector(c,y,H),this[f]=y,this.cache.set(f,{$ref:y,events:H,option:c}),c.mounted&&c.mounted.call(this.art,y),y}remove(i){let c=this.cache.get(i);(0,o.errorHandle)(c,`Can't find [${i}] from the [${this.name}]`),c.option.beforeUnmount&&c.option.beforeUnmount.call(this.art,c.$ref);for(let f=0;f<c.events.length;f++)this.art.events.remove(c.events[f]);this.cache.delete(i),delete this[i],(0,n.remove)(c.$ref)}update(i){let c=this.cache.get(i.name);return c&&(i=Object.assign(c.option,i),this.remove(i.name)),this.add(i)}}},{"option-validator":"g7VGh","../scheme":"biLjm","./dom":"eANXw","./error":"4FwTI","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],biLjm:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"ComponentOption",()=>g);var e=a("../utils");let u="array",r="boolean",n="string",o="number",i="object",c="function";function f(y,C,A){return(0,e.errorHandle)(C===n||C===o||y instanceof Element,`${A.join(".")} require '${n}' or 'Element' type`)}let g={html:f,disable:`?${r}`,name:`?${n}`,index:`?${o}`,style:`?${i}`,click:`?${c}`,mounted:`?${c}`,tooltip:`?${n}|${o}`,width:`?${o}`,selector:`?${u}`,onSelect:`?${c}`,switch:`?${r}`,onSwitch:`?${c}`,range:`?${u}`,onRange:`?${c}`,onChange:`?${c}`};s.default={id:n,container:f,url:n,poster:n,type:n,theme:n,lang:n,volume:o,isLive:r,muted:r,autoplay:r,autoSize:r,autoMini:r,loop:r,flip:r,playbackRate:r,aspectRatio:r,screenshot:r,setting:r,hotkey:r,pip:r,mutex:r,backdrop:r,fullscreen:r,fullscreenWeb:r,subtitleOffset:r,miniProgressBar:r,useSSR:r,playsInline:r,lock:r,gesture:r,fastForward:r,autoPlayback:r,autoOrientation:r,airplay:r,proxy:`?${c}`,plugins:[c],layers:[g],contextmenu:[g],settings:[g],controls:[{...g,position:(y,C,A)=>{let H=["top","left","right"];return(0,e.errorHandle)(H.includes(y),`${A.join(".")} only accept ${H.toString()} as parameters`)}}],quality:[{default:`?${r}`,html:n,url:n}],highlight:[{time:o,text:n}],thumbnails:{url:n,number:o,column:o,width:o,height:o,scale:o},subtitle:{url:n,name:n,type:n,style:i,escape:r,encoding:n,onVttLoad:c},moreVideoAttr:i,i18n:i,icons:i,cssVar:i,customType:i}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6XHP2":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>{let{i18n:o,constructor:{ASPECT_RATIO:i}}=n,c=i.map(f=>`<span data-value="${f}">${f==="default"?o.get("Default"):f}</span>`).join("");return{...r,html:`${o.get("Aspect Ratio")}: ${c}`,click:(f,g)=>{let{value:y}=g.target.dataset;y&&(n.aspectRatio=y,f.show=!1)},mounted:f=>{let g=(0,e.query)('[data-value="default"]',f);g&&(0,e.inverseClass)(g,"art-current"),n.on("aspectRatio",y=>{let C=(0,e.queryAll)("span",f).find(A=>A.dataset.value===y);C&&(0,e.inverseClass)(C,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eF6AX:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u){return r=>({...u,html:r.i18n.get("Close"),click:n=>{n.show=!1}})}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7Wg1P":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>{let{i18n:o,constructor:{FLIP:i}}=n,c=i.map(f=>`<span data-value="${f}">${o.get((0,e.capitalize)(f))}</span>`).join("");return{...r,html:`${o.get("Video Flip")}: ${c}`,click:(f,g)=>{let{value:y}=g.target.dataset;y&&(n.flip=y.toLowerCase(),f.show=!1)},mounted:f=>{let g=(0,e.query)('[data-value="normal"]',f);g&&(0,e.inverseClass)(g,"art-current"),n.on("flip",y=>{let C=(0,e.queryAll)("span",f).find(A=>A.dataset.value===y);C&&(0,e.inverseClass)(C,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjRnU:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u){return r=>({...u,html:r.i18n.get("Video Info"),click:n=>{r.info.show=!0,n.show=!1}})}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hm1DY:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>{let{i18n:o,constructor:{PLAYBACK_RATE:i}}=n,c=i.map(f=>`<span data-value="${f}">${f===1?o.get("Normal"):f.toFixed(1)}</span>`).join("");return{...r,html:`${o.get("Play Speed")}: ${c}`,click:(f,g)=>{let{value:y}=g.target.dataset;y&&(n.playbackRate=Number(y),f.show=!1)},mounted:f=>{let g=(0,e.query)('[data-value="1"]',f);g&&(0,e.inverseClass)(g,"art-current"),n.on("video:ratechange",()=>{let y=(0,e.queryAll)("span",f).find(C=>Number(C.dataset.value)===n.playbackRate);y&&(0,e.inverseClass)(y,"art-current")})}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aJBeL:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>function(u){return{...u,html:`<a href="https://artplayer.org" target="_blank">ArtPlayer ${e.version}</a>`}});var e=a("../../package.json")},{"../../package.json":"lh3R5","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dp1yk:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("../utils"),u=a("../utils/component"),r=t.interopDefault(u),n=a("./airplay"),o=t.interopDefault(n),i=a("./fullscreen"),c=t.interopDefault(i),f=a("./fullscreenWeb"),g=t.interopDefault(f),y=a("./pip"),C=t.interopDefault(y),A=a("./playAndPause"),H=t.interopDefault(A),w=a("./progress"),_=t.interopDefault(w),M=a("./screenshot"),$=t.interopDefault(M),S=a("./setting"),P=t.interopDefault(S),J=a("./time"),oe=t.interopDefault(J),me=a("./volume"),Se=t.interopDefault(me);class je extends r.default{constructor(V){super(V),this.isHover=!1,this.name="control",this.timer=Date.now();let{constructor:Y}=V,{$player:_e,$bottom:Pe}=this.art.template;V.on("mousemove",()=>{e.isMobile||(this.show=!0)}),V.on("click",()=>{e.isMobile?this.toggle():this.show=!0}),V.on("document:mousemove",se=>{this.isHover=(0,e.includeFromEvent)(se,Pe)}),V.on("video:timeupdate",()=>{!V.setting.show&&!this.isHover&&!V.isInput&&V.playing&&this.show&&Date.now()-this.timer>=Y.CONTROL_HIDE_TIME&&(this.show=!1)}),V.on("control",se=>{se?((0,e.removeClass)(_e,"art-hide-cursor"),(0,e.addClass)(_e,"art-hover"),this.timer=Date.now()):((0,e.addClass)(_e,"art-hide-cursor"),(0,e.removeClass)(_e,"art-hover"))}),this.init()}init(){let{option:V}=this.art;V.isLive||this.add((0,_.default)({name:"progress",position:"top",index:10})),this.add({name:"thumbnails",position:"top",index:20}),this.add((0,H.default)({name:"playAndPause",position:"left",index:10})),this.add((0,Se.default)({name:"volume",position:"left",index:20})),V.isLive||this.add((0,oe.default)({name:"time",position:"left",index:30})),V.quality.length&&(0,e.sleep)().then(()=>{this.art.quality=V.quality}),V.screenshot&&!e.isMobile&&this.add((0,$.default)({name:"screenshot",position:"right",index:20})),V.setting&&this.add((0,P.default)({name:"setting",position:"right",index:30})),V.pip&&this.add((0,C.default)({name:"pip",position:"right",index:40})),V.airplay&&window.WebKitPlaybackTargetAvailabilityEvent&&this.add((0,o.default)({name:"airplay",position:"right",index:50})),V.fullscreenWeb&&this.add((0,g.default)({name:"fullscreenWeb",position:"right",index:60})),V.fullscreen&&this.add((0,c.default)({name:"fullscreen",position:"right",index:70}));for(let Y=0;Y<V.controls.length;Y++)this.add(V.controls[Y])}add(V){let Y=typeof V=="function"?V(this.art):V,{$progress:_e,$controlsLeft:Pe,$controlsRight:se}=this.art.template;switch(Y.position){case"top":this.$parent=_e;break;case"left":this.$parent=Pe;break;case"right":this.$parent=se;break;default:(0,e.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(Y)}check(V){V.$control_value.innerHTML=V.html;for(let Y=0;Y<V.$control_option.length;Y++){let _e=V.$control_option[Y];_e.default=_e===V,_e.default&&(0,e.inverseClass)(_e.$control_item,"art-current")}}selector(V,Y,_e){let{proxy:Pe}=this.art.events;(0,e.addClass)(Y,"art-control-selector");let se=(0,e.createElement)("div");(0,e.addClass)(se,"art-selector-value"),(0,e.append)(se,V.html),Y.textContent="",(0,e.append)(Y,se);let de=(0,e.createElement)("div");(0,e.addClass)(de,"art-selector-list"),(0,e.append)(Y,de);for(let K=0;K<V.selector.length;K++){let ke=V.selector[K],ce=(0,e.createElement)("div");(0,e.addClass)(ce,"art-selector-item"),ke.default&&(0,e.addClass)(ce,"art-current"),ce.dataset.index=K,ce.dataset.value=ke.value,ce.innerHTML=ke.html,(0,e.append)(de,ce),(0,e.def)(ke,"$control_option",{get:()=>V.selector}),(0,e.def)(ke,"$control_item",{get:()=>ce}),(0,e.def)(ke,"$control_value",{get:()=>se})}let Me=Pe(de,"click",async K=>{let ke=(0,e.getComposedPath)(K),ce=V.selector.find(G=>G.$control_item===ke.find(q=>G.$control_item===q));this.check(ce),V.onSelect&&(se.innerHTML=await V.onSelect.call(this.art,ce,ce.$control_item,K))});_e.push(Me)}}s.default=je},{"../utils":"aBlEo","../utils/component":"idCEj","./airplay":"amOzz","./fullscreen":"3GuBU","./fullscreenWeb":"jj1KV","./pip":"jMeHN","./playAndPause":"u3h8M","./progress":"1XZSS","./screenshot":"dIscA","./setting":"aqA0g","./time":"ihweO","./volume":"fJVWn","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],amOzz:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,tooltip:n.i18n.get("AirPlay"),mounted:o=>{let{proxy:i,icons:c}=n;(0,e.append)(o,c.airplay),i(o,"click",()=>n.airplay())}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3GuBU":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,tooltip:n.i18n.get("Fullscreen"),mounted:o=>{let{proxy:i,icons:c,i18n:f}=n,g=(0,e.append)(o,c.fullscreenOn),y=(0,e.append)(o,c.fullscreenOff);(0,e.setStyle)(y,"display","none"),i(o,"click",()=>{n.fullscreen=!n.fullscreen}),n.on("fullscreen",C=>{C?((0,e.tooltip)(o,f.get("Exit Fullscreen")),(0,e.setStyle)(g,"display","none"),(0,e.setStyle)(y,"display","inline-flex")):((0,e.tooltip)(o,f.get("Fullscreen")),(0,e.setStyle)(g,"display","inline-flex"),(0,e.setStyle)(y,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jj1KV:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,tooltip:n.i18n.get("Web Fullscreen"),mounted:o=>{let{proxy:i,icons:c,i18n:f}=n,g=(0,e.append)(o,c.fullscreenWebOn),y=(0,e.append)(o,c.fullscreenWebOff);(0,e.setStyle)(y,"display","none"),i(o,"click",()=>{n.fullscreenWeb=!n.fullscreenWeb}),n.on("fullscreenWeb",C=>{C?((0,e.tooltip)(o,f.get("Exit Web Fullscreen")),(0,e.setStyle)(g,"display","none"),(0,e.setStyle)(y,"display","inline-flex")):((0,e.tooltip)(o,f.get("Web Fullscreen")),(0,e.setStyle)(g,"display","inline-flex"),(0,e.setStyle)(y,"display","none"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jMeHN:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,tooltip:n.i18n.get("PIP Mode"),mounted:o=>{let{proxy:i,icons:c,i18n:f}=n;(0,e.append)(o,c.pip),i(o,"click",()=>{n.pip=!n.pip}),n.on("pip",g=>{(0,e.tooltip)(o,f.get(g?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],u3h8M:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,mounted:o=>{let{proxy:i,icons:c,i18n:f}=n,g=(0,e.append)(o,c.play),y=(0,e.append)(o,c.pause);function C(){(0,e.setStyle)(g,"display","flex"),(0,e.setStyle)(y,"display","none")}function A(){(0,e.setStyle)(g,"display","none"),(0,e.setStyle)(y,"display","flex")}(0,e.tooltip)(g,f.get("Play")),(0,e.tooltip)(y,f.get("Pause")),i(g,"click",()=>{n.play()}),i(y,"click",()=>{n.pause()}),n.playing?A():C(),n.on("video:playing",()=>{A()}),n.on("video:pause",()=>{C()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1XZSS":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"getPosFromEvent",()=>u),t.export(s,"setCurrentTime",()=>r),t.export(s,"default",()=>n);var e=a("../utils");function u(o,i){let{$progress:c}=o.template,{left:f}=(0,e.getRect)(c),g=e.isMobile?i.touches[0].clientX:i.clientX,y=(0,e.clamp)(g-f,0,c.clientWidth),C=y/c.clientWidth*o.duration,A=(0,e.secondToTime)(C),H=(0,e.clamp)(y/c.clientWidth,0,1);return{second:C,time:A,width:y,percentage:H}}function r(o,i){if(o.isRotate){let c=i.touches[0].clientY/o.height,f=c*o.duration;o.emit("setBar","played",c,i),o.seek=f}else{let{second:c,percentage:f}=u(o,i);o.emit("setBar","played",f,i),o.seek=c}}function n(o){return i=>{let{icons:c,option:f,proxy:g}=i;return{...o,html:'<div class="art-control-progress-inner"><div class="art-progress-hover"></div><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:y=>{let C=null,A=!1,H=(0,e.query)(".art-progress-hover",y),w=(0,e.query)(".art-progress-loaded",y),_=(0,e.query)(".art-progress-played",y),M=(0,e.query)(".art-progress-highlight",y),$=(0,e.query)(".art-progress-indicator",y),S=(0,e.query)(".art-progress-tip",y);function P(J,oe){let{width:me,time:Se}=oe||u(i,J);S.textContent=Se;let je=S.clientWidth;me<=je/2?(0,e.setStyle)(S,"left",0):me>y.clientWidth-je/2?(0,e.setStyle)(S,"left",`${y.clientWidth-je}px`):(0,e.setStyle)(S,"left",`${me-je/2}px`)}c.indicator?(0,e.append)($,c.indicator):(0,e.setStyle)($,"backgroundColor","var(--art-theme)"),i.on("setBar",function(J,oe,me){let Se=J==="played"&&me&&e.isMobile;J==="loaded"&&(0,e.setStyle)(w,"width",`${100*oe}%`),J==="hover"&&(0,e.setStyle)(H,"width",`${100*oe}%`),J==="played"&&((0,e.setStyle)(_,"width",`${100*oe}%`),(0,e.setStyle)($,"left",`${100*oe}%`)),Se&&((0,e.setStyle)(S,"display","flex"),P(me,{width:y.clientWidth*oe,time:(0,e.secondToTime)(oe*i.duration)}),clearTimeout(C),C=setTimeout(()=>{(0,e.setStyle)(S,"display","none")},500))}),i.on("video:loadedmetadata",function(){M.textContent="";for(let J=0;J<f.highlight.length;J++){let oe=f.highlight[J],me=(0,e.clamp)(oe.time,0,i.duration)/i.duration*100,Se=`<span data-text="${oe.text}" data-time="${oe.time}" style="left: ${me}%"></span>`;(0,e.append)(M,Se)}}),i.constructor.USE_RAF?i.on("raf",()=>{i.emit("setBar","played",i.played),i.emit("setBar","loaded",i.loaded)}):(i.on("video:timeupdate",()=>{i.emit("setBar","played",i.played)}),i.on("video:progress",()=>{i.emit("setBar","loaded",i.loaded)}),i.on("video:ended",()=>{i.emit("setBar","played",1)})),i.emit("setBar","loaded",i.loaded||0),e.isMobile||(g(y,"click",J=>{J.target!==$&&r(i,J)}),g(y,"mousemove",J=>{let{percentage:oe}=u(i,J);if(i.emit("setBar","hover",oe,J),(0,e.setStyle)(S,"display","flex"),(0,e.includeFromEvent)(J,M)){let{width:me}=u(i,J),{text:Se}=J.target.dataset;S.textContent=Se;let je=S.clientWidth;me<=je/2?(0,e.setStyle)(S,"left",0):me>y.clientWidth-je/2?(0,e.setStyle)(S,"left",`${y.clientWidth-je}px`):(0,e.setStyle)(S,"left",`${me-je/2}px`)}else P(J)}),g(y,"mouseleave",J=>{(0,e.setStyle)(S,"display","none"),i.emit("setBar","hover",0,J)}),g(y,"mousedown",J=>{A=J.button===0}),i.on("document:mousemove",J=>{if(A){let{second:oe,percentage:me}=u(i,J);i.emit("setBar","played",me,J),i.seek=oe}}),i.on("document:mouseup",()=>{A&&(A=!1)}))}}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dIscA:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,tooltip:n.i18n.get("Screenshot"),mounted:o=>{let{proxy:i,icons:c}=n;(0,e.append)(o,c.screenshot),i(o,"click",()=>{n.screenshot()})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aqA0g:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,tooltip:n.i18n.get("Show Setting"),mounted:o=>{let{proxy:i,icons:c,i18n:f}=n;(0,e.append)(o,c.setting),i(o,"click",()=>{n.setting.toggle(),n.setting.resize()}),n.on("setting",g=>{(0,e.tooltip)(o,f.get(g?"Hide Setting":"Show Setting"))})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ihweO:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,style:e.isMobile?{fontSize:"12px",padding:"0 5px"}:{cursor:"auto",padding:"0 10px"},mounted:o=>{function i(){let f=`${(0,e.secondToTime)(n.currentTime)} / ${(0,e.secondToTime)(n.duration)}`;f!==o.textContent&&(o.textContent=f)}i();let c=["video:loadedmetadata","video:timeupdate","video:progress"];for(let f=0;f<c.length;f++)n.on(c[f],i)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fJVWn:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return n=>({...r,mounted:o=>{let{proxy:i,icons:c}=n,f=(0,e.append)(o,c.volume),g=(0,e.append)(o,c.volumeClose),y=(0,e.append)(o,'<div class="art-volume-panel"></div>'),C=(0,e.append)(y,'<div class="art-volume-inner"></div>'),A=(0,e.append)(C,'<div class="art-volume-val"></div>'),H=(0,e.append)(C,'<div class="art-volume-slider"></div>'),w=(0,e.append)(H,'<div class="art-volume-handle"></div>'),_=(0,e.append)(w,'<div class="art-volume-loaded"></div>'),M=(0,e.append)(H,'<div class="art-volume-indicator"></div>');function $(P){let{top:J,height:oe}=(0,e.getRect)(H);return 1-(P.clientY-J)/oe}function S(){if(n.muted||n.volume===0)(0,e.setStyle)(f,"display","none"),(0,e.setStyle)(g,"display","flex"),(0,e.setStyle)(M,"top","100%"),(0,e.setStyle)(_,"top","100%"),A.textContent=0;else{let P=100*n.volume;(0,e.setStyle)(f,"display","flex"),(0,e.setStyle)(g,"display","none"),(0,e.setStyle)(M,"top",`${100-P}%`),(0,e.setStyle)(_,"top",`${100-P}%`),A.textContent=Math.floor(P)}}if(S(),n.on("video:volumechange",S),i(f,"click",()=>{n.muted=!0}),i(g,"click",()=>{n.muted=!1}),e.isMobile)(0,e.setStyle)(y,"display","none");else{let P=!1;i(H,"mousedown",J=>{P=J.button===0,n.volume=$(J)}),n.on("document:mousemove",J=>{P&&(n.muted=!1,n.volume=$(J))}),n.on("document:mouseup",()=>{P&&(P=!1)})}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jmVSD:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./clickInit"),u=t.interopDefault(e),r=a("./gestureInit"),n=t.interopDefault(r),o=a("./globalInit"),i=t.interopDefault(o),c=a("./hoverInit"),f=t.interopDefault(c),g=a("./moveInit"),y=t.interopDefault(g),C=a("./resizeInit"),A=t.interopDefault(C),H=a("./updateInit"),w=t.interopDefault(H),_=a("./viewInit"),M=t.interopDefault(_);s.default=class{constructor($){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),(0,u.default)($,this),(0,f.default)($,this),(0,y.default)($,this),(0,A.default)($,this),(0,n.default)($,this),(0,M.default)($,this),(0,i.default)($,this),(0,w.default)($,this)}proxy($,S,P,J={}){if(Array.isArray(S))return S.map(me=>this.proxy($,me,P,J));$.addEventListener(S,P,J);let oe=()=>$.removeEventListener(S,P,J);return this.destroyEvents.push(oe),oe}hover($,S,P){S&&this.proxy($,"mouseenter",S),P&&this.proxy($,"mouseleave",P)}remove($){let S=this.destroyEvents.indexOf($);S>-1&&($(),this.destroyEvents.splice(S,1))}destroy(){for(let $=0;$<this.destroyEvents.length;$++)this.destroyEvents[$]()}}},{"./clickInit":"i8G6V","./gestureInit":"9wEzB","./globalInit":"ikBrS","./hoverInit":"jwNq0","./moveInit":"eqSsP","./resizeInit":"42JNz","./updateInit":"7kM1M","./viewInit":"2IW9m","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],i8G6V:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r,n){let{constructor:o,template:{$player:i,$video:c}}=r;function f(y){(0,e.includeFromEvent)(y,i)?(r.isInput=y.target.tagName==="INPUT",r.isFocus=!0,r.emit("focus",y)):(r.isInput=!1,r.isFocus=!1,r.emit("blur",y))}r.on("document:click",f),r.on("document:contextmenu",f);let g=[];n.proxy(c,"click",y=>{let C=Date.now();g.push(C);let{MOBILE_CLICK_PLAY:A,DBCLICK_TIME:H,MOBILE_DBCLICK_PLAY:w,DBCLICK_FULLSCREEN:_}=o,M=g.filter($=>C-$<=H);switch(M.length){case 1:r.emit("click",y),e.isMobile?!r.isLock&&A&&r.toggle():r.toggle(),g=M;break;case 2:r.emit("dblclick",y),e.isMobile?!r.isLock&&w&&r.toggle():_&&(r.fullscreen=!r.fullscreen),g=[];break;default:g=[]}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"9wEzB":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>r);var e=a("../control/progress"),u=a("../utils");function r(n,o){if(u.isMobile&&!n.option.isLive){let{$video:i,$progress:c}=n.template,f=null,g=!1,y=0,C=0,A=0,H=_=>{if(_.touches.length===1&&!n.isLock){f===c&&(0,e.setCurrentTime)(n,_),g=!0;let{pageX:M,pageY:$}=_.touches[0];y=M,C=$,A=n.currentTime}},w=_=>{if(_.touches.length===1&&g&&n.duration){let{pageX:M,pageY:$}=_.touches[0],S=function(oe,me,Se,je){let T=me-je,V=Se-oe,Y=0;if(2>Math.abs(V)&&2>Math.abs(T))return Y;let _e=180*Math.atan2(T,V)/Math.PI;return _e>=-45&&_e<45?Y=4:_e>=45&&_e<135?Y=1:_e>=-135&&_e<-45?Y=2:(_e>=135&&_e<=180||_e>=-180&&_e<-135)&&(Y=3),Y}(y,C,M,$),P=[3,4].includes(S),J=[1,2].includes(S);if(P&&!n.isRotate||J&&n.isRotate){let oe=(0,u.clamp)((M-y)/n.width,-1,1),me=(0,u.clamp)(($-C)/n.height,-1,1),Se=n.isRotate?me:oe,je=f===i?n.constructor.TOUCH_MOVE_RATIO:1,T=(0,u.clamp)(A+n.duration*Se*je,0,n.duration);n.seek=T,n.emit("setBar","played",(0,u.clamp)(T/n.duration,0,1),_),n.notice.show=`${(0,u.secondToTime)(T)} / ${(0,u.secondToTime)(n.duration)}`}}};n.option.gesture&&(o.proxy(i,"touchstart",_=>{f=i,H(_)}),o.proxy(i,"touchmove",w)),o.proxy(c,"touchstart",_=>{f=c,H(_)}),o.proxy(c,"touchmove",w),n.on("document:touchend",()=>{g&&(y=0,C=0,A=0,g=!1,f=null)})}}},{"../control/progress":"1XZSS","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ikBrS:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u,r){let n=["click","mouseup","keydown","touchend","touchmove","mousemove","pointerup","contextmenu","pointermove","visibilitychange","webkitfullscreenchange"],o=["resize","scroll","orientationchange"],i=[];function c(f={}){for(let y=0;y<i.length;y++)r.remove(i[y]);i.length=0;let{$player:g}=u.template;n.forEach(y=>{let C=f.document||g.ownerDocument||document,A=r.proxy(C,y,H=>{u.emit(`document:${y}`,H)});i.push(A)}),o.forEach(y=>{var H;let C=f.window||((H=g.ownerDocument)==null?void 0:H.defaultView)||window,A=r.proxy(C,y,w=>{u.emit(`window:${y}`,w)});i.push(A)})}c(),r.bindGlobalEvents=c}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jwNq0:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r,n){let{$player:o}=r.template;n.hover(o,i=>{(0,e.addClass)(o,"art-hover"),r.emit("hover",!0,i)},i=>{(0,e.removeClass)(o,"art-hover"),r.emit("hover",!1,i)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eqSsP:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u,r){let{$player:n}=u.template;r.proxy(n,"mousemove",o=>{u.emit("mousemove",o)})}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"42JNz":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r,n){let{option:o,constructor:i}=r;r.on("resize",()=>{let{aspectRatio:f,notice:g}=r;r.state==="standard"&&o.autoSize&&r.autoSize(),r.aspectRatio=f,g.show=""});let c=(0,e.debounce)(()=>r.emit("resize"),i.RESIZE_TIME);r.on("window:orientationchange",()=>c()),r.on("window:resize",()=>c()),screen&&screen.orientation&&screen.orientation.onchange&&n.proxy(screen.orientation,"change",()=>c())}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7kM1M":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u){if(u.constructor.USE_RAF){let r=null;(function n(){u.playing&&u.emit("raf"),u.isDestroy||(r=requestAnimationFrame(n))})(),u.on("destroy",()=>{cancelAnimationFrame(r)})}}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2IW9m":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{option:n,constructor:o,template:{$container:i}}=r,c=(0,e.throttle)(()=>{r.emit("view",(0,e.isInViewport)(i,o.SCROLL_GAP))},o.SCROLL_TIME);r.on("window:scroll",()=>c()),r.on("view",f=>{n.autoMini&&(r.mini=!f)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dswts:[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);var t=a("./utils");s.default=class{constructor(e){this.art=e,this.keys={},e.option.hotkey&&!t.isMobile&&this.init()}init(){let{constructor:e}=this.art;this.add("Escape",()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add("Space",()=>{this.art.toggle()}),this.add("ArrowLeft",()=>{this.art.backward=e.SEEK_STEP}),this.add("ArrowUp",()=>{this.art.volume+=e.VOLUME_STEP}),this.add("ArrowRight",()=>{this.art.forward=e.SEEK_STEP}),this.add("ArrowDown",()=>{this.art.volume-=e.VOLUME_STEP}),this.art.on("document:keydown",u=>{if(this.art.isFocus){let r=document.activeElement.tagName.toUpperCase(),n=document.activeElement.getAttribute("contenteditable");if(r!=="INPUT"&&r!=="TEXTAREA"&&n!==""&&n!=="true"&&!u.altKey&&!u.ctrlKey&&!u.metaKey&&!u.shiftKey){let o=this.keys[u.code];if(o){u.preventDefault();for(let i=0;i<o.length;i++)o[i].call(this.art,u);this.art.emit("hotkey",u)}}}this.art.emit("keydown",u)})}add(e,u){return this.keys[e]?this.keys[e].push(u):this.keys[e]=[u],this}remove(e,u){if(this.keys[e]){let r=this.keys[e].indexOf(u);r!==-1&&this.keys[e].splice(r,1)}return this}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d9ktO:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("../utils"),u=a("./zh-cn"),r=t.interopDefault(u);s.default=class{constructor(n){this.art=n,this.languages={"zh-cn":r.default},this.language={},this.update(n.option.i18n)}init(){let n=this.art.option.lang.toLowerCase();this.language=this.languages[n]||{}}get(n){return this.language[n]||n}update(n){this.languages=(0,e.mergeDeep)(this.languages,n),this.init()}}},{"../utils":"aBlEo","./zh-cn":"3hyaR","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3hyaR":[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);let t={"Video Info":"统计信息",Close:"关闭","Video Load Failed":"加载失败",Volume:"音量",Play:"播放",Pause:"暂停",Rate:"速度",Mute:"静音","Video Flip":"画面翻转",Horizontal:"水平",Vertical:"垂直",Reconnect:"重新连接","Show Setting":"显示设置","Hide Setting":"隐藏设置",Screenshot:"截图","Play Speed":"播放速度","Aspect Ratio":"画面比例",Default:"默认",Normal:"正常",Open:"打开","Switch Video":"切换","Switch Subtitle":"切换字幕",Fullscreen:"全屏","Exit Fullscreen":"退出全屏","Web Fullscreen":"网页全屏","Exit Web Fullscreen":"退出网页全屏","Mini Player":"迷你播放器","PIP Mode":"开启画中画","Exit PIP Mode":"退出画中画","PIP Not Supported":"不支持画中画","Fullscreen Not Supported":"不支持全屏","Subtitle Offset":"字幕偏移","Last Seen":"上次看到","Jump Play":"跳转播放",AirPlay:"隔空播放","AirPlay Not Available":"隔空播放不可用"};s.default=t,typeof window<"u"&&(window["artplayer-i18n-zh-cn"]=t)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fFHY0:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("bundle-text:./airplay.svg"),u=t.interopDefault(e),r=a("bundle-text:./arrow-left.svg"),n=t.interopDefault(r),o=a("bundle-text:./arrow-right.svg"),i=t.interopDefault(o),c=a("bundle-text:./aspect-ratio.svg"),f=t.interopDefault(c),g=a("bundle-text:./check.svg"),y=t.interopDefault(g),C=a("bundle-text:./close.svg"),A=t.interopDefault(C),H=a("bundle-text:./config.svg"),w=t.interopDefault(H),_=a("bundle-text:./error.svg"),M=t.interopDefault(_),$=a("bundle-text:./flip.svg"),S=t.interopDefault($),P=a("bundle-text:./fullscreen-off.svg"),J=t.interopDefault(P),oe=a("bundle-text:./fullscreen-on.svg"),me=t.interopDefault(oe),Se=a("bundle-text:./fullscreen-web-off.svg"),je=t.interopDefault(Se),T=a("bundle-text:./fullscreen-web-on.svg"),V=t.interopDefault(T),Y=a("bundle-text:./loading.svg"),_e=t.interopDefault(Y),Pe=a("bundle-text:./lock.svg"),se=t.interopDefault(Pe),de=a("bundle-text:./pause.svg"),Me=t.interopDefault(de),K=a("bundle-text:./pip.svg"),ke=t.interopDefault(K),ce=a("bundle-text:./play.svg"),G=t.interopDefault(ce),q=a("bundle-text:./playback-rate.svg"),Z=t.interopDefault(q),O=a("bundle-text:./screenshot.svg"),D=t.interopDefault(O),ve=a("bundle-text:./setting.svg"),te=t.interopDefault(ve),ue=a("bundle-text:./state.svg"),pe=t.interopDefault(ue),be=a("bundle-text:./switch-off.svg"),Le=t.interopDefault(be),fe=a("bundle-text:./switch-on.svg"),Re=t.interopDefault(fe),ne=a("bundle-text:./unlock.svg"),$e=t.interopDefault(ne),he=a("bundle-text:./volume-close.svg"),Te=t.interopDefault(he),Xe=a("bundle-text:./volume.svg"),Qe=t.interopDefault(Xe),st=a("../utils");s.default=class{constructor(xt){let bt={loading:_e.default,state:pe.default,play:G.default,pause:Me.default,check:y.default,volume:Qe.default,volumeClose:Te.default,screenshot:D.default,setting:te.default,pip:ke.default,arrowLeft:n.default,arrowRight:i.default,playbackRate:Z.default,aspectRatio:f.default,config:w.default,lock:se.default,flip:S.default,unlock:$e.default,fullscreenOff:J.default,fullscreenOn:me.default,fullscreenWebOff:je.default,fullscreenWebOn:V.default,switchOn:Re.default,switchOff:Le.default,error:M.default,close:A.default,airplay:u.default,...xt.option.icons};for(let ot in bt)(0,st.def)(this,ot,{get:()=>(0,st.getIcon)(ot,bt[ot])})}}},{"bundle-text:./airplay.svg":"gkZgZ","bundle-text:./arrow-left.svg":"kQyD4","bundle-text:./arrow-right.svg":"64ztm","bundle-text:./aspect-ratio.svg":"72LvA","bundle-text:./check.svg":"4QmBo","bundle-text:./close.svg":"j1hoe","bundle-text:./config.svg":"hNZaT","bundle-text:./error.svg":"dKh4l","bundle-text:./flip.svg":"lIEIE","bundle-text:./fullscreen-off.svg":"1533e","bundle-text:./fullscreen-on.svg":"76ut3","bundle-text:./fullscreen-web-off.svg":"3NzMk","bundle-text:./fullscreen-web-on.svg":"12xHc","bundle-text:./loading.svg":"iVcUF","bundle-text:./lock.svg":"1J4so","bundle-text:./pause.svg":"1KgkK","bundle-text:./pip.svg":"4h4tM","bundle-text:./play.svg":"jecAY","bundle-text:./playback-rate.svg":"anPe9","bundle-text:./screenshot.svg":"9BPYQ","bundle-text:./setting.svg":"hsI9k","bundle-text:./state.svg":"gr1ZU","bundle-text:./switch-off.svg":"6kdAr","bundle-text:./switch-on.svg":"ksdMo","bundle-text:./unlock.svg":"iz5Qc","bundle-text:./volume-close.svg":"3OZoa","bundle-text:./volume.svg":"hRYA4","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],gkZgZ:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path d="M16 1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h3v-2H3V3h12v8h-2v2h3a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"/><path d="M4 17h10l-5-6Z"/></svg>'},{}],kQyD4:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6Z"/></svg>'},{}],"64ztm":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6Z"/></svg>'},{}],"72LvA":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%;transform:translate(0)" viewBox="0 0 88 88"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0Z"/></clipPath></defs><g clip-path="url(#__lottie_element_216)"><g style="display:block"><path d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 1.4495849676166017e-7l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31C14.488-13.492 13.228-13.492 12.438-12.702m-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13ZM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8Z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></g></svg>'},{}],"4QmBo":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" style="width:100%;height:100%" viewBox="0 0 24 24"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4Z"/></svg>'},{}],j1hoe:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733C823.467 166.4 797.867 166.4 780.8 183.466L512 452.267l-268.8-268.8C226.133 166.4 200.533 166.4 183.467 183.466c-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733Z"/></svg>'},{}],hNZaT:[function(a,p,s,x){p.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M15 17h6v1h-6Zm-4 0H3v1h8v2h1v-5h-1Zm3-9h1V3h-1v2H3v1h11Zm4-3v1h3V5ZM6 14h1V9H6v2H3v1h3Zm4-2h11v-1H10Z" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],dKh4l:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 1024"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.1 93.1 0 0 1 34.447 33.341M512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88m0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2"/></svg>'},{}],lIEIE:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="icon" viewBox="0 0 1024 1024"><path d="M554.667 810.667V896h-85.333v-85.333Zm-384-632.662a42.67 42.67 0 0 1 34.987 18.219l203.903 291.328a42.67 42.67 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667m682.666 0a42.667 42.667 0 0 1 42.368 37.717l.299 4.95v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.67 42.67 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.67 42.67 0 0 1 34.944-18.219M554.667 640v85.333h-85.333V640Zm-358.4-320.896V716.8L335.957 512 196.31 319.104Zm358.4 150.23v85.333h-85.333v-85.333Zm0-170.667V384h-85.333v-85.333Zm0-170.667v85.333h-85.333V128Z"/></svg>'},{}],"1533e":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M768 298.667h170.667V384h-256V128H768ZM341.333 384h-256v-85.333H256V128h85.333ZM768 725.333V896h-85.333V640h256v85.333ZM341.333 640v256H256V725.333H85.333V640Z"/></svg>'},{}],"76ut3":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="icon" viewBox="0 0 1024 1024"><path d="M625.778 256H768v142.222h113.778v-256h-256ZM256 398.222V256h142.222V142.222h-256v256Zm512 227.556V768H625.778v113.778h256v-256ZM398.222 768H256V625.778H142.222v256h256Z"/></svg>'},{}],"3NzMk":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128ZM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384Zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448Z"/></svg>'},{}],"12xHc":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" class="icon" viewBox="0 0 1152 1024"><path d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0M1024 128v768H128V128Zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448Zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384Z"/></svg>'},{}],iVcUF:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" class="uil-default" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><path fill="none" d="M0 0h100v100H0Z" class="bk"/><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="translate(0 -30)"><animate attributeName="opacity" begin="-1s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(30 105.98 65)"><animate attributeName="opacity" begin="-0.9166666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(60 75.98 65)"><animate attributeName="opacity" begin="-0.8333333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(90 65 65)"><animate attributeName="opacity" begin="-0.75s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(120 58.66 65)"><animate attributeName="opacity" begin="-0.6666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(150 54.02 65)"><animate attributeName="opacity" begin="-0.5833333333333334s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="matrix(-1 0 0 -1 100 130)"><animate attributeName="opacity" begin="-0.5s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(210 45.98 65)"><animate attributeName="opacity" begin="-0.4166666666666667s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(240 41.34 65)"><animate attributeName="opacity" begin="-0.3333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-90 35 65)"><animate attributeName="opacity" begin="-0.25s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" begin="-0.16666666666666666s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect><rect width="6" height="20" x="47" y="40" rx="5" ry="5" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" begin="-0.08333333333333333s" dur="1s" from="1" repeatCount="indefinite" to="0"/></rect></svg>'},{}],"1J4so":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="M298.667 426.667v-85.333a213.333 213.333 0 1 1 426.667 0v85.333H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667ZM512 213.333a128 128 0 0 0-128 128v85.333h256v-85.333a128 128 0 0 0-128-128"/></svg>'},{}],"1KgkK":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2m8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2"/></svg>'},{}],"4h4tM":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 1024 1024"><path d="M844.8 219.648H179.2c-6.144 0-10.24 4.608-10.24 10.752v563.2c0 5.632 4.096 10.24 10.24 10.24h256V896h-256A102.4 102.4 0 0 1 76.8 793.6V230.4c0-56.832 45.568-102.4 102.4-102.4h665.6a102.4 102.4 0 0 1 102.4 102.4v204.8h-92.16V230.4c0-6.144-4.608-10.752-10.24-10.752M614.4 588.8c-28.672 0-51.2 22.528-51.2 51.2v204.8c0 28.16 22.528 51.2 51.2 51.2H896c28.16 0 51.2-23.04 51.2-51.2V640c0-28.672-23.04-51.2-51.2-51.2Z"/></svg>'},{}],jecAY:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45"/></svg>'},{}],anPe9:[function(a,p,s,x){p.exports='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M10 8v8l6-4ZM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2M5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8m0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4Zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22ZM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"9BPYQ":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10m0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8"/></svg>'},{}],hsI9k:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a7 7 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1 1 0 0 0-1.272.23l-1.008 1.225a7 7 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A7 7 0 0 0 4.4 8.6l-1.564.261A1 1 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.1 7.1 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a1 1 0 0 0 .835-.986V9.847a1 1 0 0 0-.836-.986M11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8"/></svg>'},{}],gr1ZU:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"><path d="M9.5 9.325v5.35q0 .575.525.875t1.025-.05l4.15-2.65q.475-.3.475-.85t-.475-.85L11.05 8.5q-.5-.35-1.025-.05t-.525.875M12 22q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12t.788-3.9 2.137-3.175q1.35-1.35 3.175-2.137T12 2t3.9.788 3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22"/></svg>'},{}],"6kdAr":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1740 1024"><path d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898m-.564-975.36A464.589 464.589 0 1 1 48.025 513.024 463.87 463.87 0 0 1 511.335 48.435Z"/></svg>'},{}],ksdMo:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" class="icon" viewBox="0 0 1664 1024"><path fill="#648ffc" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024m0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448"/></svg>'},{}],iz5Qc:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 1024 1024"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.333a213.333 213.333 0 0 1 368.085-146.816"/></svg>'},{}],"3OZoa":[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M15 11a4 4 0 0 0-2-3.465v2.636l1.865 1.865A4 4 0 0 0 15 11"/><path d="M13.583 5.583A6 6 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8 8 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805m5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806q.322-.154.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416M11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172Z"/></svg>'},{}],hRYA4:[function(a,p,s,x){p.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39m4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8 8 0 0 0 19 11a8 8 0 0 0-4.554-7.222"/><path d="M15 11a4 4 0 0 0-2-3.465v6.93A4 4 0 0 0 15 11"/></svg>'},{}],kZ0F8:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./utils"),u=a("./utils/component"),r=t.interopDefault(u);class n extends r.default{constructor(i){super(i),this.name="info",e.isMobile||this.init()}init(){let{proxy:i,constructor:c,template:{$infoPanel:f,$infoClose:g,$video:y}}=this.art;i(g,"click",()=>{this.show=!1});let C=null,A=(0,e.queryAll)("[data-video]",f)||[];this.art.on("destroy",()=>clearTimeout(C)),function H(){for(let w=0;w<A.length;w++){let _=A[w],M=y[_.dataset.video],$=typeof M=="number"?M.toFixed(2):M;_.textContent!==$&&(_.textContent=$)}C=setTimeout(H,c.INFO_LOOP_TIME)}()}}s.default=n},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j9lbi:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./utils/component"),u=t.interopDefault(e);class r extends u.default{constructor(o){super(o);let{option:i,template:{$layer:c}}=o;this.name="layer",this.$parent=c;for(let f=0;f<i.layers.length;f++)this.add(i.layers[f])}}s.default=r},{"./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bMjWd:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./utils"),u=a("./utils/component"),r=t.interopDefault(u);class n extends r.default{constructor(i){super(i),this.name="loading",(0,e.append)(i.template.$loading,i.icons.loading)}}s.default=n},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k1nkQ:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./utils"),u=a("./utils/component"),r=t.interopDefault(u);class n extends r.default{constructor(i){super(i),this.name="mask";let{template:c,icons:f,events:g}=i,y=(0,e.append)(c.$state,f.state),C=(0,e.append)(c.$state,f.error);(0,e.setStyle)(C,"display","none"),i.on("destroy",()=>{(0,e.setStyle)(y,"display","none"),(0,e.setStyle)(C,"display",null)}),g.proxy(c.$state,"click",()=>i.play())}}s.default=n},{"./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fPVaU:[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);var t=a("./utils");s.default=class{constructor(e){this.art=e,this.timer=null}set show(e){let{constructor:u,template:{$player:r,$noticeInner:n}}=this.art;e?(n.textContent=e instanceof Error?e.message.trim():e,(0,t.addClass)(r,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{n.textContent="",(0,t.removeClass)(r,"art-notice-show")},u.NOTICE_TIME)):(0,t.removeClass)(r,"art-notice-show")}get show(){let{template:{$player:e}}=this.art;return e.classList.contains("art-notice-show")}}},{"./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],uR0Sw:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("./airplayMix"),u=t.interopDefault(e),r=a("./aspectRatioMix"),n=t.interopDefault(r),o=a("./attrMix"),i=t.interopDefault(o),c=a("./autoHeightMix"),f=t.interopDefault(c),g=a("./autoSizeMix"),y=t.interopDefault(g),C=a("./cssVarMix"),A=t.interopDefault(C),H=a("./currentTimeMix"),w=t.interopDefault(H),_=a("./durationMix"),M=t.interopDefault(_),$=a("./eventInit"),S=t.interopDefault($),P=a("./flipMix"),J=t.interopDefault(P),oe=a("./fullscreenMix"),me=t.interopDefault(oe),Se=a("./fullscreenWebMix"),je=t.interopDefault(Se),T=a("./loadedMix"),V=t.interopDefault(T),Y=a("./miniMix"),_e=t.interopDefault(Y),Pe=a("./optionInit"),se=t.interopDefault(Pe),de=a("./pauseMix"),Me=t.interopDefault(de),K=a("./pipMix"),ke=t.interopDefault(K),ce=a("./playbackRateMix"),G=t.interopDefault(ce),q=a("./playedMix"),Z=t.interopDefault(q),O=a("./playingMix"),D=t.interopDefault(O),ve=a("./playMix"),te=t.interopDefault(ve),ue=a("./posterMix"),pe=t.interopDefault(ue),be=a("./qualityMix"),Le=t.interopDefault(be),fe=a("./rectMix"),Re=t.interopDefault(fe),ne=a("./screenshotMix"),$e=t.interopDefault(ne),he=a("./seekMix"),Te=t.interopDefault(he),Xe=a("./stateMix"),Qe=t.interopDefault(Xe),st=a("./subtitleOffsetMix"),xt=t.interopDefault(st),bt=a("./switchMix"),ot=t.interopDefault(bt),ht=a("./themeMix"),Ae=t.interopDefault(ht),ge=a("./thumbnailsMix"),Ie=t.interopDefault(ge),Je=a("./toggleMix"),L=t.interopDefault(Je),B=a("./typeMix"),le=t.interopDefault(B),re=a("./urlMix"),Be=t.interopDefault(re),qe=a("./volumeMix"),mt=t.interopDefault(qe);s.default=class{constructor(Ne){(0,Be.default)(Ne),(0,i.default)(Ne),(0,te.default)(Ne),(0,Me.default)(Ne),(0,L.default)(Ne),(0,Te.default)(Ne),(0,mt.default)(Ne),(0,w.default)(Ne),(0,M.default)(Ne),(0,ot.default)(Ne),(0,G.default)(Ne),(0,n.default)(Ne),(0,$e.default)(Ne),(0,me.default)(Ne),(0,je.default)(Ne),(0,ke.default)(Ne),(0,V.default)(Ne),(0,Z.default)(Ne),(0,D.default)(Ne),(0,y.default)(Ne),(0,Re.default)(Ne),(0,J.default)(Ne),(0,_e.default)(Ne),(0,pe.default)(Ne),(0,f.default)(Ne),(0,A.default)(Ne),(0,Ae.default)(Ne),(0,le.default)(Ne),(0,Qe.default)(Ne),(0,xt.default)(Ne),(0,u.default)(Ne),(0,Le.default)(Ne),(0,Ie.default)(Ne),(0,S.default)(Ne),(0,se.default)(Ne)}}},{"./airplayMix":"d8BTB","./aspectRatioMix":"aQNJl","./attrMix":"5DA9e","./autoHeightMix":"1swKn","./autoSizeMix":"lSbiD","./cssVarMix":"32Hp1","./currentTimeMix":"kfZbu","./durationMix":"eV1ag","./eventInit":"f8NQq","./flipMix":"ea3Qm","./fullscreenMix":"ffXE3","./fullscreenWebMix":"8tarF","./loadedMix":"f9syH","./miniMix":"dLuS7","./optionInit":"d1F69","./pauseMix":"kewk9","./pipMix":"4XzDs","./playbackRateMix":"jphfi","./playedMix":"iNpeS","./playingMix":"aBIWL","./playMix":"hRBri","./posterMix":"fgfXC","./qualityMix":"17rUP","./rectMix":"55qzI","./screenshotMix":"bC6TG","./seekMix":"j8GRO","./stateMix":"cn7iR","./subtitleOffsetMix":"2k4nP","./switchMix":"6SU6j","./themeMix":"7iMuh","./thumbnailsMix":"6P0RS","./toggleMix":"eNi78","./typeMix":"7AUBD","./urlMix":"cnlLL","./volumeMix":"iX66j","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d8BTB:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{i18n:n,notice:o,proxy:i,template:{$video:c}}=r,f=!0;window.WebKitPlaybackTargetAvailabilityEvent&&c.webkitShowPlaybackTargetPicker?i(c,"webkitplaybacktargetavailabilitychanged",g=>{switch(g.availability){case"available":f=!0;break;case"not-available":f=!1}}):f=!1,(0,e.def)(r,"airplay",{value(){f?(c.webkitShowPlaybackTargetPicker(),r.emit("airplay")):o.show=n.get("AirPlay Not Available")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aQNJl:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{i18n:n,notice:o,template:{$video:i,$player:c}}=r;(0,e.def)(r,"aspectRatio",{get:()=>c.dataset.aspectRatio||"default",set(f){if(f||(f="default"),f==="default")(0,e.setStyle)(i,"width",null),(0,e.setStyle)(i,"height",null),(0,e.setStyle)(i,"margin",null),delete c.dataset.aspectRatio;else{let g=f.split(":").map(Number),{clientWidth:y,clientHeight:C}=c,A=g[0]/g[1];y/C>A?((0,e.setStyle)(i,"width",`${A*C}px`),(0,e.setStyle)(i,"height","100%"),(0,e.setStyle)(i,"margin","0 auto")):((0,e.setStyle)(i,"width","100%"),(0,e.setStyle)(i,"height",`${y/A}px`),(0,e.setStyle)(i,"margin","auto 0")),c.dataset.aspectRatio=f}o.show=`${n.get("Aspect Ratio")}: ${f==="default"?n.get("Default"):f}`,r.emit("aspectRatio",f)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"5DA9e":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$video:n}}=r;(0,e.def)(r,"attr",{value(o,i){if(i===void 0)return n[o];n[o]=i}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"1swKn":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$container:n,$video:o}}=r;(0,e.def)(r,"autoHeight",{value(){let{clientWidth:i}=n,{videoHeight:c,videoWidth:f}=o,g=i/f*c;(0,e.setStyle)(n,"height",`${g}px`),r.emit("autoHeight",g)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],lSbiD:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{$container:n,$player:o,$video:i}=r.template;(0,e.def)(r,"autoSize",{value(){let{videoWidth:c,videoHeight:f}=i,{width:g,height:y}=(0,e.getRect)(n),C=c/f;g/y>C?((0,e.setStyle)(o,"width",`${y*C/g*100}%`),(0,e.setStyle)(o,"height","100%")):((0,e.setStyle)(o,"width","100%"),(0,e.setStyle)(o,"height",`${g/C/y*100}%`)),r.emit("autoSize",{width:r.width,height:r.height})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"32Hp1":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{$player:n}=r.template;(0,e.def)(r,"cssVar",{value:(o,i)=>i?n.style.setProperty(o,i):getComputedStyle(n).getPropertyValue(o)})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kfZbu:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{$video:n}=r.template;(0,e.def)(r,"currentTime",{get:()=>n.currentTime||0,set:o=>{Number.isNaN(o=Number.parseFloat(o))||(n.currentTime=(0,e.clamp)(o,0,r.duration))}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eV1ag:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"duration",{get:()=>{let{duration:n}=r.template.$video;return n===1/0?0:n||0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f8NQq:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>n);var e=a("../config"),u=t.interopDefault(e),r=a("../utils");function n(o){let{i18n:i,notice:c,option:f,constructor:g,proxy:y,template:{$player:C,$video:A,$poster:H}}=o,w=0;for(let _=0;_<u.default.events.length;_++)y(A,u.default.events[_],M=>{o.emit(`video:${M.type}`,M)});o.on("video:canplay",()=>{w=0,o.loading.show=!1}),o.once("video:canplay",()=>{o.loading.show=!1,o.controls.show=!0,o.mask.show=!0,o.isReady=!0,o.emit("ready")}),o.on("video:ended",()=>{f.loop?(o.seek=0,o.play(),o.controls.show=!1,o.mask.show=!1):(o.controls.show=!0,o.mask.show=!0)}),o.on("video:error",async _=>{w<g.RECONNECT_TIME_MAX?(await(0,r.sleep)(g.RECONNECT_SLEEP_TIME),w+=1,o.url=f.url,c.show=`${i.get("Reconnect")}: ${w}`,o.emit("error",_,w)):(o.mask.show=!0,o.loading.show=!1,o.controls.show=!0,(0,r.addClass)(C,"art-error"),await(0,r.sleep)(g.RECONNECT_SLEEP_TIME),c.show=i.get("Video Load Failed"))}),o.on("video:loadedmetadata",()=>{o.emit("resize"),r.isMobile&&(o.loading.show=!1,o.controls.show=!0,o.mask.show=!0)}),o.on("video:loadstart",()=>{o.loading.show=!0,o.mask.show=!1,o.controls.show=!0}),o.on("video:pause",()=>{o.controls.show=!0,o.mask.show=!0}),o.on("video:play",()=>{o.mask.show=!1,(0,r.setStyle)(H,"display","none")}),o.on("video:playing",()=>{o.mask.show=!1}),o.on("video:progress",()=>{o.playing&&(o.loading.show=!1)}),o.on("video:seeked",()=>{o.loading.show=!1,o.mask.show=!0}),o.on("video:seeking",()=>{o.loading.show=!0,o.mask.show=!1}),o.on("video:timeupdate",()=>{o.mask.show=!1}),o.on("video:waiting",()=>{o.loading.show=!0,o.mask.show=!1})}},{"../config":"eJfh8","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ea3Qm:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$player:n},i18n:o,notice:i}=r;(0,e.def)(r,"flip",{get:()=>n.dataset.flip||"normal",set(c){c||(c="normal"),c==="normal"?delete n.dataset.flip:n.dataset.flip=c,i.show=`${o.get("Video Flip")}: ${o.get((0,e.capitalize)(c))}`,r.emit("flip",c)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ffXE3:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>n);var e=a("../libs/screenfull"),u=t.interopDefault(e),r=a("../utils");function n(o){let{i18n:i,notice:c,template:{$video:f,$player:g}}=o;o.once("video:loadedmetadata",()=>{u.default.isEnabled?(u.default.on("change",()=>{o.emit("fullscreen",u.default.isFullscreen),u.default.isFullscreen?(o.state="fullscreen",(0,r.addClass)(g,"art-fullscreen")):(0,r.removeClass)(g,"art-fullscreen"),o.emit("resize")}),u.default.on("error",y=>{o.emit("fullscreenError",y)}),(0,r.def)(o,"fullscreen",{get:()=>u.default.isFullscreen,async set(y){y?await u.default.request(g):await u.default.exit()}})):f.webkitSupportsFullscreen?(o.on("document:webkitfullscreenchange",()=>{o.emit("fullscreen",o.fullscreen),o.emit("resize")}),(0,r.def)(o,"fullscreen",{get:()=>document.fullscreenElement===f,set(y){y?(o.state="fullscreen",f.webkitEnterFullscreen()):f.webkitExitFullscreen()}})):(0,r.def)(o,"fullscreen",{get:()=>!1,set(){c.show=i.get("Fullscreen Not Supported")}}),(0,r.def)(o,"fullscreen",(0,r.get)(o,"fullscreen"))})}},{"../libs/screenfull":"iSPAQ","../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iSPAQ:[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);let t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],e=(()=>{if(typeof document>"u")return!1;let n=t[0],o={};for(let i of t)if(i[1]in document){for(let[c,f]of i.entries())o[n[c]]=f;return o}return!1})(),u={change:e.fullscreenchange,error:e.fullscreenerror},r={request:(n=document.documentElement,o)=>new Promise((i,c)=>{let f=()=>{r.off("change",f),i()};r.on("change",f);let g=n[e.requestFullscreen](o);g instanceof Promise&&g.then(f).catch(c)}),exit:()=>new Promise((n,o)=>{if(!r.isFullscreen)return void n();let i=()=>{r.off("change",i),n()};r.on("change",i);let c=document[e.exitFullscreen]();c instanceof Promise&&c.then(i).catch(o)}),toggle:(n,o)=>r.isFullscreen?r.exit():r.request(n,o),onchange(n){r.on("change",n)},onerror(n){r.on("error",n)},on(n,o){let i=u[n];i&&document.addEventListener(i,o,!1)},off(n,o){let i=u[n];i&&document.removeEventListener(i,o,!1)},raw:e};Object.defineProperties(r,{isFullscreen:{get:()=>!!document[e.fullscreenElement]},element:{enumerable:!0,get:()=>document[e.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>!!document[e.fullscreenEnabled]}}),s.default=r},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"8tarF":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{constructor:n,template:{$container:o,$player:i}}=r,c="";(0,e.def)(r,"fullscreenWeb",{get:()=>(0,e.hasClass)(i,"art-fullscreen-web"),set(f){f?(c=i.style.cssText,n.FULLSCREEN_WEB_IN_BODY&&(0,e.append)(document.body,i),r.state="fullscreenWeb",(0,e.setStyle)(i,"width","100%"),(0,e.setStyle)(i,"height","100%"),(0,e.addClass)(i,"art-fullscreen-web"),r.emit("fullscreenWeb",!0)):(n.FULLSCREEN_WEB_IN_BODY&&(0,e.append)(o,i),c&&(i.style.cssText=c,c=""),(0,e.removeClass)(i,"art-fullscreen-web"),r.emit("fullscreenWeb",!1)),r.emit("resize")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],f9syH:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{$video:n}=r.template;(0,e.def)(r,"loaded",{get:()=>r.loadedTime/n.duration}),(0,e.def)(r,"loadedTime",{get:()=>n.buffered.length?n.buffered.end(n.buffered.length-1):0})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],dLuS7:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{icons:n,proxy:o,storage:i,template:{$player:c,$video:f}}=r,g=!1,y=0,C=0;function A(){let{$mini:_}=r.template;_&&((0,e.removeClass)(c,"art-mini"),(0,e.setStyle)(_,"display","none"),c.prepend(f),r.emit("mini",!1))}function H(_,M){r.playing?((0,e.setStyle)(_,"display","none"),(0,e.setStyle)(M,"display","flex")):((0,e.setStyle)(_,"display","flex"),(0,e.setStyle)(M,"display","none"))}function w(){let{$mini:_}=r.template,M=(0,e.getRect)(_),$=window.innerHeight-M.height-50,S=window.innerWidth-M.width-50;i.set("top",$),i.set("left",S),(0,e.setStyle)(_,"top",`${$}px`),(0,e.setStyle)(_,"left",`${S}px`)}(0,e.def)(r,"mini",{get:()=>(0,e.hasClass)(c,"art-mini"),set(_){if(_){r.state="mini",(0,e.addClass)(c,"art-mini");let M=function(){let{$mini:P}=r.template;if(P)return(0,e.append)(P,f),(0,e.setStyle)(P,"display","flex");{let J=(0,e.createElement)("div");(0,e.addClass)(J,"art-mini-popup"),(0,e.append)(document.body,J),r.template.$mini=J,(0,e.append)(J,f);let oe=(0,e.append)(J,'<div class="art-mini-close"></div>');(0,e.append)(oe,n.close),o(oe,"click",A);let me=(0,e.append)(J,'<div class="art-mini-state"></div>'),Se=(0,e.append)(me,n.play),je=(0,e.append)(me,n.pause);return o(Se,"click",()=>r.play()),o(je,"click",()=>r.pause()),H(Se,je),r.on("video:playing",()=>H(Se,je)),r.on("video:pause",()=>H(Se,je)),r.on("video:timeupdate",()=>H(Se,je)),o(J,"mousedown",T=>{g=T.button===0,y=T.pageX,C=T.pageY}),r.on("document:mousemove",T=>{if(g){(0,e.addClass)(J,"art-mini-dragging");let V=T.pageX-y,Y=T.pageY-C;(0,e.setStyle)(J,"transform",`translate(${V}px, ${Y}px)`)}}),r.on("document:mouseup",()=>{if(g){g=!1,(0,e.removeClass)(J,"art-mini-dragging");let T=(0,e.getRect)(J);i.set("left",T.left),i.set("top",T.top),(0,e.setStyle)(J,"left",`${T.left}px`),(0,e.setStyle)(J,"top",`${T.top}px`),(0,e.setStyle)(J,"transform",null)}}),J}}(),$=i.get("top"),S=i.get("left");typeof $=="number"&&typeof S=="number"?((0,e.setStyle)(M,"top",`${$}px`),(0,e.setStyle)(M,"left",`${S}px`),(0,e.isInViewport)(M)||w()):w(),r.emit("mini",!0)}else A()}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d1F69:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{option:n,storage:o,template:{$video:i,$poster:c}}=r;for(let g in n.moreVideoAttr)r.attr(g,n.moreVideoAttr[g]);n.muted&&(r.muted=n.muted),n.volume&&(i.volume=(0,e.clamp)(n.volume,0,1));let f=o.get("volume");for(let g in typeof f=="number"&&(i.volume=(0,e.clamp)(f,0,1)),n.poster&&(0,e.setStyle)(c,"backgroundImage",`url(${n.poster})`),n.autoplay&&(i.autoplay=n.autoplay),n.playsInline&&(i.playsInline=!0,i["webkit-playsinline"]=!0),n.theme&&(n.cssVar["--art-theme"]=n.theme),n.cssVar)r.cssVar(g,n.cssVar[g]);r.url=n.url}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kewk9:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$video:n},i18n:o,notice:i}=r;(0,e.def)(r,"pause",{value(){let c=n.pause();return i.show=o.get("Pause"),r.emit("pause"),c}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4XzDs":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{i18n:n,notice:o,template:{$video:i}}=r;if(document.pictureInPictureEnabled){let{template:{$video:c},proxy:f,notice:g}=r;c.disablePictureInPicture=!1,(0,e.def)(r,"pip",{get:()=>document.pictureInPictureElement,set(y){y?(r.state="pip",c.requestPictureInPicture().catch(C=>{throw g.show=C,C})):document.exitPictureInPicture().catch(C=>{throw g.show=C,C})}}),f(c,"enterpictureinpicture",()=>{r.emit("pip",!0)}),f(c,"leavepictureinpicture",()=>{r.emit("pip",!1)})}else if(i.webkitSupportsPresentationMode){let{$video:c}=r.template;c.webkitSetPresentationMode("inline"),(0,e.def)(r,"pip",{get:()=>c.webkitPresentationMode==="picture-in-picture",set(f){f?(r.state="pip",c.webkitSetPresentationMode("picture-in-picture"),r.emit("pip",!0)):(c.webkitSetPresentationMode("inline"),r.emit("pip",!1))}})}else(0,e.def)(r,"pip",{get:()=>!1,set(){o.show=n.get("PIP Not Supported")}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jphfi:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$video:n},i18n:o,notice:i}=r;(0,e.def)(r,"playbackRate",{get:()=>n.playbackRate,set(c){c?c!==n.playbackRate&&(n.playbackRate=c,i.show=`${o.get("Rate")}: ${c===1?o.get("Normal"):`${c}x`}`):r.playbackRate=1}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iNpeS:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"played",{get:()=>r.currentTime/r.duration})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],aBIWL:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{$video:n}=r.template;(0,e.def)(r,"playing",{get:()=>typeof n.playing=="boolean"?n.playing:n.currentTime>0&&!n.paused&&!n.ended&&n.readyState>2})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],hRBri:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{i18n:n,notice:o,option:i,constructor:{instances:c},template:{$video:f}}=r;(0,e.def)(r,"play",{async value(){let g=await f.play();if(o.show=n.get("Play"),r.emit("play"),i.mutex)for(let y=0;y<c.length;y++){let C=c[y];C!==r&&C.pause()}return g}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fgfXC:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$poster:n}}=r;(0,e.def)(r,"poster",{get:()=>{try{return n.style.backgroundImage.match(/"(.*)"/)[1]}catch{return""}},set(o){(0,e.setStyle)(n,"backgroundImage",`url(${o})`)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"17rUP":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"quality",{set(n){let{controls:o,notice:i,i18n:c}=r,f=n.find(g=>g.default)||n[0];o.update({name:"quality",position:"right",index:10,style:{marginRight:"10px"},html:(f==null?void 0:f.html)||"",selector:n,onSelect:async g=>(await r.switchQuality(g.url),i.show=`${c.get("Switch Video")}: ${g.html}`,g.html)})}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"55qzI":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"rect",{get:()=>(0,e.getRect)(r.template.$player)});let n=["bottom","height","left","right","top","width"];for(let o=0;o<n.length;o++){let i=n[o];(0,e.def)(r,i,{get:()=>r.rect[i]})}(0,e.def)(r,"x",{get:()=>r.left+window.pageXOffset}),(0,e.def)(r,"y",{get:()=>r.top+window.pageYOffset})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bC6TG:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{notice:n,template:{$video:o}}=r,i=(0,e.createElement)("canvas");(0,e.def)(r,"getDataURL",{value:()=>new Promise((c,f)=>{try{i.width=o.videoWidth,i.height=o.videoHeight,i.getContext("2d").drawImage(o,0,0),c(i.toDataURL("image/png"))}catch(g){n.show=g,f(g)}})}),(0,e.def)(r,"getBlobUrl",{value:()=>new Promise((c,f)=>{try{i.width=o.videoWidth,i.height=o.videoHeight,i.getContext("2d").drawImage(o,0,0),i.toBlob(g=>{c(URL.createObjectURL(g))})}catch(g){n.show=g,f(g)}})}),(0,e.def)(r,"screenshot",{value:async c=>{let f=await r.getDataURL(),g=c||`artplayer_${(0,e.secondToTime)(o.currentTime)}`;return(0,e.download)(f,`${g}.png`),r.emit("screenshot",f),f}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],j8GRO:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{notice:n}=r;(0,e.def)(r,"seek",{set(o){r.currentTime=o,r.duration&&(n.show=`${(0,e.secondToTime)(r.currentTime)} / ${(0,e.secondToTime)(r.duration)}`),r.emit("seek",r.currentTime)}}),(0,e.def)(r,"forward",{set(o){r.seek=r.currentTime+o}}),(0,e.def)(r,"backward",{set(o){r.seek=r.currentTime-o}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cn7iR:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let n=["mini","pip","fullscreen","fullscreenWeb"];(0,e.def)(r,"state",{get:()=>n.find(o=>r[o])||"standard",set(o){for(let i=0;i<n.length;i++){let c=n[i];c!==o&&r[c]&&(r[c]=!1)}}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"2k4nP":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{notice:n,i18n:o,template:i}=r;(0,e.def)(r,"subtitleOffset",{get:()=>{var c;return((c=i.$track)==null?void 0:c.offset)||0},set(c){let{cues:f}=r.subtitle;if(!i.$track||f.length===0)return;let g=(0,e.clamp)(c,-10,10);i.$track.offset=g;for(let y=0;y<f.length;y++){let C=f[y];C.originalStartTime=C.originalStartTime??C.startTime,C.originalEndTime=C.originalEndTime??C.endTime,C.startTime=(0,e.clamp)(C.originalStartTime+g,0,r.duration),C.endTime=(0,e.clamp)(C.originalEndTime+g,0,r.duration)}r.subtitle.update(),n.show=`${o.get("Subtitle Offset")}: ${c}s`,r.emit("subtitleOffset",c)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6SU6j":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){function n(o,i){return new Promise((c,f)=>{if(o===r.url)return;let{playing:g,aspectRatio:y,playbackRate:C}=r;r.pause(),r.url=o,r.notice.show="",r.once("video:error",f),r.once("video:loadedmetadata",()=>{r.currentTime=i}),r.once("video:canplay",async()=>{r.playbackRate=C,r.aspectRatio=y,g&&await r.play(),r.notice.show="",c()})})}(0,e.def)(r,"switchQuality",{value:o=>n(o,r.currentTime)}),(0,e.def)(r,"switchUrl",{value:o=>n(o,0)}),(0,e.def)(r,"switch",{set:r.switchUrl})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7iMuh":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"theme",{get:()=>r.cssVar("--art-theme"),set(n){r.cssVar("--art-theme",n)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"6P0RS":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{events:n,option:o,template:{$progress:i,$video:c}}=r,f=null,g=null,y=!1,C=!1,A=!1;n.hover(i,()=>{A=!0},()=>{A=!1}),r.on("setBar",async(H,w,_)=>{var J;let M=(J=r.controls)==null?void 0:J.thumbnails,{url:$,scale:S}=o.thumbnails;if(!M||!$)return;let P=H==="played"&&_&&e.isMobile;if(H==="hover"||P){if(y||(y=!0,g=await(0,e.loadImg)($,S),C=!0),!C||!A)return;let oe=i.clientWidth*w;(0,e.setStyle)(M,"display","flex"),oe>0&&oe<i.clientWidth?function(me){var K;let Se=(K=r.controls)==null?void 0:K.thumbnails;if(!Se)return;let{number:je,column:T,width:V,height:Y,scale:_e}=o.thumbnails,Pe=V*_e||g.naturalWidth/T,se=Y*_e||Pe/(c.videoWidth/c.videoHeight),de=Math.floor(me/(i.clientWidth/je)),Me=Math.ceil(de/T)-1;(0,e.setStyle)(Se,"backgroundImage",`url(${g.src})`),(0,e.setStyle)(Se,"height",`${se}px`),(0,e.setStyle)(Se,"width",`${Pe}px`),(0,e.setStyle)(Se,"backgroundPosition",`-${(de%T||T-1)*Pe}px -${Me*se}px`),me<=Pe/2?(0,e.setStyle)(Se,"left",0):me>i.clientWidth-Pe/2?(0,e.setStyle)(Se,"left",`${i.clientWidth-Pe}px`):(0,e.setStyle)(Se,"left",`${me-Pe/2}px`)}(oe):e.isMobile||(0,e.setStyle)(M,"display","none"),P&&(clearTimeout(f),f=setTimeout(()=>{(0,e.setStyle)(M,"display","none")},500))}}),(0,e.def)(r,"thumbnails",{get:()=>r.option.thumbnails,set(H){H.url&&!r.option.isLive&&(r.option.thumbnails=H,clearTimeout(f),f=null,g=null,y=!1,C=!1)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eNi78:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"toggle",{value:()=>r.playing?r.pause():r.play()})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"7AUBD":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){(0,e.def)(r,"type",{get:()=>r.option.type,set(n){r.option.type=n}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cnlLL:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{option:n,template:{$video:o}}=r;(0,e.def)(r,"url",{get:()=>o.src,async set(i){if(i){let c=r.url,f=n.type||(0,e.getExt)(i),g=n.customType[f];f&&g?(await(0,e.sleep)(),r.loading.show=!0,g.call(r,o,i,r)):(URL.revokeObjectURL(c),o.src=i),c!==r.url&&(r.option.url=i,r.isReady&&c&&r.once("video:canplay",()=>{r.emit("restart",i)}))}else await(0,e.sleep)(),r.loading.show=!0}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],iX66j:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{template:{$video:n},i18n:o,notice:i,storage:c}=r;(0,e.def)(r,"volume",{get:()=>n.volume||0,set:f=>{n.volume=(0,e.clamp)(f,0,1),i.show=`${o.get("Volume")}: ${Number.parseInt(100*n.volume,10)}`,n.volume!==0&&c.set("volume",n.volume)}}),(0,e.def)(r,"muted",{get:()=>n.muted,set:f=>{n.muted=f,r.emit("muted",f)}})}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cjxJL:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("../utils"),u=a("./autoOrientation"),r=t.interopDefault(u),n=a("./autoPlayback"),o=t.interopDefault(n),i=a("./fastForward"),c=t.interopDefault(i),f=a("./lock"),g=t.interopDefault(f),y=a("./miniProgressBar"),C=t.interopDefault(y);s.default=class{constructor(A){this.art=A,this.id=0;let{option:H}=A;H.miniProgressBar&&!H.isLive&&this.add(C.default),H.lock&&e.isMobile&&this.add(g.default),H.autoPlayback&&!H.isLive&&this.add(o.default),H.autoOrientation&&e.isMobile&&this.add(r.default),H.fastForward&&e.isMobile&&!H.isLive&&this.add(c.default);for(let w=0;w<H.plugins.length;w++)this.add(H.plugins[w])}add(A){this.id+=1;let H=A.call(this.art,this.art);return H instanceof Promise?H.then(w=>this.next(A,w)):this.next(A,H)}next(A,H){let w=H&&H.name||A.name||`plugin${this.id}`;return(0,e.errorHandle)(!(0,e.has)(this,w),`Cannot add a plugin that already has the same name: ${w}`),(0,e.def)(this,w,{value:H}),this}}},{"../utils":"aBlEo","./autoOrientation":"jb9jb","./autoPlayback":"21HWM","./fastForward":"4sxBO","./lock":"fjy9V","./miniProgressBar":"d0xRp","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],jb9jb:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{notice:n,constructor:o,template:{$player:i,$video:c}}=r,f="art-auto-orientation",g="art-auto-orientation-fullscreen",y=!1;function C(){let{videoWidth:A,videoHeight:H}=c,w=document.documentElement.clientWidth,_=document.documentElement.clientHeight;return A>H&&w<_||A<H&&w>_}return r.on("fullscreenWeb",A=>{A?C()&&setTimeout(()=>{r.fullscreenWeb&&!(0,e.hasClass)(i,f)&&function(){let H=document.documentElement.clientWidth,w=document.documentElement.clientHeight;(0,e.setStyle)(i,"width",`${w}px`),(0,e.setStyle)(i,"height",`${H}px`),(0,e.setStyle)(i,"transform-origin","0 0"),(0,e.setStyle)(i,"transform",`rotate(90deg) translate(0, -${H}px)`),(0,e.addClass)(i,f),r.isRotate=!0,r.emit("resize")}()},Number(o.AUTO_ORIENTATION_TIME??0)):(0,e.hasClass)(i,f)&&((0,e.setStyle)(i,"width",""),(0,e.setStyle)(i,"height",""),(0,e.setStyle)(i,"transform-origin",""),(0,e.setStyle)(i,"transform",""),(0,e.removeClass)(i,f),r.isRotate=!1,r.emit("resize"))}),r.on("fullscreen",async A=>{var w;let H=!!((w=screen==null?void 0:screen.orientation)!=null&&w.lock);if(A){if(H&&C())try{let _=screen.orientation.type.startsWith("portrait")?"landscape":"portrait";await screen.orientation.lock(_),y=!0,(0,e.addClass)(i,g)}catch(_){y=!1,n.show=_}}else if((0,e.hasClass)(i,g)&&(0,e.removeClass)(i,g),H&&y){try{screen.orientation.unlock()}catch{}y=!1}}),{name:"autoOrientation",get state(){return(0,e.hasClass)(i,f)}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"21HWM":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{i18n:n,icons:o,storage:i,constructor:c,proxy:f,template:{$poster:g}}=r,y=r.layers.add({name:"auto-playback",html:'<div class="art-auto-playback-close"></div><div class="art-auto-playback-last"></div><div class="art-auto-playback-jump"></div>'}),C=(0,e.query)(".art-auto-playback-last",y),A=(0,e.query)(".art-auto-playback-jump",y),H=(0,e.query)(".art-auto-playback-close",y);(0,e.append)(H,o.close);let w=null;function _(){let M=(i.get("times")||{})[r.option.id||r.option.url];clearTimeout(w),(0,e.setStyle)(y,"display","none"),M&&M>=c.AUTO_PLAYBACK_MIN&&((0,e.setStyle)(y,"display","flex"),C.textContent=`${n.get("Last Seen")} ${(0,e.secondToTime)(M)}`,A.textContent=n.get("Jump Play"),f(H,"click",()=>{(0,e.setStyle)(y,"display","none")}),f(A,"click",()=>{r.seek=M,r.play(),(0,e.setStyle)(g,"display","none"),(0,e.setStyle)(y,"display","none")}),r.once("video:timeupdate",()=>{w=setTimeout(()=>{(0,e.setStyle)(y,"display","none")},c.AUTO_PLAYBACK_TIMEOUT)}))}return r.on("video:timeupdate",()=>{if(r.playing){let M=i.get("times")||{},$=Object.keys(M);$.length>c.AUTO_PLAYBACK_MAX&&delete M[$[0]],M[r.option.id||r.option.url]=r.currentTime,i.set("times",M)}}),r.on("ready",_),r.on("restart",_),{name:"auto-playback",get times(){return i.get("times")||{}},clear:()=>i.del("times"),delete(M){let $=i.get("times")||{};return delete $[M],i.set("times",$),$}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4sxBO":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{constructor:n,proxy:o,template:{$player:i,$video:c}}=r,f=null,g=!1,y=1,C=()=>{clearTimeout(f),g&&(g=!1,r.playbackRate=y,(0,e.removeClass)(i,"art-fast-forward"))};return o(c,"touchstart",A=>{A.touches.length===1&&r.playing&&!r.isLock&&(f=setTimeout(()=>{g=!0,y=r.playbackRate,r.playbackRate=n.FAST_FORWARD_VALUE,(0,e.addClass)(i,"art-fast-forward")},n.FAST_FORWARD_TIME))}),r.on("document:touchmove",C),r.on("document:touchend",C),{name:"fastForward",get state(){return(0,e.hasClass)(i,"art-fast-forward")}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fjy9V:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{layers:n,icons:o,template:{$player:i}}=r;function c(){return(0,e.hasClass)(i,"art-lock")}function f(){(0,e.addClass)(i,"art-lock"),r.isLock=!0,r.emit("lock",!0)}function g(){(0,e.removeClass)(i,"art-lock"),r.isLock=!1,r.emit("lock",!1)}return n.add({name:"lock",mounted(y){let C=(0,e.append)(y,o.lock),A=(0,e.append)(y,o.unlock);(0,e.setStyle)(C,"display","none"),r.on("lock",H=>{H?((0,e.setStyle)(C,"display","inline-flex"),(0,e.setStyle)(A,"display","none")):((0,e.setStyle)(C,"display","none"),(0,e.setStyle)(A,"display","inline-flex"))})},click(){c()?g():f()}}),{name:"lock",get state(){return c()},set state(y){y?f():g()}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],d0xRp:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){return r.on("control",n=>{n?(0,e.removeClass)(r.template.$player,"art-mini-progress-bar"):(0,e.addClass)(r.template.$player,"art-mini-progress-bar")}),{name:"mini-progress-bar"}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],bwLGT:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("../utils"),u=a("../utils/component"),r=t.interopDefault(u),n=a("./aspectRatio"),o=t.interopDefault(n),i=a("./flip"),c=t.interopDefault(i),f=a("./playbackRate"),g=t.interopDefault(f),y=a("./subtitleOffset"),C=t.interopDefault(y);class A extends r.default{constructor(w){super(w);let{option:_,controls:M,template:{$setting:$}}=w;this.name="setting",this.$parent=$,this.id=0,this.active=null,this.cache=new Map,this.option=[...this.builtin,..._.settings],_.setting&&(this.format(),this.render(),w.on("blur",()=>{this.show&&(this.show=!1,this.render())}),w.on("focus",S=>{let P=(0,e.includeFromEvent)(S,M.setting),J=(0,e.includeFromEvent)(S,this.$parent);!this.show||P||J||(this.show=!1,this.render())}),w.on("resize",()=>this.resize()))}get builtin(){let w=[],{option:_}=this.art;return _.playbackRate&&w.push((0,g.default)(this.art)),_.aspectRatio&&w.push((0,o.default)(this.art)),_.flip&&w.push((0,c.default)(this.art)),_.subtitleOffset&&w.push((0,C.default)(this.art)),w}traverse(w,_=this.option){var M;for(let $=0;$<_.length;$++){let S=_[$];w(S),(M=S.selector)!=null&&M.length&&this.traverse(w,S.selector)}}check(w){w.$parent.tooltip=w.html,this.traverse(_=>{_.default=_===w,_.default&&_.$item&&(0,e.inverseClass)(_.$item,"art-current")},w.$option),this.render(w.$parents)}format(w=this.option,_,M,$=[]){for(let S=0;S<w.length;S++){let P=w[S];if(P!=null&&P.name?((0,e.errorHandle)(!$.includes(P.name),`The [${P.name}] already exists in [setting]`),$.push(P.name)):P.name=`setting-${this.id++}`,!P.$formatted){(0,e.def)(P,"$parent",{get:()=>_}),(0,e.def)(P,"$parents",{get:()=>M}),(0,e.def)(P,"$option",{get:()=>w});let J=[];(0,e.def)(P,"$events",{get:()=>J}),(0,e.def)(P,"$formatted",{get:()=>!0})}this.format(P.selector||[],P,w,$)}this.option=w}find(w=""){let _=null;return this.traverse(M=>{M.name===w&&(_=M)}),_}resize(){var P,J;let{controls:w,constructor:{SETTING_WIDTH:_,SETTING_ITEM_HEIGHT:M},template:{$player:$,$setting:S}}=this.art;if(w.setting&&this.show){let oe=((J=(P=this.active[0])==null?void 0:P.$parent)==null?void 0:J.width)||_,{left:me,width:Se}=(0,e.getRect)(w.setting),{left:je,width:T}=(0,e.getRect)($),V=me-je+Se/2-oe/2,Y=this.active===this.option?this.active.length*M:(this.active.length+1)*M;if((0,e.setStyle)(S,"height",`${Y}px`),(0,e.setStyle)(S,"width",`${oe}px`),this.art.isRotate||e.isMobile)return;V+oe>T?((0,e.setStyle)(S,"left",null),(0,e.setStyle)(S,"right",null)):((0,e.setStyle)(S,"left",`${V}px`),(0,e.setStyle)(S,"right","auto"))}}inactivate(w){for(let _=0;_<w.$events.length;_++)this.art.events.remove(w.$events[_]);w.$events.length=0}remove(w){let _=this.find(w);(0,e.errorHandle)(_,`Can't find [${w}] in the [setting]`);let M=_.$option.indexOf(_);_.$option.splice(M,1),this.inactivate(_),_.$item&&(0,e.remove)(_.$item),this.render()}update(w){let _=this.find(w.name);return _?(this.inactivate(_),Object.assign(_,w),this.format(),this.createItem(_,!0),this.render(),_):this.add(w)}add(w,_=this.option){return _.push(w),this.format(),this.createItem(w),this.render(),w}createHeader(w){if(!this.cache.has(w.$option))return;let _=this.cache.get(w.$option),{proxy:M,icons:{arrowLeft:$},constructor:{SETTING_ITEM_HEIGHT:S}}=this.art,P=(0,e.createElement)("div");(0,e.setStyle)(P,"height",`${S}px`),(0,e.addClass)(P,"art-setting-item"),(0,e.addClass)(P,"art-setting-item-back");let J=(0,e.append)(P,'<div class="art-setting-item-left"></div>'),oe=(0,e.createElement)("div");(0,e.addClass)(oe,"art-setting-item-left-icon"),(0,e.append)(oe,$),(0,e.append)(J,oe),(0,e.append)(J,w.$parent.html);let me=M(P,"click",()=>this.render(w.$parents));w.$parent.$events.push(me),(0,e.append)(_,P)}createItem(w,_=!1){var _e,Pe;if(!this.cache.has(w.$option))return;let M=this.cache.get(w.$option),$=w.$item,S="selector";(0,e.has)(w,"switch")&&(S="switch"),(0,e.has)(w,"range")&&(S="range"),(0,e.has)(w,"onClick")&&(S="button");let{icons:P,proxy:J,constructor:oe}=this.art,me=(0,e.createElement)("div");(0,e.addClass)(me,"art-setting-item"),(0,e.setStyle)(me,"height",`${oe.SETTING_ITEM_HEIGHT}px`),me.dataset.name=w.name||"",me.dataset.value=w.value||"";let Se=(0,e.append)(me,'<div class="art-setting-item-left"></div>'),je=(0,e.append)(me,'<div class="art-setting-item-right"></div>'),T=(0,e.createElement)("div");switch((0,e.addClass)(T,"art-setting-item-left-icon"),S){case"button":case"switch":case"range":(0,e.append)(T,w.icon||P.config);break;case"selector":(_e=w.selector)!=null&&_e.length?(0,e.append)(T,w.icon||P.config):(0,e.append)(T,P.check)}(0,e.append)(Se,T),(0,e.def)(w,"$icon",{configurable:!0,get:()=>T}),(0,e.def)(w,"icon",{configurable:!0,get:()=>T.innerHTML,set(se){T.innerHTML="",(0,e.append)(T,se)}});let V=(0,e.createElement)("div");(0,e.addClass)(V,"art-setting-item-left-text"),(0,e.append)(V,w.html||""),(0,e.append)(Se,V),(0,e.def)(w,"$html",{configurable:!0,get:()=>V}),(0,e.def)(w,"html",{configurable:!0,get:()=>V.innerHTML,set(se){V.innerHTML="",(0,e.append)(V,se)}});let Y=(0,e.createElement)("div");switch((0,e.addClass)(Y,"art-setting-item-right-tooltip"),(0,e.append)(Y,w.tooltip||""),(0,e.append)(je,Y),(0,e.def)(w,"$tooltip",{configurable:!0,get:()=>Y}),(0,e.def)(w,"tooltip",{configurable:!0,get:()=>Y.innerHTML,set(se){Y.innerHTML="",(0,e.append)(Y,se)}}),S){case"switch":{let se=(0,e.createElement)("div");(0,e.addClass)(se,"art-setting-item-right-icon");let de=(0,e.append)(se,P.switchOn),Me=(0,e.append)(se,P.switchOff);(0,e.setStyle)(w.switch?Me:de,"display","none"),(0,e.append)(je,se),(0,e.def)(w,"$switch",{configurable:!0,get:()=>se});let K=w.switch;(0,e.def)(w,"switch",{configurable:!0,get:()=>K,set(ke){K=ke,ke?((0,e.setStyle)(Me,"display","none"),(0,e.setStyle)(de,"display",null)):((0,e.setStyle)(Me,"display",null),(0,e.setStyle)(de,"display","none"))}});break}case"range":{let se=(0,e.createElement)("div");(0,e.addClass)(se,"art-setting-item-right-icon");let de=(0,e.append)(se,'<input type="range">');de.value=w.range[0],de.min=w.range[1],de.max=w.range[2],de.step=w.range[3],(0,e.addClass)(de,"art-setting-range"),(0,e.append)(je,se),(0,e.def)(w,"$range",{configurable:!0,get:()=>de});let Me=[...w.range];(0,e.def)(w,"range",{configurable:!0,get:()=>Me,set(K){Me=[...K],de.value=K[0],de.min=K[1],de.max=K[2],de.step=K[3]}})}break;case"selector":if((Pe=w.selector)!=null&&Pe.length){let se=(0,e.createElement)("div");(0,e.addClass)(se,"art-setting-item-right-icon"),(0,e.append)(se,P.arrowRight),(0,e.append)(je,se)}}switch(S){case"switch":if(w.onSwitch){let se=J(me,"click",async de=>{w.switch=await w.onSwitch.call(this.art,w,me,de)});w.$events.push(se)}break;case"range":if(w.$range){if(w.onRange){let se=J(w.$range,"change",async de=>{w.range[0]=w.$range.valueAsNumber,w.tooltip=await w.onRange.call(this.art,w,me,de)});w.$events.push(se)}if(w.onChange){let se=J(w.$range,"input",async de=>{w.range[0]=w.$range.valueAsNumber,w.tooltip=await w.onChange.call(this.art,w,me,de)});w.$events.push(se)}}break;case"selector":{let se=J(me,"click",async de=>{var Me;(Me=w.selector)!=null&&Me.length?this.render(w.selector):(this.check(w),w.$parent.onSelect&&(w.$parent.tooltip=await w.$parent.onSelect.call(this.art,w,me,de)))});w.$events.push(se),w.default&&(0,e.addClass)(me,"art-current")}break;case"button":if(w.onClick){let se=J(me,"click",async de=>{w.tooltip=await w.onClick.call(this.art,w,me,de)});w.$events.push(se)}}(0,e.def)(w,"$item",{configurable:!0,get:()=>me}),_?(0,e.replaceElement)(me,$):(0,e.append)(M,me),w.mounted&&setTimeout(()=>w.mounted.call(this.art,w.$item,w),0)}render(w=this.option){var _;if(this.active=w,this.cache.has(w)){let M=this.cache.get(w);(0,e.inverseClass)(M,"art-current")}else{let M=(0,e.createElement)("div");this.cache.set(w,M),(0,e.addClass)(M,"art-setting-panel"),(0,e.append)(this.$parent,M),(0,e.inverseClass)(M,"art-current"),(_=w[0])!=null&&_.$parent&&this.createHeader(w[0]);for(let $=0;$<w.length;$++)this.createItem(w[$])}this.resize()}}s.default=A},{"../utils":"aBlEo","../utils/component":"idCEj","./aspectRatio":"cb8VK","./flip":"ljJTO","./playbackRate":"3QcSQ","./subtitleOffset":"eB5hg","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],cb8VK:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u){let{i18n:r,icons:n,constructor:{SETTING_ITEM_WIDTH:o,ASPECT_RATIO:i}}=u;function c(g){return g==="default"?r.get("Default"):g}function f(){let g=u.setting.find(`aspect-ratio-${u.aspectRatio}`);u.setting.check(g)}return{width:o,name:"aspect-ratio",html:r.get("Aspect Ratio"),icon:n.aspectRatio,tooltip:c(u.aspectRatio),selector:i.map(g=>({value:g,name:`aspect-ratio-${g}`,default:g===u.aspectRatio,html:c(g)})),onSelect:g=>(u.aspectRatio=g.value,g.html),mounted:()=>{f(),u.on("aspectRatio",()=>f())}}}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],ljJTO:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s),t.export(s,"default",()=>u);var e=a("../utils");function u(r){let{i18n:n,icons:o,constructor:{SETTING_ITEM_WIDTH:i,FLIP:c}}=r;function f(y){return n.get((0,e.capitalize)(y))}function g(){let y=r.setting.find(`flip-${r.flip}`);r.setting.check(y)}return{width:i,name:"flip",html:n.get("Video Flip"),tooltip:f(r.flip),icon:o.flip,selector:c.map(y=>({value:y,name:`flip-${y}`,default:y===r.flip,html:f(y)})),onSelect:y=>(r.flip=y.value,y.html),mounted:()=>{g(),r.on("flip",()=>g())}}}},{"../utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"3QcSQ":[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u){let{i18n:r,icons:n,constructor:{SETTING_ITEM_WIDTH:o,PLAYBACK_RATE:i}}=u;function c(g){return g===1?r.get("Normal"):g.toFixed(1)}function f(){let g=u.setting.find(`playback-rate-${u.playbackRate}`);u.setting.check(g)}return{width:o,name:"playback-rate",html:r.get("Play Speed"),tooltip:c(u.playbackRate),icon:n.playbackRate,selector:i.map(g=>({value:g,name:`playback-rate-${g}`,default:g===u.playbackRate,html:c(g)})),onSelect:g=>(u.playbackRate=g.value,g.html),mounted:()=>{f(),u.on("video:ratechange",()=>f())}}}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],eB5hg:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");function e(u){let{i18n:r,icons:n,constructor:o}=u;return{width:o.SETTING_ITEM_WIDTH,name:"subtitle-offset",html:r.get("Subtitle Offset"),icon:n.subtitle,tooltip:"0s",range:[0,-10,10,.1],onChange:i=>(u.subtitleOffset=i.range[0],`${i.range[0]}s`),mounted:(i,c)=>{u.on("subtitleOffset",f=>{c.$range.value=f,c.tooltip=`${f}s`})}}}t.defineInteropFlag(s),t.export(s,"default",()=>e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],kwqbK:[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s),s.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(t){try{let e=JSON.parse(window.localStorage.getItem(this.name))||{};return t?e[t]:e}catch{return t?this.settings[t]:this.settings}}set(t,e){try{let u=Object.assign({},this.get(),{[t]:e});window.localStorage.setItem(this.name,JSON.stringify(u))}catch{this.settings[t]=e}}del(t){try{let e=this.get();delete e[t],window.localStorage.setItem(this.name,JSON.stringify(e))}catch{delete this.settings[t]}}clear(){try{window.localStorage.removeItem(this.name)}catch{this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],k5613:[function(a,p,s,x){var t=a("@parcel/transformer-js/src/esmodule-helpers.js");t.defineInteropFlag(s);var e=a("option-validator"),u=t.interopDefault(e),r=a("./scheme"),n=t.interopDefault(r),o=a("./utils"),i=a("./utils/component"),c=t.interopDefault(i);class f extends c.default{constructor(y){super(y),this.name="subtitle",this.option=null,this.destroyEvent=()=>null,this.init(y.option.subtitle);let C=!1;y.on("video:timeupdate",()=>{if(!this.url)return;let A=this.art.template.$video.webkitDisplayingFullscreen;typeof A=="boolean"&&A!==C&&(C=A,this.createTrack(A?"subtitles":"metadata",this.url))})}get url(){return this.art.template.$track.src}set url(y){this.switch(y)}get textTrack(){var y,C;return(C=(y=this.art.template.$video)==null?void 0:y.textTracks)==null?void 0:C[0]}get activeCues(){return this.textTrack?Array.from(this.textTrack.activeCues):[]}get cues(){return this.textTrack?Array.from(this.textTrack.cues):[]}style(y,C){let{$subtitle:A}=this.art.template;return typeof y=="object"?(0,o.setStyles)(A,y):(0,o.setStyle)(A,y,C)}update(){let{option:{subtitle:y},template:{$subtitle:C}}=this.art;C.innerHTML="",this.activeCues.length&&(this.art.emit("subtitleBeforeUpdate",this.activeCues),C.innerHTML=this.activeCues.map((A,H)=>A.text.split(/\r?\n/).filter(w=>w.trim()).map(w=>`<div class="art-subtitle-line" data-group="${H}">${y.escape?(0,o.escape)(w):w}</div>`).join("")).join(""),this.art.emit("subtitleAfterUpdate",this.activeCues))}async switch(y,C={}){let{i18n:A,notice:H,option:w}=this.art,_={...w.subtitle,...C,url:y},M=await this.init(_);return C.name&&(H.show=`${A.get("Switch Subtitle")}: ${C.name}`),M}createTrack(y,C){let{template:A,proxy:H,option:w}=this.art,{$video:_,$track:M}=A,$=(0,o.createElement)("track");$.default=!0,$.kind=y,$.src=C,$.label=w.subtitle.name||"Artplayer",$.track.mode="hidden",$.onload=()=>{this.art.emit("subtitleLoad",this.cues,this.option)},this.art.events.remove(this.destroyEvent),M.onload=null,(0,o.remove)(M),(0,o.append)(_,$),A.$track=$,this.destroyEvent=H(this.textTrack,"cuechange",()=>this.update())}async init(y){let{notice:C,template:{$subtitle:A}}=this.art;return this.textTrack?((0,u.default)(y,n.default.subtitle),y.url?(this.option=y,this.style(y.style),fetch(y.url).then(H=>H.arrayBuffer()).then(H=>{let w=new TextDecoder(y.encoding).decode(H);switch(y.type||(0,o.getExt)(y.url)){case"srt":{let _=(0,o.srtToVtt)(w),M=y.onVttLoad(_);return(0,o.vttToBlob)(M)}case"ass":{let _=(0,o.assToVtt)(w),M=y.onVttLoad(_);return(0,o.vttToBlob)(M)}case"vtt":{let _=y.onVttLoad(w);return(0,o.vttToBlob)(_)}default:return y.url}}).then(H=>(A.innerHTML="",this.url===H||(URL.revokeObjectURL(this.url),this.createTrack("metadata",H)),H)).catch(H=>{throw A.innerHTML="",C.show=H,H})):void 0):null}}s.default=f},{"option-validator":"g7VGh","./scheme":"biLjm","./utils":"aBlEo","./utils/component":"idCEj","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],fwOA1:[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s);var t=a("../package.json"),e=a("./utils");class u{constructor(n){this.art=n;let{option:o,constructor:i}=n;o.container instanceof Element?this.$container=o.container:(this.$container=(0,e.query)(o.container),(0,e.errorHandle)(this.$container,`No container element found by ${o.container}`)),(0,e.errorHandle)((0,e.supportsFlex)(),"The current browser does not support flex layout");let c=this.$container.tagName.toLowerCase();(0,e.errorHandle)(c==="div",`Unsupported container element type, only support 'div' but got '${c}'`),(0,e.errorHandle)(i.instances.every(f=>f.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=n.id,this.init()}static get html(){return`<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"><track default kind="metadata" src=""></track></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">${t.version}</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span>x<span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-contextmenus"></div></div>`}query(n){return(0,e.query)(n,this.$container)}init(){let{option:n}=this.art;if(n.useSSR||(this.$container.innerHTML=u.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$track=this.query("track"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$contextmenu=this.query(".art-contextmenus"),n.proxy){let o=n.proxy.call(this.art,this.art);(0,e.errorHandle)(o instanceof HTMLVideoElement||o instanceof HTMLCanvasElement,"Function 'option.proxy' needs to return 'HTMLVideoElement' or 'HTMLCanvasElement'"),(0,e.replaceElement)(o,this.$video),o.className="art-video",this.$video=o}n.backdrop&&(0,e.addClass)(this.$player,"art-backdrop"),e.isMobile&&(0,e.addClass)(this.$player,"art-mobile")}destroy(n){n?this.$container.innerHTML="":(0,e.addClass)(this.$player,"art-destroy")}}s.default=u},{"../package.json":"lh3R5","./utils":"aBlEo","@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}],"4NM7P":[function(a,p,s,x){a("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(s),s.default=class{on(t,e,u){let r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:u}),this}once(t,e,u){let r=this;function n(...o){r.off(t,n),e.apply(u,o)}return n._=e,this.on(t,n,u)}emit(t,...e){let u=((this.e||(this.e={}))[t]||[]).slice();for(let r=0;r<u.length;r+=1)u[r].fn.apply(u[r].ctx,e);return this}off(t,e){let u=this.e||(this.e={}),r=u[t],n=[];if(r&&e)for(let o=0,i=r.length;o<i;o+=1)r[o].fn!==e&&r[o].fn._!==e&&n.push(r[o]);return n.length?u[t]=n:delete u[t],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"loqXi"}]},["esqvp"],"esqvp","parcelRequire4dc0",{});let{default:Io}=parcelRequire4dc0("esqvp");const To={key:0,class:"m-buffer-ring","aria-hidden":"true"},Po={class:"yt-progress"},Bo={class:"yt-progress__track","aria-hidden":"true"},Fo=["max","value","disabled"],Ro={class:"yt-row"},No={class:"yt-pill yt-left"},Oo=["aria-label"],qo={viewBox:"0 0 24 24",class:"yt-ico"},Do={key:0,fill:"currentColor",d:"M6 5h4v14H6V5zm8 0h4v14h-4V5z"},Ho={key:1,fill:"currentColor",d:"M8 5v14l11-7L8 5z"},zo=["aria-label"],Vo={viewBox:"0 0 24 24",class:"yt-ico"},Uo={key:1,fill:"currentColor",d:"M3 10v4h4l5 5V5L7 10H3zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.06A4.5 4.5 0 0 0 16.5 12z"},Wo=["data-show"],Ko=["value"],Xo={class:"yt-time"},Go={class:"yt-pill yt-right"},Yo=["aria-label","data-active"],Zo={viewBox:"0 0 24 24",class:"yt-ico"},Jo={class:"yt-setting__section"},Qo={class:"yt-setting__grid"},ei=["data-active","onClick"],ti={class:"yt-setting__section"},ri={class:"yt-setting__grid"},ai=["data-active","onClick"],si=["aria-label"],ni={viewBox:"0 0 24 24",class:"yt-ico"},oi={key:0,fill:"currentColor",d:"M7 7h3V5H5v5h2V7zm10 0v3h2V5h-5v2h3zm-7 12H7v-3H5v5h5v-2zm9-3h-2v3h-3v2h5v-5z"},ii={key:1,fill:"currentColor",d:"M5 16h3v3h2v-5H5v2zm0-6h5V5H8v3H5v2zm14 6v-2h-5v5h2v-3h3zm-5-11v5h5V8h-3V5h-2z"},li={class:"yt-setting__section"},ci={class:"yt-setting__grid"},ui=["data-active","onClick"],di={class:"yt-setting__section"},pi={class:"yt-setting__grid"},fi=["data-active","onClick"],hi={class:"yt-progress m-progress"},vi={class:"yt-progress__track","aria-hidden":"true"},mi=["max","value","disabled"],gi=["aria-label"],yi={viewBox:"0 0 24 24",class:"yt-ico"},bi={key:0,fill:"currentColor",d:"M7 7h3V5H5v5h2V7zm10 0v3h2V5h-5v2h3zm-7 12H7v-3H5v5h5v-2zm9-3h-2v3h-3v2h5v-5z"},wi={key:1,fill:"currentColor",d:"M5 16h3v3h2v-5H5v2zm0-6h5V5H8v3H5v2zm14 6v-2h-5v5h2v-3h3zm-5-11v5h5V8h-3V5h-2z"},xi=["data-loading","aria-label"],ki={viewBox:"0 0 24 24",class:"m-ico m-ico--play"},Si={key:0,fill:"currentColor",d:"M6 5h4v14H6V5zm8 0h4v14h-4V5z"},_i={key:1,fill:"currentColor",d:"M8 5v14l11-7L8 5z"},Ei={__name:"DrPlayer",props:{url:{type:String,default:""},poster:{type:String,default:""},headers:{type:Object,default:()=>({})},title:{type:String,default:""},autoplay:{type:Boolean,default:!0}},emits:["loadedmetadata","error"],setup(a,{expose:p,emit:s}){const x=s,t=a,e=ae(null),u=ae(null),r=ae(null),n=ae(null);let o=null,i=null,c=null,f=null,g=null,y=null,C=0,A=0;const H=ae(!1),w=ae(0),_=ae(0),M=ae(.7),$=ae(!1),S=ae(!1),P=ae(1),J=ae("default"),oe=ae(!1),me=ae(!1),Se=ae(!0),je=ae(!0),T=ae(!1),V=ae(!1),Y=ae(!1),_e=ae(!1),Pe=De(()=>Y.value?Se.value||!H.value||oe.value:je.value||oe.value||!H.value);let se=null;const de=()=>{try{if(typeof window>"u")return;const L=typeof navigator<"u"&&navigator.userAgent?String(navigator.userAgent):"",B=typeof navigator<"u"&&typeof navigator.maxTouchPoints=="number"&&navigator.maxTouchPoints>0||"ontouchstart"in window,le=/iPad|iPhone|iPod/i.test(L)||!!B&&/Macintosh/i.test(L)&&(navigator.maxTouchPoints||0)>1,re=/Android/i.test(L),Be=/\bMobile\b/i.test(L),qe=typeof window.matchMedia=="function"?window.matchMedia("(hover: none) and (pointer: coarse)").matches:!1;_e.value=!!le,Y.value=!!(le||re||Be||qe&&B)}catch{Y.value=!1,_e.value=!1}},Me=[.5,.75,1,1.25,1.5,2],K=["default","16:9","4:3"],ke=L=>{const B=Number.isFinite(L)?Math.max(0,Math.floor(L)):0,le=Math.floor(B/3600),re=Math.floor(B%3600/60),Be=B%60;return le>0?`${le}:${String(re).padStart(2,"0")}:${String(Be).padStart(2,"0")}`:`${re}:${String(Be).padStart(2,"0")}`},ce=De(()=>`${ke(w.value)} / ${ke(_.value)}`),G=De(()=>{const L=Number(_.value),B=Number(w.value);return!Number.isFinite(L)||L<=0||!Number.isFinite(B)||B<=0?0:Math.max(0,Math.min(1,B/L))}),q=L=>!L||typeof L.closest!="function"?!1:!!L.closest([".yt-bar",".yt-setting",".yt-setting__menu",".yt-setting__item",".yt-progress",".yt-progress__range",".yt-btn",".m-center__controls",".m-btn"].join(",")),Z=L=>{const B=typeof L=="string"?L.toLowerCase():"";return B?B.includes(".m3u8")||B.includes("m3u8")?"hls":B.includes(".flv")||B.includes("flv")?"flv":B.includes(".mpd")||B.includes("mpd")?"dash":"native":"native"},O=L=>{if(L){try{L.hls&&typeof L.hls.destroy=="function"&&L.hls.destroy()}catch{}try{L.flv&&typeof L.flv.destroy=="function"&&L.flv.destroy()}catch{}try{L.dash&&typeof L.dash.destroy=="function"&&L.dash.destroy()}catch{}}};let D=null,ve=null,te=null;const ue=async()=>(D||(D=Vr(()=>import("./hls-ywO_6aio.js"),[]).then(L=>L&&(L.default||L))),await D),pe=async()=>(ve||(ve=Vr(()=>import("./flv-BrAw5_su.js").then(L=>L.f),__vite__mapDeps([0,1])).then(L=>L&&(L.default||L))),await ve),be=async()=>(te||(te=Vr(()=>import("./shaka-player.compiled-B5vUFVij.js").then(L=>L.s),__vite__mapDeps([2,1])).then(L=>L&&(L.default||L))),await te),Le=()=>{try{oe.value=!1}catch{}try{S.value=!1}catch{}try{C&&window.cancelAnimationFrame(C)}catch{}C=0,A=0;try{ot&&window.clearTimeout(ot),ot=0,ht&&window.clearTimeout(ht),ht=0}catch{}try{const L=o&&o.video?o.video:null;L&&typeof document<"u"&&document.pictureInPictureElement===L&&document.exitPictureInPicture().catch(()=>{})}catch{}try{const L=u.value,B=typeof document<"u"?document.fullscreenElement:null;L&&B&&(B===L||L.contains(B)||B.contains(L))&&document.exitFullscreen().catch(()=>{})}catch{}try{typeof i=="function"&&i()}catch{}i=null;try{typeof c=="function"&&c()}catch{}c=null;try{typeof y=="function"&&y()}catch{}y=null;try{typeof f=="function"&&f()}catch{}f=null;try{typeof g=="function"&&g()}catch{}g=null;try{const L=o&&o.video?o.video:null;if(L){try{L.pause()}catch{}try{L.removeAttribute("src")}catch{}try{for(;L.firstChild;)L.removeChild(L.firstChild)}catch{}try{L.load()}catch{}}}catch{}try{O(o&&o.customPlayer?o.customPlayer:null)}catch{}try{o&&typeof o.destroy=="function"&&o.destroy(!0)}catch{try{o&&typeof o.destroy=="function"&&o.destroy(!1)}catch{}}o=null,n.value=null,V.value=!1,H.value=!1},fe={async hls(L,B,le){const re=await ue();if(!re||!re.isSupported||!re.isSupported())return null;const Be=!1,qe=new re({manifestLoadingMaxRetry:2,levelLoadingMaxRetry:2,fragLoadingMaxRetry:2,keyLoadingMaxRetry:2,xhrSetup(mt){mt.withCredentials=Be,!(!le||typeof le!="object")&&Object.keys(le).forEach(Ne=>{const we=le[Ne];if(we!=null)try{mt.setRequestHeader(Ne,String(we))}catch{}})}});return qe.loadSource(B),qe.attachMedia(L),{hls:qe}},async flv(L,B,le){const re=await pe();if(!re||!re.isSupported||!re.isSupported())return null;const qe=re.createPlayer({type:"flv",isLive:!1,url:B,withCredentials:!1},{enableWorker:!1,enableStashBuffer:!1,autoCleanupSourceBuffer:!0,reuseRedirectedURL:!0,headers:le||{}});return qe.attachMediaElement(L),qe.load(),{flv:qe}},async dash(L,B,le){const re=await be();if(!re||!re.Player||!re.Player.isBrowserSupported||!re.Player.isBrowserSupported())return null;const Be=!1,qe=new re.Player(L);return qe.getNetworkingEngine().registerRequestFilter((mt,Ne)=>{Ne.allowCrossSiteCredentials=Be,!(!le||typeof le!="object")&&Object.keys(le).forEach(we=>{const Ge=le[we];Ge!=null&&(Ne.headers[we]=String(Ge))})}),qe.load(B),{dash:qe}}},Re=()=>{const L=(t.url||"").trim();if(!e.value||!L)return;o&&Le(),V.value=!1;const B=Z(L),le=L,Be=B==="native"&&(we=>{const Ge=typeof we=="string"?we.trim():"";if(!Ge)return!1;try{return new URL(Ge,window.location.href).origin!==window.location.origin}catch{return!1}})(le),qe=B==="hls"?"m3u8":B==="flv"?"flv":B==="dash"?"mpd":"";let mt=!1;const Ne=()=>{if(!mt){mt=!0;try{const we=o&&o.video?o.video:null,Ge=(o&&typeof o.duration=="number"?o.duration:null)??(we?we.duration:0);_.value=Number.isFinite(Ge)?Ge:0,x("loadedmetadata",{duration:_.value})}catch{}}};o=new Io({container:e.value,url:le,poster:t.poster||"",autoplay:!!t.autoplay,muted:!1,volume:.7,pip:!0,backdrop:!Y.value,autoSize:!1,autoMini:!1,setting:!1,playbackRate:!1,aspectRatio:!1,screenshot:!Be,playsInline:!0,gesture:!Y.value,theme:"#22c55e",lang:"zh-cn",type:qe,fullscreen:!1,fullscreenWeb:!1,hotkey:!1,customType:B!=="native"?{[qe]:function(we,Ge,Ye){const lt=t.headers||{},tt=`${Date.now()}-${Math.random()}`;Ye.__tvCustomToken=tt,(async()=>{let nt=null;try{B==="hls"&&(nt=await fe.hls(we,Ge,lt)),B==="flv"&&(nt=await fe.flv(we,Ge,lt)),B==="dash"&&(nt=await fe.dash(we,Ge,lt))}catch{nt=null}if(!Ye||Ye.__tvCustomToken!==tt||(Ye.url||"")!==Ge){O(nt);return}nt&&(Ye.customPlayer=nt);try{t.autoplay&&we&&typeof we.play=="function"&&we.play().catch(()=>{})}catch{}})()}}:{}});try{n.value=o&&o.template&&o.template.$player?o.template.$player:null}catch{n.value=null}try{typeof g=="function"&&g()}catch{}g=null,je.value=!0;try{const we=n.value;if(we){const Ge=()=>{Y.value||(je.value=!0,Ae())},Ye=()=>{Y.value||o&&o.playing&&!oe.value&&!S.value&&(je.value=!1)};if(typeof we.addEventListener=="function"){const lt=tt=>{if(!Y.value&&!q(tt&&tt.target?tt.target:null)){try{tt.preventDefault()}catch{}try{typeof tt.stopImmediatePropagation=="function"&&tt.stopImmediatePropagation()}catch{}try{tt.stopPropagation()}catch{}bt()}};we.addEventListener("dblclick",lt,{capture:!0}),we.addEventListener("mousemove",Ge,{passive:!0}),we.addEventListener("mouseenter",Ge,{passive:!0}),we.addEventListener("mouseleave",Ye,{passive:!0}),g=()=>{try{we.removeEventListener("dblclick",lt,!0),we.removeEventListener("mousemove",Ge),we.removeEventListener("mouseenter",Ge),we.removeEventListener("mouseleave",Ye)}catch{}}}}}catch{je.value=!0}try{const we=o.video;if(we){if(Be){const tt=()=>{try{we.removeAttribute("crossorigin")}catch{}try{we.setAttribute("referrerpolicy","no-referrer")}catch{}};tt();try{if(typeof MutationObserver=="function"){const nt=new MutationObserver(()=>tt());nt.observe(we,{attributes:!0,attributeFilter:["crossorigin","referrerpolicy"]}),y=()=>{try{nt.disconnect()}catch{}}}}catch{}}we.setAttribute("playsinline",""),we.setAttribute("webkit-playsinline",""),we.setAttribute("x-webkit-airplay","allow"),we.setAttribute("preload","metadata");try{we.preload="metadata"}catch{}try{we.load()}catch{}const Ge=()=>Ne(),Ye=()=>{try{const tt=(o&&typeof o.duration=="number"?o.duration:null)??we.duration;_.value=Number.isFinite(tt)?tt:0}catch{}typeof we.readyState=="number"&&we.readyState>=1&&Ne()},lt=()=>{try{const tt=we&&we.error?we.error:null,nt=tt&&typeof tt.code=="number"?tt.code:0;let St="播放失败";nt===2?St="播放失败：网络错误":nt===3?St="播放失败：解码错误（可能不支持该编码/清晰度）":nt===4&&(St="播放失败：媒体不可播放（可能不支持该编码/清晰度）"),x("error",{code:nt,message:St})}catch{try{x("error",{code:0,message:"播放失败"})}catch{}}};we.addEventListener("loadedmetadata",Ge),we.addEventListener("durationchange",Ye),we.addEventListener("error",lt),f=()=>{try{we.removeEventListener("loadedmetadata",Ge),we.removeEventListener("durationchange",Ye),we.removeEventListener("error",lt)}catch{}}}}catch{}Se.value=!0,ge(),H.value=o.playing,w.value=o.currentTime||0,_.value=o.duration||0,M.value=o.volume||0,$.value=o.muted||!1,P.value=o.playbackRate||1,J.value=o.aspectRatio||"default",o.on("video:timeupdate",()=>{A=o.currentTime||0,!C&&(C=window.requestAnimationFrame(()=>{C=0;const we=A||0;S.value&&we>(w.value||0)+.05&&(S.value=!1),w.value=we}))}),o.on("video:loadedmetadata",()=>{try{const we=o.duration||0;_.value=Number.isFinite(we)?we:0}catch{}Ne()}),o.on("video:durationchange",()=>{_.value=o.duration||0}),o.on("video:volumechange",()=>{M.value=o.volume||0,$.value=o.muted||!1}),o.on("video:ratechange",()=>{P.value=o.playbackRate||1}),o.on("video:play",()=>{H.value=!0,S.value=!1,ge()}),o.on("video:pause",()=>{H.value=!1,S.value=!1,Se.value=!0}),o.on("video:waiting",()=>{S.value=!0,ge()}),o.on("video:stalled",()=>{S.value=!0,ge()}),o.on("video:playing",()=>{S.value=!1,ge(),Ne()}),o.on("video:canplay",()=>{S.value=!1,Ne()}),o.on("video:error",()=>{S.value=!1,Se.value=!0;try{const we=o&&o.video?o.video:null,Ge=we&&we.error?we.error:null,Ye=Ge&&typeof Ge.code=="number"?Ge.code:0;let lt="播放失败";Ye===2?lt="播放失败：网络错误":Ye===3?lt="播放失败：解码错误（可能不支持该编码/清晰度）":Ye===4&&(lt="播放失败：媒体不可播放（可能不支持该编码/清晰度）"),x("error",{code:Ye,message:lt})}catch{try{x("error",{code:0,message:"播放失败"})}catch{}}});try{const we=o.video;if(we&&typeof we.addEventListener=="function"){const Ge=()=>{T.value=!0,ge()},Ye=()=>{T.value=!1,ge()};we.addEventListener("webkitbeginfullscreen",Ge),we.addEventListener("webkitendfullscreen",Ye),c=()=>{try{we.removeEventListener("webkitbeginfullscreen",Ge),we.removeEventListener("webkitendfullscreen",Ye)}catch{}}}}catch{}try{const we=o.video;if(we&&typeof we.addEventListener=="function"){const Ge=()=>{try{V.value=document.pictureInPictureElement===we}catch{V.value=!1}},Ye=()=>Ge(),lt=()=>Ge();we.addEventListener("enterpictureinpicture",Ye),we.addEventListener("leavepictureinpicture",lt),Ge(),i=()=>{try{we.removeEventListener("enterpictureinpicture",Ye),we.removeEventListener("leavepictureinpicture",lt)}catch{}}}}catch{}},ne=()=>{o&&o.toggle()},$e=L=>{try{window.dispatchEvent(new CustomEvent("tvplayer:episode",{detail:{delta:L}}))}catch{}},he=()=>{o&&(o.muted=!o.muted)},Te=L=>{const B=L&&L.target?Number(L.target.value):NaN;!o||!Number.isFinite(B)||(o.muted=!1,o.volume=Math.max(0,Math.min(1,B)))},Xe=L=>{const B=L&&L.target?Number(L.target.value):NaN;!o||!Number.isFinite(B)||(o.currentTime=Math.max(0,Math.min(_.value||0,B)))},Qe=L=>{o&&(o.playbackRate=L,P.value=L)},st=L=>{o&&(o.aspectRatio=L,J.value=L)},xt=()=>{try{const L=o&&o.video?o.video:null;if(!L)return;document.pictureInPictureElement?document.exitPictureInPicture():typeof L.requestPictureInPicture=="function"&&L.requestPictureInPicture(),ge()}catch{}},bt=async()=>{try{const L=u.value;if(!L||!o)return;const B=o.video;if(B&&typeof B.webkitEnterFullscreen=="function"){T.value&&typeof B.webkitExitFullscreen=="function"?B.webkitExitFullscreen():B.webkitEnterFullscreen(),ge();return}if(typeof document<"u"?document.fullscreenElement:null){document.exitFullscreen().catch(()=>{}),ge();return}const re=n.value||L;re&&typeof re.requestFullscreen=="function"&&re.requestFullscreen().catch(()=>{}),ge()}catch{}};let ot=0,ht=0;const Ae=()=>{ht&&window.clearTimeout(ht),ht=0,o&&o.playing&&(oe.value||S.value||(ht=window.setTimeout(()=>{o&&o.playing&&!oe.value&&!S.value&&(je.value=!1)},2200)))},ge=()=>{if(Y.value){Se.value=!0,ot&&window.clearTimeout(ot),ot=window.setTimeout(()=>{o&&o.playing&&!oe.value&&!S.value&&(Se.value=!1)},2200);return}je.value=!0,Ae()},Ie=L=>{if(!oe.value)return;const B=r.value;B&&L&&L.target&&B.contains(L.target)||(oe.value=!1)};return pr(()=>{de(),Re();try{typeof window<"u"&&window.addEventListener("resize",de,{passive:!0}),typeof window<"u"&&typeof window.matchMedia=="function"&&(se=window.matchMedia("(max-width: 820px)"),typeof se.addEventListener=="function"?se.addEventListener("change",de):typeof se.addListener=="function"&&se.addListener(de))}catch{se=null}document.addEventListener("mousedown",Ie,!0);try{const L=u.value;if(L){const B=()=>ge();L.addEventListener("touchmove",B,{passive:!0});const le=Be=>{if(!(!Be||!Be.target||!L.contains(Be.target))&&Y.value&&!q(Be.target)){Se.value?(oe.value=!1,Se.value=!1):(oe.value=!1,Se.value=!0,ge());try{Be.preventDefault()}catch{}try{typeof Be.stopImmediatePropagation=="function"&&Be.stopImmediatePropagation()}catch{}try{Be.stopPropagation()}catch{}}};L.addEventListener("click",le,{capture:!0});const re=()=>{T.value=!!document.fullscreenElement,Y.value||(je.value=!0,Ae())};document.addEventListener("fullscreenchange",re,!0),re(),L.__tvCleanupPlayerUi=()=>{L.removeEventListener("touchmove",B),L.removeEventListener("click",le,!0),document.removeEventListener("fullscreenchange",re,!0),delete L.__tvCleanupPlayerUi}}}catch{}}),jt(()=>t.url,(L,B)=>{const le=(L||"").trim(),re=(B||"").trim();le&&le!==re&&Re(),!le&&o&&Le()}),Sr(()=>{ot&&(window.clearTimeout(ot),ot=0),ht&&(window.clearTimeout(ht),ht=0);try{typeof window<"u"&&window.removeEventListener("resize",de),se&&(typeof se.removeEventListener=="function"?se.removeEventListener("change",de):typeof se.removeListener=="function"&&se.removeListener(de))}catch{}se=null,document.removeEventListener("mousedown",Ie,!0);try{const L=u.value;L&&L.__tvCleanupPlayerUi&&L.__tvCleanupPlayerUi()}catch{}o&&Le()}),p({destroy:Le,pause:()=>{try{if(o&&typeof o.pause=="function"){o.pause();return}}catch{}try{const L=o&&o.video?o.video:null;L&&typeof L.pause=="function"&&L.pause()}catch{}}}),(L,B)=>(U(),W("div",{class:yt(["tv-drplayer",{"tv-drplayer--fullscreen":T.value,"tv-drplayer--mobile":Y.value}]),ref_key:"shell",ref:u},[l("div",{ref_key:"container",ref:e,class:"drplayer-root"},null,512),(U(),Gr(Da,{to:n.value||"body",disabled:!n.value},[S.value?(U(),W("div",To)):wt("",!0),l("div",{class:yt(["yt-ui",{"yt-ui--show":Pe.value}])},[Y.value?(U(),W("div",{key:1,class:"m-bar",onClick:B[20]||(B[20]=it(()=>{},["stop"])),onMousedown:B[21]||(B[21]=it(()=>{},["stop"])),onTouchstart:B[22]||(B[22]=it(()=>{},["stop"]))},[l("div",{class:"yt-setting m-setting",ref_key:"settingEl",ref:r},[l("button",{class:"yt-btn",type:"button","aria-label":"设置",onClick:B[12]||(B[12]=it(le=>oe.value=!oe.value,["stop"]))},[...B[34]||(B[34]=[l("svg",{viewBox:"0 0 24 24",class:"yt-ico"},[l("path",{fill:"currentColor",d:"M19.14 12.94c.04-.31.06-.63.06-.94s-.02-.63-.06-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a7.027 7.027 0 0 0-1.63-.94l-.36-2.54A.5.5 0 0 0 13.9 1h-3.8a.5.5 0 0 0-.49.42l-.36 2.54c-.58.22-1.12.52-1.63.94l-2.39-.96a.5.5 0 0 0-.6.22L2.71 7.48a.5.5 0 0 0 .12.64l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94L2.83 14.52a.5.5 0 0 0-.12.64l1.92 3.32a.5.5 0 0 0 .6.22l2.39-.96c.5.41 1.05.72 1.63.94l.36 2.54a.5.5 0 0 0 .49.42h3.8a.5.5 0 0 0 .49-.42l.36-2.54c.58-.22 1.12-.52 1.63-.94l2.39.96a.5.5 0 0 0 .6-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58zM12 15.5A3.5 3.5 0 1 1 12 8a3.5 3.5 0 0 1 0 7.5z"})],-1)])]),l("div",{class:yt(["yt-setting__menu",{"yt-setting__menu--open":oe.value}])},[l("div",li,[B[35]||(B[35]=l("div",{class:"yt-setting__title"},"播放速度",-1)),l("div",ci,[(U(),W(ft,null,_t(Me,le=>l("button",{key:le,type:"button",class:"yt-setting__item","data-active":Math.abs(P.value-le)<.001?"true":"false",onClick:re=>Qe(le)},He(le)+"x ",9,ui)),64))])]),l("div",di,[B[36]||(B[36]=l("div",{class:"yt-setting__title"},"画面比例",-1)),l("div",pi,[(U(),W(ft,null,_t(K,le=>l("button",{key:le,type:"button",class:"yt-setting__item","data-active":J.value===le?"true":"false",onClick:re=>st(le)},He(le==="default"?"默认":le),9,fi)),64))])])],2)],512),l("div",hi,[l("div",vi,[l("div",{class:"yt-progress__fill",style:ma({"--yt-progress-p":G.value})},null,4)]),l("input",{class:"yt-progress__range",type:"range",min:"0",max:Math.max(_.value,0),step:"0.1",value:Math.min(w.value,_.value),disabled:!_.value,onMousedown:B[13]||(B[13]=it(()=>{},["stop"])),onClick:B[14]||(B[14]=it(()=>{},["stop"])),onInput:Xe},null,40,mi)]),l("button",{class:"yt-btn m-fullscreen",type:"button","aria-label":T.value?"退出全屏":"全屏",onClick:it(bt,["stop"])},[(U(),W("svg",yi,[T.value?(U(),W("path",wi)):(U(),W("path",bi))]))],8,gi),l("div",{class:yt(["m-center",{"m-center--show":Se.value||!H.value}])},[l("div",{class:"m-center__controls",onClick:B[17]||(B[17]=it(()=>{},["stop"])),onMousedown:B[18]||(B[18]=it(()=>{},["stop"])),onTouchstart:B[19]||(B[19]=it(()=>{},["stop"]))},[l("button",{class:"m-btn m-btn--skip",type:"button","aria-label":"上一集",onClick:B[15]||(B[15]=it(le=>$e(-1),["stop"]))},[...B[37]||(B[37]=[l("svg",{viewBox:"0 0 24 24",class:"m-ico"},[l("path",{fill:"currentColor",d:"M6 6h2v12H6V6zm3.5 6L18 6v12l-8.5-6z"})],-1)])]),l("button",{class:"m-btn m-btn--play",type:"button","data-loading":S.value?"true":"false","aria-label":H.value?"暂停":"播放",onClick:it(ne,["stop"])},[(U(),W("svg",ki,[H.value?(U(),W("path",Si)):(U(),W("path",_i))]))],8,xi),l("button",{class:"m-btn m-btn--skip",type:"button","aria-label":"下一集",onClick:B[16]||(B[16]=it(le=>$e(1),["stop"]))},[...B[38]||(B[38]=[l("svg",{viewBox:"0 0 24 24",class:"m-ico"},[l("path",{fill:"currentColor",d:"M16 6h2v12h-2V6zM6 18V6l8.5 6L6 18z"})],-1)])])],32)],2)],32)):(U(),W("div",{key:0,class:"yt-bar",onClick:B[9]||(B[9]=it(()=>{},["stop"])),onMousedown:B[10]||(B[10]=it(()=>{},["stop"])),onTouchstart:B[11]||(B[11]=it(()=>{},["stop"]))},[l("div",Po,[l("div",Bo,[l("div",{class:"yt-progress__fill",style:ma({"--yt-progress-p":G.value})},null,4)]),l("input",{class:"yt-progress__range",type:"range",min:"0",max:Math.max(_.value,0),step:"0.1",value:Math.min(w.value,_.value),disabled:!_.value,onMousedown:B[0]||(B[0]=it(()=>{},["stop"])),onClick:B[1]||(B[1]=it(()=>{},["stop"])),onInput:Xe},null,40,Fo)]),l("div",Ro,[l("div",No,[l("button",{class:"yt-btn",type:"button","aria-label":H.value?"暂停":"播放",onClick:it(ne,["stop"])},[(U(),W("svg",qo,[H.value?(U(),W("path",Do)):(U(),W("path",Ho))]))],8,Oo),l("button",{class:"yt-btn",type:"button","aria-label":"上一集",onClick:B[2]||(B[2]=it(le=>$e(-1),["stop"]))},[...B[23]||(B[23]=[l("svg",{viewBox:"0 0 24 24",class:"yt-ico"},[l("path",{fill:"currentColor",d:"M6 6h2v12H6V6zm3.5 6L18 6v12l-8.5-6z"})],-1)])]),l("button",{class:"yt-btn",type:"button","aria-label":"下一集",onClick:B[3]||(B[3]=it(le=>$e(1),["stop"]))},[...B[24]||(B[24]=[l("svg",{viewBox:"0 0 24 24",class:"yt-ico"},[l("path",{fill:"currentColor",d:"M16 6h2v12h-2V6zM6 18V6l8.5 6L6 18z"})],-1)])]),l("div",{class:"yt-volume",onMouseenter:B[6]||(B[6]=le=>me.value=!0),onMouseleave:B[7]||(B[7]=le=>me.value=!1)},[l("button",{class:"yt-btn",type:"button","aria-label":$.value?"取消静音":"静音",onClick:it(he,["stop"])},[(U(),W("svg",Vo,[$.value||M.value<=.01?(U(),W(ft,{key:0},[B[25]||(B[25]=l("path",{fill:"currentColor",d:"M16.5 12a4.5 4.5 0 0 0-1.17-3.02l-1.42 1.42A2.5 2.5 0 0 1 14.5 12c0 .68-.27 1.3-.7 1.76l1.42 1.42A4.5 4.5 0 0 0 16.5 12z",opacity:"0.0"},null,-1)),B[26]||(B[26]=l("path",{fill:"currentColor",d:"M3 10v4h4l5 5V5L7 10H3zm13.59 2 2.7 2.7-1.41 1.41L15.18 13l-2.7 2.7-1.41-1.41 2.7-2.7-2.7-2.7 1.41-1.41 2.7 2.7 2.7-2.7 1.41 1.41-2.7 2.7z"},null,-1))],64)):(U(),W("path",Uo))]))],8,zo),l("div",{class:"yt-volume__slider","data-show":me.value?"true":"false"},[l("input",{class:"yt-volume__range",type:"range",min:"0",max:"1",step:"0.01",value:$.value?0:M.value,onMousedown:B[4]||(B[4]=it(()=>{},["stop"])),onClick:B[5]||(B[5]=it(()=>{},["stop"])),onInput:it(Te,["stop"])},null,40,Ko)],8,Wo)],32),l("div",Xo,He(ce.value),1)]),l("div",Go,[l("button",{class:"yt-btn",type:"button","aria-label":V.value?"退出画中画":"画中画","data-active":V.value?"true":"false",onClick:it(xt,["stop"])},[(U(),W("svg",Zo,[V.value?(U(),W(ft,{key:1},[B[29]||(B[29]=l("path",{fill:"currentColor",d:"M19 7H5v10h14V7zm0-2a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h14z",opacity:"0.55"},null,-1)),B[30]||(B[30]=l("path",{fill:"currentColor",d:"M14 10h-4v4h4v-4z"},null,-1))],64)):(U(),W(ft,{key:0},[B[27]||(B[27]=l("path",{fill:"currentColor",d:"M19 7H5v10h14V7zm0-2a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h14z",opacity:"0.55"},null,-1)),B[28]||(B[28]=l("path",{fill:"currentColor",d:"M13 11h6v4h-6v-4z"},null,-1))],64))]))],8,Yo),l("div",{class:"yt-setting",ref_key:"settingEl",ref:r},[l("button",{class:"yt-btn",type:"button","aria-label":"设置",onClick:B[8]||(B[8]=it(le=>oe.value=!oe.value,["stop"]))},[...B[31]||(B[31]=[l("svg",{viewBox:"0 0 24 24",class:"yt-ico"},[l("path",{fill:"currentColor",d:"M19.14 12.94c.04-.31.06-.63.06-.94s-.02-.63-.06-.94l2.03-1.58a.5.5 0 0 0 .12-.64l-1.92-3.32a.5.5 0 0 0-.6-.22l-2.39.96a7.027 7.027 0 0 0-1.63-.94l-.36-2.54A.5.5 0 0 0 13.9 1h-3.8a.5.5 0 0 0-.49.42l-.36 2.54c-.58.22-1.12.52-1.63.94l-2.39-.96a.5.5 0 0 0-.6.22L2.71 7.48a.5.5 0 0 0 .12.64l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94L2.83 14.52a.5.5 0 0 0-.12.64l1.92 3.32a.5.5 0 0 0 .6.22l2.39-.96c.5.41 1.05.72 1.63.94l.36 2.54a.5.5 0 0 0 .49.42h3.8a.5.5 0 0 0 .49-.42l.36-2.54c.58-.22 1.12-.52 1.63-.94l2.39.96a.5.5 0 0 0 .6-.22l1.92-3.32a.5.5 0 0 0-.12-.64l-2.03-1.58zM12 15.5A3.5 3.5 0 1 1 12 8a3.5 3.5 0 0 1 0 7.5z"})],-1)])]),l("div",{class:yt(["yt-setting__menu",{"yt-setting__menu--open":oe.value}])},[l("div",Jo,[B[32]||(B[32]=l("div",{class:"yt-setting__title"},"播放速度",-1)),l("div",Qo,[(U(),W(ft,null,_t(Me,le=>l("button",{key:le,type:"button",class:"yt-setting__item","data-active":Math.abs(P.value-le)<.001?"true":"false",onClick:re=>Qe(le)},He(le)+"x ",9,ei)),64))])]),l("div",ti,[B[33]||(B[33]=l("div",{class:"yt-setting__title"},"画面比例",-1)),l("div",ri,[(U(),W(ft,null,_t(K,le=>l("button",{key:le,type:"button",class:"yt-setting__item","data-active":J.value===le?"true":"false",onClick:re=>st(le)},He(le==="default"?"默认":le),9,ai)),64))])])],2)],512),l("button",{class:"yt-btn",type:"button","aria-label":T.value?"退出全屏":"全屏",onClick:it(bt,["stop"])},[(U(),W("svg",ni,[T.value?(U(),W("path",ii)):(U(),W("path",oi))]))],8,si)])])],32))],2)],8,["to","disabled"]))],2))}},Ci=Rr(Ei,[["__scopeId","data-v-0f479c7c"]]),$i={},ji={key:0,class:"w-full"},Li={class:"w-full rounded-xl bg-black/10 dark:bg-white/5 border border-white/0 dark:border-white/30 px-3 py-2",role:"group","aria-label":"第三方播放器"},Ai={class:"flex items-center justify-center gap-2 flex-wrap"},Mi=["href","aria-label","title"],Ii=["src","alt"],Ti=["aria-label","title"],wa="tv:play:show_all_players",Pi={__name:"ExternalPlayerBar",props:{url:{type:String,default:""},title:{type:String,default:""}},emits:["open"],setup(a,{emit:p}){const s=a,x=p,t=ae(!1);try{t.value=localStorage.getItem(wa)==="true"}catch{t.value=!1}const e=()=>{t.value=!t.value;try{localStorage.setItem(wa,t.value?"true":"false")}catch{}},u=()=>{try{x("open")}catch{}},r=w=>{const _=String(w||"").trim();if(!_)return"";try{return new URL(_,window.location.href).toString()}catch{return _}},n=De(()=>r(s.url)),o=De(()=>String(s.title||"").trim()),i=(w,_)=>{const M=w.match(/[eb]/g);let $=String(_||"");if(M)for(const S of M.reverse())S==="e"&&($=encodeURIComponent($)),S==="b"&&($=window.btoa($));return $},c=(w,_)=>{let M=String(w||"");return M=M.replace("$name",String(_.name||"")),M=M.replace(/\$[eb_]*url/g,$=>i($,_.raw_url)),M=M.replace(/\$[eb_]*durl/g,$=>i($,_.d_url)),M},f="/",g=f.endsWith("/")?f:`${f}/`,y=w=>`${g}images/${encodeURIComponent(String(w||"").trim())}.webp`,C=[{key:"potplayer",name:"PotPlayer",icon:"potplayer",iconUrl:y("potplayer"),scheme:"potplayer://$durl"},{key:"infuse",name:"Infuse",icon:"infuse",iconUrl:y("infuse"),scheme:"infuse://x-callback-url/play?url=$edurl"},{key:"mpv",name:"mpv",icon:"mpv",iconUrl:y("mpv"),scheme:"mpv://$edurl"},{key:"vlc",name:"VLC",icon:"vlc",iconUrl:y("vlc"),scheme:"vlc://$durl"},{key:"nplayer",name:"nPlayer",icon:"nplayer",iconUrl:y("nplayer"),scheme:"nplayer-$durl"},{key:"mxplayer",name:"MX Player",icon:"mxplayer",iconUrl:y("mxplayer"),scheme:"intent:$durl#Intent;package=com.mxtech.videoplayer.ad;S.title=$name;end"},{key:"mxplayer-pro",name:"MX Player Pro",icon:"mxplayer-pro",iconUrl:y("mxplayer-pro"),scheme:"intent:$durl#Intent;package=com.mxtech.videoplayer.pro;S.title=$name;end"},{key:"iina",name:"IINA",icon:"iina",iconUrl:y("iina"),scheme:"iina://weblink?url=$edurl"},{key:"omniplayer",name:"OmniPlayer",icon:"omniplayer",iconUrl:y("omniplayer"),scheme:"omniplayer://weblink?url=$durl"},{key:"figplayer",name:"Fig Player",icon:"figplayer",iconUrl:y("figplayer"),scheme:"figplayer://weblink?url=$durl"},{key:"fileball",name:"Fileball",icon:"fileball",iconUrl:y("fileball"),scheme:"filebox://play?url=$durl"},{key:"iPlay",name:"iPlay",icon:"iPlay",iconUrl:y("iPlay"),scheme:"iplay://play/any?type=url&url=$bdurl"}],A=["potplayer","infuse","mpv"],H=De(()=>{if(t.value)return C;const w=new Map(C.map(_=>[_.key,_]));return A.map(_=>w.get(_)).filter(Boolean)});return(w,_)=>n.value&&C.length?(U(),W("div",ji,[l("div",Li,[l("div",Ai,[(U(!0),W(ft,null,_t(H.value,M=>(U(),W("a",{key:M.key,class:"tv-third-player-btn",href:c(M.scheme,{raw_url:n.value,name:o.value,d_url:n.value}),"aria-label":`使用 ${M.name} 播放`,title:M.name,onClick:u},[l("img",{class:"tv-third-player-img",src:M.iconUrl,alt:M.name,loading:"lazy",decoding:"async"},null,8,Ii)],8,Mi))),128)),C.length>A.length?(U(),W("button",{key:0,type:"button",class:"tv-third-player-toggle","aria-label":t.value?"收起":"展开更多播放器",title:t.value?"收起":"更多",onClick:e},[(U(),W("svg",{class:yt(["w-4 h-4 transition-transform duration-200",t.value?"rotate-180":"rotate-0"]),viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[..._[0]||(_[0]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 5l7 7-7 7"},null,-1)])],2))],8,Ti)):wt("",!0)])])])):wt("",!0)}},Bi=Rr(Pi,[["__scopeId","data-v-c4be862e"]]),Fi={id:"playPage",class:"content-main flex-1 md:min-h-0 md:mt-0",style:{"padding-top":"var(--tv-topbar-h, calc(3rem + env(safe-area-inset-top)))","padding-bottom":"calc(3.5rem + env(safe-area-inset-bottom))"}},Ri={class:"flex flex-col gap-3 py-4 px-5 lg:px-[3rem] 2xl:px-20"},Ni={class:"py-1"},Oi={class:"flex items-center gap-3"},qi={class:"flex flex-1 items-center gap-2 min-w-0"},Di={class:"min-w-0 text-xl font-semibold text-gray-900 dark:text-gray-100"},Hi={id:"playTitle",class:"block truncate"},zi=["disabled"],Vi={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"none","aria-hidden":"true"},Ui={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4 text-slate-400 dark:text-slate-300",fill:"none",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},Wi={class:"space-y-2"},Ki={id:"playGrid",class:"grid gap-4 transition-all duration-300 ease-in-out grid-cols-1 md:grid-cols-4"},Xi={id:"playerArea",class:"transition-all duration-300 ease-in-out rounded-xl border border-white/0 dark:border-white/30 md:col-span-3 flex flex-col gap-2"},Gi={class:"play-video-ratio rounded-xl overflow-hidden shadow-lg"},Yi={class:"play-video-ratio__inner"},Zi={key:1,class:"w-full h-full bg-black/10 dark:bg-white/5","aria-hidden":"true"},Ji={class:"play-player-overlay__badge"},Qi={class:"play-player-overlay__text"},el={key:0,class:"tv-spinner","aria-hidden":"true"},tl={id:"episodePanel",class:"relative w-full h-[320px] sm:h-[360px] md:h-full md:overflow-hidden transition-all duration-300 ease-in-out md:col-span-1 lg:opacity-100 lg:scale-100"},rl={id:"episodeSelector",class:"md:ml-2 px-4 py-0 h-full min-h-0 rounded-xl bg-black/10 dark:bg-white/5 flex flex-col border border-white/0 dark:border-white/30 overflow-hidden"},al={class:"episode-tab-header flex mb-1 -mx-6 flex-shrink-0"},sl={id:"episodesTab",class:"flex flex-col flex-1 min-h-0"},nl={class:"episode-controls-row flex items-center gap-2.5 mb-3 -mx-6 px-6 flex-shrink-0"},ol={class:"flex-1 min-w-0"},il=["disabled"],ll=["onClick"],cl={key:0,class:"custom-dropdown-item"},ul=["data-active"],dl={class:"flex items-center gap-4 mb-4 border-b border-gray-300 dark:border-gray-700 -mx-6 px-6 flex-shrink-0"},pl={class:"flex-1 min-w-0"},fl={key:0,class:"episode-season-bar"},hl={class:"episode-season-tabs"},vl=["data-active","onClick"],ml={class:"episode-group-bar"},gl=["data-active","onClick"],yl=["data-active","onClick"],bl={id:"rawListView",class:"raw-list flex-1 overflow-y-auto content-start pb-4"},wl={key:0,class:"tv-center-loading"},xl={key:1,class:"raw-list__hint raw-list__hint--error"},kl={key:2,class:"raw-list__hint"},Sl={key:3,class:"raw-list__items"},_l=["title","onClick"],El={class:"raw-list__text"},Cl={id:"episodeButtons",class:"relative flex flex-wrap gap-3 overflow-y-auto flex-1 content-start pb-4"},$l={key:0,class:"tv-episode-overlay","aria-hidden":"true"},jl={key:1,class:"tv-episode-overlay"},Ll={class:"tv-episode-overlay__inner"},Al={class:"tv-center-loading__text text-red-600 dark:text-red-400"},Ml=["title","onClick"],Il={key:1,class:"tv-episode-overlay"},Tl={id:"sourcesTab",class:"flex flex-col flex-1 min-h-0 pt-4"},Pl={class:"flex-1 min-h-0 overflow-y-auto space-y-2 pb-6"},Bl=["onClick"],Fl={class:"source-card__cover flex-shrink-0 w-12 h-20 rounded overflow-hidden"},Rl=["src","alt"],Nl={key:1,class:"w-full h-full bg-gray-300 dark:bg-gray-600"},Ol={class:"flex-1 min-w-0 flex flex-col gap-1 h-20"},ql={class:"flex items-start justify-between gap-3 h-6"},Dl={class:"flex-1 min-w-0"},Hl={class:"font-medium text-base truncate text-gray-900 dark:text-gray-100 leading-none"},zl={key:0,class:"source-card__quality bg-gray-500/10 dark:bg-gray-400/20 text-green-600 dark:text-green-400 px-1.5 py-0 rounded text-xs flex-shrink-0 min-w-[50px] text-center"},Vl={key:0,class:"h-5 flex items-center"},Ul=["title"],Wl={key:1,class:"h-5"},Kl={class:"mt-auto flex items-center justify-between"},Xl={class:"source-card__site text-xs px-2 py-1 border border-gray-500/60 rounded text-gray-700 dark:text-gray-200 truncate max-w-[70%]"},Gl={class:"text-xs text-gray-500 dark:text-gray-400 font-medium"},Yl={key:0,class:"source-more-btn flex items-center justify-center gap-2 cursor-default"},Zl={key:1,class:"text-red-600 dark:text-red-400"},Jl={key:2},Ql={class:"bg-white/80 dark:bg-gray-800/40 rounded-2xl p-4 sm:p-6 border border-gray-200/30 dark:border-gray-700/30 backdrop-blur-sm play-detail"},ec={class:"play-detail__inner"},tc={class:"play-detail__poster"},rc={class:"play-detail__posterWrap"},ac=["src","alt"],sc={key:1,class:"play-detail__posterFallback"},nc={class:"play-detail__info"},oc={class:"play-detail__titleRow"},ic={class:"play-detail__title"},lc={class:"block truncate"},cc=["disabled"],uc={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4 text-pink-500 dark:text-pink-400",fill:"currentColor","aria-hidden":"true"},dc={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4 text-slate-400 dark:text-slate-300",fill:"none",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},pc={key:0,class:"play-detail__meta"},fc={class:"play-detail__desc",style:{"white-space":"pre-line"}},xa="tv:search:aggregate:sources:v1",xr=50,hc={__name:"PlayPage",props:{bootstrap:{type:Object,required:!0},videoTitle:{type:String,default:""},videoYear:{type:String,default:""},searchType:{type:String,default:""},siteKey:{type:String,default:""},spiderApi:{type:String,default:""},videoId:{type:String,default:""},videoIntro:{type:String,default:""},videoPoster:{type:String,default:""},videoRemark:{type:String,default:""}},setup(a){const p=a,s=ae(null),x=ae([]),t=ae(!1),e=d=>String(d||"").toLowerCase().replace(/[^0-9a-z\u4e00-\u9fa5]+/gi,"").trim(),u=()=>{const d=e(ne.value||p.videoTitle||"");if(!d){x.value=[],t.value=!1;return}try{const v=sessionStorage.getItem(xa),m=v&&v.trim()?JSON.parse(v):null,E=m&&typeof m.key=="string"?m.key.trim():"";if(!E||E!==d){x.value=[],t.value=!1;return}const R=m&&Array.isArray(m.sources)?m.sources:[],z=new Set;x.value=R.map(N=>({siteKey:N&&N.siteKey?String(N.siteKey):"",spiderApi:N&&N.spiderApi?String(N.spiderApi):"",siteName:N&&N.siteName?String(N.siteName):"",videoId:N&&N.videoId?String(N.videoId):"",videoTitle:N&&N.videoTitle?String(N.videoTitle):"",videoPoster:N&&N.videoPoster?String(N.videoPoster):"",videoRemark:N&&N.videoRemark?String(N.videoRemark):""})).filter(N=>{if(!N.siteKey||!N.spiderApi||!N.videoId)return!1;const X=`${N.siteKey}::${N.videoId}`;return z.has(X)?!1:(z.add(X),!0)}),t.value=x.value.length>0}catch{x.value=[],t.value=!1}},r=ae(!1),n=ae(""),o=ae(!1),i={seq:0},c=()=>{i.seq+=1,r.value=!1},f=async(d=15*1e3)=>{const v=await sr("/api/user/sites",{cacheMs:d});return v&&typeof v=="object"?v:{}},g=()=>{var E,R,z,N;const d=p.bootstrap&&p.bootstrap.user&&p.bootstrap.user.role?String(p.bootstrap.user.role):"",v=((R=(E=p.bootstrap)==null?void 0:E.settings)==null?void 0:R.userCatPawOpenApiBase)||"",m=((N=(z=p.bootstrap)==null?void 0:z.settings)==null?void 0:N.catPawOpenApiBase)||"";return(d==="user"?v:v||m).trim()},y=d=>{const v=d&&typeof d.api=="string"?d.api:"",m=d&&typeof d.key=="string"?d.key:"";return v.includes("/spider/baseset/")||m.toLowerCase().includes("baseset")},C=d=>(d&&Array.isArray(d.list)?d.list:[]).map(m=>({id:m&&(m.vod_id!=null?String(m.vod_id):m.id!=null?String(m.id):""),name:m&&(m.vod_name!=null?String(m.vod_name):m.name!=null?String(m.name):""),pic:m&&(m.vod_pic!=null?String(m.vod_pic):m.pic!=null?String(m.pic):""),remark:m&&(m.vod_remarks!=null?String(m.vod_remarks):m.remark!=null?String(m.remark):"")})).filter(m=>m&&m.name),A=async()=>{var R,z,N,X;if(r.value)return;const d=(ne.value||p.videoTitle||"").trim(),v=e(d);if(!d||!v)return;i.seq+=1;const m=i.seq;r.value=!0,n.value="",o.value=!1,x.value=[];const E=()=>new Promise(Q=>{try{if(typeof window<"u"&&typeof window.requestAnimationFrame=="function"){window.requestAnimationFrame(()=>Q());return}}catch{}setTimeout(Q,0)});try{const Q=await f();if(m!==i.seq)return;const xe=(Array.isArray(Q&&Q.sites)?Q.sites:[]).filter(pt=>pt&&pt.enabled!==!1&&pt.api&&!y(pt)),Ce=g(),ye=((z=(R=p.bootstrap)==null?void 0:R.user)==null?void 0:z.username)||"";if(!Ce)throw new Error("CatPawOpen 接口地址未设置");const Fe=(X=(N=p.bootstrap)==null?void 0:N.settings)==null?void 0:X.searchThreadCount,Ke=Number(Fe),ze=Number.isFinite(Ke)&&Ke>0?Math.min(50,Math.floor(Ke)):5,rt=xe.slice(),ct=[],ut=new Set,dt=async()=>{for(;rt.length;){if(m!==i.seq)return;const pt=rt.shift();if(pt)try{const Zt=await kr({apiBase:Ce,username:ye,action:"search",spiderApi:pt.api,payload:{wd:d,page:1}});if(m!==i.seq)return;const mr=C(Zt);let or=!1;mr.forEach($t=>{if(m!==i.seq)return;const Gt=e($t.name);if(!Gt||Gt!==v)return;const Jt=pt&&pt.key?String(pt.key):"",qt=pt&&pt.api?String(pt.api):"",Qt=$t&&$t.id?String($t.id):"";if(!Jt||!qt||!Qt)return;const cr=`${Jt}::${Qt}`;if(ut.has(cr))return;ut.add(cr);const ur={siteKey:Jt,spiderApi:qt,siteName:pt&&pt.name?String(pt.name):Jt,videoId:Qt,videoTitle:$t&&$t.name?String($t.name):"",videoPoster:$t&&$t.pic?String($t.pic):"",videoRemark:$t&&$t.remark?String($t.remark):""};ct.push(ur),x.value.push(ur),or=!0}),or&&m===i.seq&&await E()}catch{}}};if(await Promise.allSettled(new Array(Math.max(1,ze)).fill(null).map(dt)),m!==i.seq)return;o.value=!0;try{sessionStorage.setItem(xa,JSON.stringify({q:d,key:v,createdAt:Date.now(),sources:ct}))}catch{}}catch(Q){m===i.seq&&(n.value=Q&&Q.message?String(Q.message):"换源搜索失败")}finally{m===i.seq&&(r.value=!1)}},H=()=>{try{s.value&&typeof s.value.destroy=="function"&&s.value.destroy(),de.value="",Me.value={},K.value=!1,window.dispatchEvent(new CustomEvent("tv:exit-play"))}catch{}},w=()=>{try{s.value&&typeof s.value.destroy=="function"&&s.value.destroy()}catch{}de.value="",Me.value={},K.value=!1,V.value=!1,Y.value="",_e.value="",ke.value="",ce.value=-1,q.value="",Z.value=!1,T.value=0,Et.value="",Pt.value=0,k.value=!1,Xe.value="",Qe.value=!1,st.value=null,P.value="",S.value=!1,J.value=(p.videoIntro||"").trim(),pe.value={title:"",poster:"",year:"",type:"",remark:"",content:"",playFrom:"",playUrl:""}},_=()=>{try{s.value&&typeof s.value.destroy=="function"&&s.value.destroy()}catch{}de.value="",Me.value={},K.value=!1,V.value=!1,Y.value="",_e.value="",ke.value="",ce.value=-1,q.value="",Z.value=!1,Et.value="",Pt.value=0,k.value=!1,S.value=!1,P.value="",pe.value={...pe.value,playFrom:"",playUrl:""}},M=[],$=ae(!1);pr(()=>{try{const d=typeof navigator<"u"&&navigator.userAgent?String(navigator.userAgent):"",v=typeof navigator<"u"&&typeof navigator.maxTouchPoints=="number"&&navigator.maxTouchPoints>0||typeof window<"u"&&"ontouchstart"in window,m=/iPad|iPhone|iPod/i.test(d)||!!v&&/Macintosh/i.test(d)&&(navigator.maxTouchPoints||0)>1;$.value=!!m}catch{$.value=!1}});const S=ae(!1),P=ae(""),J=ae((p.videoIntro||"").trim()),oe=ae(!1),me=ae(!1),Se=ae("episodes"),je=ae(!1),T=ae(0),V=ae(!1),Y=ae(""),_e=ae(""),Pe=ae(!1),se=ae(!1),de=ae(""),Me=ae({}),K=ae(!1),ke=ae(""),ce=ae(-1),G=ae(!1),q=ae(""),Z=ae(!1),O=ae(null),D=ae(null),ve=ae(!1),te=ae(!1),ue={seq:0,key:"",inFlight:null},pe=ae({title:"",poster:"",year:"",type:"",remark:"",content:"",playFrom:"",playUrl:""}),be=De(()=>{const d=(p.spiderApi||"").trim();if(d)return d;const v=(p.siteKey||"").trim();if(!v)return"";const E=(p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.homeSites)?p.bootstrap.settings.homeSites:[]).find(R=>R&&R.key===v);return E&&E.api?String(E.api):""}),Le=De(()=>{const d=(p.siteKey||"").trim();if(!d)return"";const m=(p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.homeSites)?p.bootstrap.settings.homeSites:[]).find(R=>R&&R.key===d);return(m&&m.name?String(m.name):"").trim()}),fe=De(()=>{const d=(p.siteKey||"").trim(),v=(p.videoId||"").trim(),E=(p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.homeSites)?p.bootstrap.settings.homeSites:[]).map(ie=>ie&&typeof ie.key=="string"?ie.key.trim():"").filter(ie=>ie),R=p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.searchSiteOrder)?p.bootstrap.settings.searchSiteOrder:[],z=E.length?E:R,N=new Map;z.forEach((ie,xe)=>{const Ce=typeof ie=="string"?ie.trim():"";Ce&&!N.has(Ce)&&N.set(Ce,xe)});const X=(x.value||[]).filter(ie=>!(ie.siteKey===d&&ie.videoId===v)).slice().sort((ie,xe)=>{const Ce=N.has(ie.siteKey)?N.get(ie.siteKey):999999,ye=N.has(xe.siteKey)?N.get(xe.siteKey):999999;return Ce!==ye?Ce-ye:(ie.siteName||ie.siteKey).localeCompare(xe.siteName||xe.siteKey,"zh")});return[{active:!0,siteKey:d,spiderApi:be.value,siteName:Le.value||"站点",videoId:v,title:ne.value||"未命名",poster:Te.value,remark:(pe.value.remark||p.videoRemark||"").trim()},...X.map(ie=>({active:!1,siteKey:ie.siteKey,spiderApi:ie.spiderApi,siteName:ie.siteName||ie.siteKey,videoId:ie.videoId,title:ie.videoTitle||"未命名",poster:ie.videoPoster||"",remark:(ie.videoRemark||"").trim()}))].filter(ie=>ie&&ie.siteKey&&ie.spiderApi&&ie.videoId)}),Re=d=>{if(!(!d||d.active))try{window.dispatchEvent(new CustomEvent("tv:open-play",{detail:{siteKey:d.siteKey||"",spiderApi:d.spiderApi||"",videoId:d.videoId||"",videoTitle:d.title||"",videoPoster:d.poster||"",videoRemark:d.remark||""}}))}catch{}},ne=De(()=>(pe.value.title||p.videoTitle||"").trim()),$e=De(()=>{const d=String(de.value||"").trim();if(!d)return"";try{return new URL(d,window.location.href).toString()}catch{return d}}),he=()=>{try{const d=s.value;if(d&&typeof d.pause=="function"){d.pause();return}}catch{}try{const d=document.getElementById("playerArea"),v=d?d.querySelector("video"):document.querySelector("#playerArea video");v&&typeof v.pause=="function"&&v.pause()}catch{}},Te=De(()=>(pe.value.poster||p.videoPoster||"").trim()),Xe=ae(""),Qe=ae(!1),st=ae(null);jt(()=>Te.value,d=>{if(Xe.value)return;const v=typeof d=="string"?d.trim():"";v&&(Xe.value=v)},{immediate:!0});const xt=()=>{var Q,ie;const d=(p.siteKey||"").trim(),v=(ie=(Q=p.bootstrap)==null?void 0:Q.settings)!=null&&ie.searchCoverSite?String(p.bootstrap.settings.searchCoverSite).trim():"",m=p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.searchSiteOrder)?p.bootstrap.settings.searchSiteOrder:[],E=new Map;m.forEach((xe,Ce)=>{const ye=typeof xe=="string"?xe.trim():"";ye&&!E.has(ye)&&E.set(ye,Ce)});const R=[];d&&Te.value&&R.push({siteKey:d,poster:Te.value}),(x.value||[]).forEach(xe=>{!xe||!xe.siteKey||!xe.videoPoster||R.push({siteKey:xe.siteKey,poster:xe.videoPoster})});const z=xe=>{const Ce=R.find(ye=>ye&&ye.siteKey===xe&&ye.poster);return Ce?Ce.poster:""};if(v){const xe=z(v);if(xe)return xe}const X=R.slice().sort((xe,Ce)=>{const ye=E.has(xe.siteKey)?E.get(xe.siteKey):999999,Fe=E.has(Ce.siteKey)?E.get(Ce.siteKey):999999;return ye-Fe}).find(xe=>xe&&xe.poster);return X?X.poster:Te.value||""},bt=async()=>{const d=st.value&&typeof st.value=="object"?st.value:null;if(d)try{await ir("/api/playhistory",{...d,videoPoster:Xe.value||d.videoPoster||"",forcePosterUpdate:!0},{dedupe:!1}),window.dispatchEvent(new CustomEvent("tv:play-history-updated"))}catch{}},ot=async(d={})=>{var N,X;const{force:v=!1,allowFallback:m=!1}=d||{};if(Qe.value)return;const E=(X=(N=p.bootstrap)==null?void 0:N.settings)!=null&&X.searchCoverSite?String(p.bootstrap.settings.searchCoverSite).trim():"";if(!v&&E&&!(x.value||[]).find(ie=>ie&&ie.siteKey===E&&ie.videoPoster))return;const R=xt(),z=typeof R=="string"?R.trim():"";if(!z){if(!m)return;const Q=Te.value||"";if(!Q)return;Xe.value=Q,Qe.value=!0;return}Xe.value=z,Qe.value=!0,await bt()},ht=De(()=>{const d=(p.siteKey||"").trim(),v=(be.value||"").trim(),m=(p.videoId||"").trim(),E=ne.value||"";return!!(d&&v&&m&&E)}),Ae={key:"",inFlight:null,seq:0},ge=async()=>{const d=(p.siteKey||"").trim(),v=(p.videoId||"").trim();if(!d||!v){se.value=!1;return}const m=`${d}::${v}`;if(Ae.inFlight&&Ae.key===m){await Ae.inFlight;return}let E=0;try{Ae.seq+=1,E=Ae.seq,Ae.key=m,Ae.inFlight=(async()=>{const R=await sr(`/api/favorites/status${Br({siteKey:d,videoId:v})}`,{cacheMs:2e3});E===Ae.seq&&(se.value=!!(R&&R.favorited))})(),await Ae.inFlight}catch{se.value=!1}finally{E&&Ae.key===m&&Ae.seq===E&&(Ae.inFlight=null)}},Ie=async()=>{if(!Pe.value&&ht.value){Pe.value=!0;try{const d=(p.siteKey||"").trim(),v=(be.value||"").trim(),m=(p.videoId||"").trim(),E=ne.value||"",R=await ir("/api/favorites/toggle",{siteKey:d,siteName:Le.value||"",spiderApi:v,videoId:m,videoTitle:E,videoPoster:Te.value||"",videoRemark:(p.videoRemark||"").trim()},{dedupe:!1});if(!R||R.success!==!0)throw new Error(R&&R.message||"保存失败");se.value=!!R.favorited,window.dispatchEvent(new CustomEvent("tv:favorites-updated"))}catch{}finally{Pe.value=!1}}},Je=De(()=>(pe.value.year||p.videoYear||"").trim()),L=d=>{const v=typeof d=="string"?d.trim():"";return v?v.split(/[,\s/|]+/g).map(m=>m.trim()).filter(Boolean):[]},B=De(()=>{const d=[],v=(pe.value.type||"").trim();v&&d.push(...L(v)),aa.value&&d.push(aa.value);const m=Je.value;m&&d.push(m);const E=Le.value;E&&d.push(E);const R=(pe.value.remark||p.videoRemark||"").trim();R&&d.push(R);const z=[],N=new Set;return d.forEach(X=>{const Q=X.toLowerCase();!X||N.has(Q)||(N.add(Q),z.push(X))}),z}),le=(d,v)=>{const m=typeof d=="string"?d.trim():"",E=typeof v=="string"?v.trim():"";if(!m&&!E)return[];const R=ye=>ye?ye.split("$$$"):[],z=R(m),N=R(E),X=Math.max(z.length,N.length),Q=[];for(let ye=0;ye<X;ye+=1){const Fe=(z[ye]||"").trim()||`源${ye+1}`,Ke=(N[ye]||"").trim();if(!Ke&&!Fe)continue;const ze=Fe.includes("|||")?Fe.split("|||").map(ut=>ut.trim()):[Fe],rt=Fe.includes("|||")&&Ke.includes("|||")?Ke.split("|||").map(ut=>ut.trim()):[Ke],ct=Math.max(ze.length,rt.length);for(let ut=0;ut<ct;ut+=1){const dt=(ze[ut]||"").trim()||(ct>1?`${Fe}-${ut+1}`:Fe),pt=(rt[ut]||"").trim();if(!pt)continue;const Zt=(Gt,Jt)=>{const qt=String(Gt||"").trim();if(!qt)return null;const Qt=qt.indexOf("$");if(Qt<=0)return{name:qt,url:qt,flag:Jt};const cr=qt.slice(0,Qt).trim(),ur=qt.slice(Qt+1).trim();return{name:cr||qt,url:ur||qt,flag:Jt}},mr=pt.split("#").map(Gt=>String(Gt||"").trim()).filter(Boolean),or=String(dt||"").trim(),$t=mr.map(Gt=>Zt(Gt,or)).filter(Boolean);Q.push({label:or,episodes:$t})}}const ie=ye=>{const Fe=typeof ye=="string"?ye.trim():"";return Fe?Fe.replace(/#\d{1,3}\s*$/i,"").trim():""},xe=new Map;Q.forEach(ye=>{const Fe=(ye&&ye.label?String(ye.label):"").trim(),Ke=ie(Fe)||Fe||"未知源",ze=Ke.toLowerCase(),rt=xe.get(ze),ct=ye&&Array.isArray(ye.episodes)?ye.episodes:[];if(!rt){xe.set(ze,{label:Ke,episodes:ct.slice()});return}const ut=new Set(rt.episodes.map(dt=>`${dt&&dt.flag||""}::${dt&&dt.url||""}`));ct.forEach(dt=>{const pt=`${dt&&dt.flag||""}::${dt&&dt.url||""}`;!dt||!dt.url||ut.has(pt)||(ut.add(pt),rt.episodes.push(dt))})});const Ce=[];return Array.from(xe.values()).forEach((ye,Fe)=>{const Ke=Array.isArray(ye.episodes)?ye.episodes.filter(ze=>ze&&ze.url):[];Ke.length&&Ce.push({key:`p${Fe}`,label:ye.label,episodes:Ke})}),Ce},re=De(()=>le(pe.value.playFrom,pe.value.playUrl)),Be=De(()=>{var d;return q.value||((d=re.value[0])==null?void 0:d.key)||""}),qe=De(()=>{if(S.value)return"加载中...";const d=re.value;if(!d.length)return"暂无数据";const v=d.find(m=>m&&m.key===Be.value);return(v&&v.label?String(v.label):d[0].label)||"暂无数据"}),mt=De(()=>{const d=re.value;if(!d.length)return"";const v=d.findIndex(m=>m&&typeof m.label=="string"&&m.label.includes("百度"));return v>=0?d[v].key:""});jt(()=>`${$.value?"1":"0"}|${re.value.length}|${q.value}`,()=>{if(!$.value||q.value)return;const d=mt.value;d&&(q.value=d)},{immediate:!0});const Ne=d=>{oe.value=!oe.value,me.value=!1;try{d&&d.currentTarget&&typeof d.currentTarget.blur=="function"&&d.currentTarget.blur()}catch{}},we=d=>{const v=typeof d=="string"?d:"";if(v){if(q.value=v,Z.value=!1,Et.value="",oe.value=!1,me.value=!1,ke.value&&ke.value===v&&ce.value>=0){const m=re.value.find(R=>R&&R.key===v)||null,E=m&&Array.isArray(m.episodes)?m.episodes.length:0;if(E&&ce.value<E){T.value=ce.value;return}}T.value=-1}},Ge=De(()=>{const d=re.value;if(!d.length)return null;const v=Be.value;return d.find(m=>m&&m.key===v)||d[0]||null}),Ye=De(()=>{const d=Ge.value;return d&&Array.isArray(d.episodes)?d.episodes:[]}),lt=d=>{const v=typeof d=="string"?d:"";if(!v)return[];if(!v.includes("***"))return[];const m=v.split("***").pop();return String(m||"").split("#").map(E=>String(E||"").trim()).filter(Boolean)},tt=De(()=>(p.bootstrap&&p.bootstrap.settings&&Array.isArray(p.bootstrap.settings.magicEpisodeRules)?p.bootstrap.settings.magicEpisodeRules:[]).map(v=>typeof v=="string"?v.trim():"").filter(Boolean)),nt=De(()=>{var m,E,R,z;const d=(E=(m=p.bootstrap)==null?void 0:m.settings)==null?void 0:E.magicEpisodeCleanRegexRules;if(Array.isArray(d))return d.map(N=>typeof N=="string"?N.trim():"").filter(Boolean);const v=((z=(R=p.bootstrap)==null?void 0:R.settings)==null?void 0:z.magicEpisodeCleanRegex)!=null?String(p.bootstrap.settings.magicEpisodeCleanRegex).trim():"";return v?[v]:[]}),St=d=>{const v=typeof d=="string"?d:"";return v?v.replace(/\\\\(?=[dDsSwWbB.()[\]{}+*?^$|\\\-_/])/g,"\\"):""},Kt=De(()=>{const d=Array.isArray(nt.value)?nt.value:[];if(!d.length)return[];const v=(m,E)=>{const R=typeof m=="string"?m:"";if(!R)return null;const z=typeof E=="string"?E:"",N=z.includes("g")?z:`${z}g`;try{return new RegExp(St(R),N||"g")}catch{return null}};return d.map(m=>{const E=typeof m=="string"?m.trim():"";if(!E)return null;if(E.startsWith("/")&&E.lastIndexOf("/")>0){const z=E.lastIndexOf("/"),N=E.slice(1,z),X=E.slice(z+1)||"i";return v(N,X)}return v(E,"i")}).filter(Boolean)}),Yt=d=>{const v=typeof d=="string"?d.trim():"";if(!v)return null;const m=(z,N)=>{const X=typeof z=="string"?z:"";if(!X)return null;const Q=typeof N=="string"&&N?N:"i";try{return new RegExp(X,Q)}catch{return null}};if(v.startsWith("{")&&v.endsWith("}"))try{const z=JSON.parse(v);if(z&&typeof z=="object"&&typeof z.pattern=="string"){const N=m(z.pattern,z.flags);if(!N)return null;const X=typeof z.replace=="string"?z.replace:"",Q=X?X.replace(/\\(\d+)/g,"$$$1"):"";return{re:N,replace:Q}}}catch{}if(v.startsWith("/")&&v.lastIndexOf("/")>0){const z=v.lastIndexOf("/"),N=v.slice(1,z),X=v.slice(z+1),Q=m(N,X);return Q?{re:Q,replace:""}:null}const R=m(v,"i");return R?{re:R,replace:""}:null},Ht=De(()=>tt.value.map(Yt).filter(Boolean)),Lt=De(()=>Ht.value.length>0),Xt=De(()=>{const d=Ye.value;if(!d.length)return[];const v=Ht.value;if(!v.length)return d.map((z,N)=>({season:0,episode:N+1}));const m=Kt.value,E=z=>{const N=typeof z=="string"?z.trim():"";if(!N||!Array.isArray(m)||!m.length)return N;try{let X=N;return m.forEach(Q=>{Q&&(X=X.replace(Q,""))}),X.replace(/\s+/g," ").trim()}catch{return N}},R=z=>{const N=E(z);if(!N)return{season:0,episode:0};for(let X=0;X<v.length;X+=1){const Q=v[X],ie=Q&&Q.re?Q.re:null;if(!ie)continue;const xe=N.match(ie);if(!xe)continue;if(Q&&Q.replace){let rt="";try{rt=N.replace(ie,Q.replace)}catch{rt=""}const ct=rt.match(/(?:S(\d{1,2}))?\s*E(\d{1,3})/i);if(ct&&ct[2]){const ut=ct[1]?Number.parseInt(String(ct[1]),10):0,dt=Number.parseInt(String(ct[2]),10),pt=Number.isFinite(ut)&&ut>=0&&ut<=99?ut:0,Zt=Number.isFinite(dt)&&dt>=1&&dt<=99999?dt:0;if(Zt)return{season:pt,episode:Zt}}}const Ce=rt=>{const ut=(typeof rt=="string"?rt:String(rt||"")).match(/S(\d{1,2})/i);if(!ut||!ut[1])return 0;const dt=Number.parseInt(String(ut[1]),10);return Number.isFinite(dt)&&dt>=0&&dt<=99?dt:0},ye=(xe.length>2&&xe[2]!=null?String(xe[2]):"")||(xe.length>1&&xe[1]!=null?String(xe[1]):"")||String(xe[0]||""),Fe=Ce(xe.length>1?xe[1]:"")||Ce(ye)||Ce(xe[0]||"")||0,Ke=String(ye||"").trim().replace(/\D+/g,"");if(!Ke)continue;const ze=Number.parseInt(Ke,10);if(Number.isFinite(ze)&&ze>=1&&ze<=99999)return{season:Fe,episode:ze}}return{season:0,episode:0}};return d.map((z,N)=>{const X=[];if(z&&z.name!=null&&X.push(String(z.name)),z&&z.url!=null){const Q=lt(String(z.url));Q[0]&&X.push(Q[0])}for(let Q=0;Q<X.length;Q+=1){const ie=R(X[Q]);if(ie&&ie.episode)return ie}return{season:0,episode:0}})}),Tt=De(()=>{const d=Ye.value;if(!d.length)return[];const m=Xt.value,E=Lt.value,R=[];for(let z=0;z<d.length;z+=1){const N=d[z],X=(N&&N.url?String(N.url):"").trim(),Q=(N&&N.name?String(N.name):"").trim()||`第${z+1}集`,ie=m&&m[z]&&typeof m[z]=="object"?m[z]:{season:0,episode:0},xe=Number.isFinite(Number(ie.season))?Number(ie.season):0,Ce=Number.isFinite(Number(ie.episode))?Number(ie.episode):0;if(E){if(!Number.isFinite(Ce)||Ce<=0)continue;R.push({key:`${z}-${X}`,index:z,no:Ce,season:xe,name:Q,url:X})}else R.push({key:`${z}-${X}`,index:z,no:z+1,season:0,name:Q,url:X})}return R.length?E?(R.sort((z,N)=>{const X=Number.isFinite(z.season)?z.season:0,Q=Number.isFinite(N.season)?N.season:0;return X!==Q?X-Q:z.no===N.no?z.index-N.index:z.no-N.no}),je.value&&R.reverse(),R):je.value?R.slice().reverse():R:[]}),Rt=De(()=>{const d=Tt.value;if(!d.length)return[];const v=new Set;let m=!1;d.forEach(X=>{const Q=X&&Number.isFinite(Number(X.season))?Number(X.season):0;Q>0?v.add(Q):m=!0});const E=Array.from(v).sort((X,Q)=>X-Q);if(E.length<2)return[];const R=["","一","二","三","四","五","六","七","八","九","十"],z=X=>{const Q=Number(X);return!Number.isFinite(Q)||Q<=0?"未分季":Q<=10?`第${R[Q]}季`:`第${Q}季`},N=E.map(X=>({key:`S${X}`,season:X,label:z(X)}));return m&&N.push({key:"S0",season:0,label:"未分季"}),N}),Pt=ae(0);jt(()=>Rt.value.map(d=>d.key).join(","),()=>{const d=Rt.value;if(!d.length){Pt.value=0;return}d.some(m=>Number(m.season)===Number(Pt.value))||(Pt.value=Number(d[0].season)||0)},{immediate:!0});const fr=d=>{const v=Number(d);Number.isFinite(v)&&(Pt.value=v,Et.value="")},hr=De(()=>{const d=Tt.value;return Rt.value.length?d.filter(m=>Number(m.season)===Number(Pt.value)):d}),Nt=De(()=>{const d=Lt.value,v=hr.value;if(!v.length)return[];const m=(N,X)=>je.value?`${X}-${N}`:`${N}-${X}`;if(d){const N=v.reduce((xe,Ce)=>Ce&&Number.isFinite(Ce.no)?Math.max(xe,Ce.no):xe,0);if(!N)return[];const X=new Map;v.forEach(xe=>{const Ce=xe&&Number.isFinite(xe.no)?Number(xe.no):0;if(!Ce)return;const ye=Math.floor((Ce-1)/xr);X.set(ye,!0)});const ie=Array.from(X.keys()).sort((xe,Ce)=>xe-Ce).map(xe=>{const Ce=xe*xr+1,ye=Math.min(N,(xe+1)*xr);return{key:`g${Ce}-${ye}`,startNo:Ce,endNo:ye,label:m(Ce,ye)}});return je.value&&ie.reverse(),ie}const E=Ye.value.length;if(!E)return[];const R=[],z=Math.ceil(E/xr);for(let N=0;N<z;N+=1){const X=N*xr+1,Q=Math.min(E,(N+1)*xr),ie=`g${X}-${Q}`;R.push({key:ie,startNo:X,endNo:Q,label:m(X,Q)})}return je.value&&R.reverse(),R}),Et=ae(""),tr=De(()=>{var d;return Et.value||((d=Nt.value[0])==null?void 0:d.key)||""});jt(()=>String(Pt.value),()=>{Rt.value.length&&(Et.value="",ee())}),jt(()=>Nt.value.map(d=>d.key).join(","),()=>{const d=Nt.value;if(!d.length){Et.value="";return}const v=Et.value;if(!v)return;d.some(E=>E&&E.key===v)||(Et.value="")},{immediate:!0});const nr=De(()=>{const d=hr.value,v=Nt.value;if(!d.length||!v.length)return d;const m=v.find(E=>E.key===tr.value)||v[0];return m?d.filter(E=>E&&E.no>=m.startNo&&E.no<=m.endNo):d}),zt=ae(null),I=ae(null),k=ae(!1),h=ae(!1),b=ae([]),F=()=>{try{const d=zt.value,v=Nt.value;if(!d||!v.length){b.value=[];return}const m=d.scrollLeft,E=m+d.clientWidth,R=Array.from(d.querySelectorAll(".episode-group-btn")),z=[];R.forEach((N,X)=>{const Q=v[X];if(!Q)return;const ie=N.offsetLeft,xe=ie+N.offsetWidth;ie>=m&&xe<=E||z.push(Q)}),b.value=z}catch{b.value=[]}};let j=0;const ee=()=>{try{j&&cancelAnimationFrame(j),j=window.requestAnimationFrame(()=>{j=0,F()})}catch{}},Ee=d=>{Et.value=d;try{const v=zt.value;if(!v)return;const m=Nt.value.findIndex(R=>R.key===d);if(m<0)return;const E=v.querySelectorAll(".episode-group-btn")[m];E&&typeof E.scrollIntoView=="function"&&E.scrollIntoView({block:"nearest",inline:"center"}),ee()}catch{}},Oe=d=>{if(!d)return null;if(typeof d=="string"){const v=d.trim();if(!v)return null;try{return JSON.parse(v)}catch{return null}}return typeof d=="object"?d:null},Ue=d=>{const v=d&&Array.isArray(d.url)?d.url:[];return v.length<2?"":typeof v[1]=="string"?v[1].trim():String(v[1]??"").trim()},We=(d,v,m)=>{const E=typeof d=="string"?d.trim():"";if(!E)return"";const R=er(v);if(!R)return E;try{const z=new URL(E),N=(z.hostname||"").toLowerCase(),X=["127.0.0.1","0.0.0.0","localhost"],Q=new URL(R),ie=(Q.hostname||"").toLowerCase(),xe=X.includes(N),Ce=N&&ie&&N===ie,ye=z.port==="3006"&&Q.port!=="3006";if(!xe&&!(Ce&&ye))return E;const Fe=new URL(String(z.pathname||"/").replace(/^\//,""),R);Fe.search=z.search||"",Fe.hash=z.hash||"";const Ke=typeof m=="string"?m.trim():"";return Ke&&!Fe.searchParams.has("__tvuser")&&Fe.searchParams.set("__tvuser",Ke),Fe.toString()}catch{return E}},Ve=(d,v,m)=>{if(!d||typeof d!="object"||!Array.isArray(d.url))return d;const E={...d,url:d.url.slice()};for(let R=0;R<E.url.length;R+=2){const z=E.url[R+1];typeof z=="string"&&(E.url[R+1]=We(z,v,m)||z)}return E},Ze=d=>{const v=typeof d=="string"?d.trim():"";if(!v)return"";try{const m=new URL(v);return m.protocol!=="http:"&&m.protocol!=="https:"?"":(m.search="",m.hash="",m.toString().replace(/\/+$/g,""))}catch{return""}},at=d=>{const v=Array.isArray(d)?d:[],m=[],E=new Set;for(const R of v){const z=Ze(typeof R=="string"?R:R&&typeof R.base=="string"?R.base:"");if(!z||E.has(z))continue;const N=R&&typeof R=="object"&&typeof R.pans=="object"&&R.pans?R.pans:{},X=Object.prototype.hasOwnProperty.call(N,"baidu"),Q=Object.prototype.hasOwnProperty.call(N,"quark");m.push({base:z,pans:{baidu:X?!!N.baidu:!0,quark:Q?!!N.quark:!0}}),E.add(z)}return m},gt=(d,v,m="")=>{const E=typeof d=="string"?d.trim():"";if(!E)return"";try{const X=(new URL(E).hostname||"").toLowerCase();if(X==="baidupcs.com"||X.endsWith(".baidupcs.com"))return"baidu";if(X.endsWith(".quark.cn")||X==="quark.cn")return"quark"}catch{}const R=v&&typeof v=="object"?v:{},z=String(R.Referer||R.referer||"");return z.includes("pan.quark.cn")||z.includes("quark.cn")?"quark":""},At=d=>{const v=typeof d=="string"?d.trim():"";return v?v.includes("百度")?"baidu":v.includes("夸克")||v.toLowerCase().includes("quark")?"quark":"":""},Ct=(d,v)=>{const m=Ze(d),E=typeof v=="string"?v.trim():"";if(!m||!E)return"";const R=m.endsWith("/")?m:`${m}/`;try{return new URL(E.startsWith("./")?E:`./${E.replace(/^\//,"")}`,R).toString()}catch{return""}},Vt=d=>{const v=Ze(d);return v?`${v}/`:""},Ot=d=>{const v=String(d||"").trim();return v&&v.replace(/[^a-zA-Z0-9._-]+/g,"_").replace(/^_+|_+$/g,"")||"admin"},Mr=d=>{const v=typeof d=="string"?d.trim():"";if(!v)return"";let m=v;return m.startsWith("/")||(m=`/${m}`),m.endsWith("/")||(m=`${m}/`),m=m.replace(/\/{2,}/g,"/"),m},_a=d=>{const v=typeof d=="string"?d:"";return v?v.includes("夸克")?!0:v.toLowerCase().includes("quark"):!1},Yr=d=>new Promise(v=>setTimeout(v,d)),Ea=async(d,v)=>{const m=Number(d),E=Number.isFinite(m)?Math.max(1,Math.floor(m)):1;let R=null;for(let z=0;z<E;z+=1)try{return z===1&&await Yr(300),z===2&&await Yr(800),await v(z+1)}catch(N){R=N}throw R||new Error("retry failed")},Ca=async({apiBase:d,token:v,path:m})=>{const E=Vt(d);if(!E)throw new Error("openlist base invalid");const R=typeof v=="string"?v.trim():"";if(!R)throw new Error("openlist token missing");const z=typeof m=="string"?m:"";if(!z)throw new Error("openlist path missing");const N=new URL("api/fs/get",E).toString(),X=await fetch(N,{method:"POST",headers:{"Content-Type":"application/json",Authorization:R},credentials:"omit",body:JSON.stringify({path:z,password:"",page:1,per_page:0,refresh:!0})}),Q=await X.json().catch(()=>({})),ie=Q&&typeof Q.code=="number"?Q.code:0;if(X.ok&&ie===200){const ye=Q&&Q.data&&typeof Q.data.raw_url=="string"?Q.data.raw_url.trim():"";if(!ye)throw new Error("missing raw_url");return ye}const xe=Q&&Q.message?String(Q.message):`HTTP ${X.status}`,Ce=new Error(xe);throw Ce.status=X.status,Ce},Bt={selectedBase:"",selectedPan:"",inFlight:null,inFlightPan:""},$a=async(d,v=2*1024*1024,m=8e3)=>{const E=Ct(d,`speed?bytes=${encodeURIComponent(String(v))}&_=${Date.now()}`);if(!E)throw new Error("invalid speed url");const R=typeof AbortController<"u"?new AbortController:null,z=setTimeout(()=>{try{R&&R.abort()}catch{}},m),N=typeof performance<"u"&&performance.now?performance.now():Date.now();try{const X=await fetch(E,{method:"GET",mode:"cors",credentials:"omit",cache:"no-store",signal:R?R.signal:void 0});if(!X.ok)throw new Error(`speed http ${X.status}`);const Q=X.body;let ie=0;if(Q&&typeof Q.getReader=="function"){const ye=Q.getReader();for(;;){const{done:Fe,value:Ke}=await ye.read();if(Fe)break;Ke&&Ke.byteLength&&(ie+=Ke.byteLength)}}else{const ye=await X.arrayBuffer();ie=ye?ye.byteLength:0}const xe=typeof performance<"u"&&performance.now?performance.now():Date.now(),Ce=Math.max(.001,(xe-N)/1e3);return ie/Ce}finally{clearTimeout(z)}},ja=async(d="")=>{var z,N,X,Q;const v=at((N=(z=p.bootstrap)==null?void 0:z.settings)==null?void 0:N.goProxyServers);if(!v.length)return"";const m=typeof d=="string"?d.trim().toLowerCase():"",E=m==="baidu"||m==="quark"?v.filter(ie=>!!(ie&&ie.pans&&ie.pans[m])):v;if(!E.length)return"";if(!!!((Q=(X=p.bootstrap)==null?void 0:X.settings)!=null&&Q.goProxyAutoSelect))return E[0].base;if(Bt.selectedBase&&Bt.selectedPan===m)return Bt.selectedBase;if(Bt.inFlight&&Bt.inFlightPan===m)return await Bt.inFlight;Bt.inFlight=(async()=>{const ie=E.map(async Fe=>{const Ke=Fe&&Fe.base?Fe.base:"";if(!Ke)return{base:"",bps:0,ok:!1};try{const ze=await $a(Ke);return{base:Ke,bps:ze,ok:!0}}catch{return{base:Ke,bps:0,ok:!1}}}),Ce=(await Promise.all(ie)).filter(Fe=>Fe&&Fe.ok&&Fe.base).sort((Fe,Ke)=>(Ke.bps||0)-(Fe.bps||0))[0],ye=Ce&&Ce.base?Ce.base:E[0].base;return Bt.selectedBase=ye||"",Bt.selectedPan=m,Bt.selectedBase})(),Bt.inFlightPan=m;try{return await Bt.inFlight}finally{Bt.inFlightPan===m&&(Bt.inFlight=null,Bt.inFlightPan="")}},La=async({base:d,url:v,headers:m})=>{const E=Ze(d);if(!E)throw new Error("missing goProxy base");const R=typeof v=="string"?v.trim():"";if(!R)throw new Error("missing play url");const z={},N=m&&typeof m=="object"?m:{};["User-Agent","Referer","Cookie","Authorization"].forEach(ye=>{const Fe=N[ye]||N[ye.toLowerCase()];typeof Fe=="string"&&Fe.trim()&&(z[ye]=Fe.trim())});const X=Ct(E,"register");if(!X)throw new Error("invalid register url");const Q=await fetch(X,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:R,headers:z})}),ie=await Q.json().catch(()=>({}));if(!Q.ok){const ye=ie&&(ie.message||ie.error)?String(ie.message||ie.error):"request failed",Fe=new Error(ye);throw Fe.status=Q.status,Fe}const xe=ie&&ie.token?String(ie.token).trim():"";if(!xe)throw new Error("missing token");const Ce=Ct(E,encodeURIComponent(xe));if(!Ce)throw new Error("invalid proxy url");return{token:xe,proxyUrl:Ce}},Aa=async(d,v,m="",E=!1)=>{if(!E)return{url:d,headers:v};const R=gt(d,v,m);if(!R)return{url:d,headers:v};const z=await ja(R);if(!z)return{url:d,headers:v};const{proxyUrl:N}=await La({base:z,url:d,headers:v});return{url:N,headers:{}}},Ut={seq:0,inFlightKey:"",inFlight:null},Zr=async()=>{const d=be.value,v=Ge.value,m=Ye.value,E=T.value,R=m[E],z=R&&R.flag?String(R.flag):v&&v.label?String(v.label):"",N=R&&R.url?String(R.url):"";if(!d||!z||!N)return;const X=`${d}::${Be.value}::${E}::${z}::${N}`;if(Ut.inFlight&&Ut.inFlightKey===X){await Ut.inFlight;return}const Q=Be.value,ie=E,xe=R&&R.name?String(R.name):"",Ce=(()=>{const Ke=R&&typeof R.url=="string"?R.url:"";if(Ke){const ze=lt(Ke);if(ze&&ze[0])return String(ze[0]||"").trim()}return xe?String(xe).trim():""})();Ut.seq+=1;const ye=Ut.seq;Ut.inFlightKey=X;const Fe=(async()=>{var Ke,ze,rt,ct,ut,dt,pt,Zt,mr,or,$t,Gt,Jt,qt,Qt,cr,ur,oa,ia,la,ca,ua;V.value=!0,Y.value="",_e.value="",de.value="",Me.value={},K.value=!1;try{const dr=p.bootstrap&&p.bootstrap.user&&p.bootstrap.user.role?String(p.bootstrap.user.role):"",_r=((ze=(Ke=p.bootstrap)==null?void 0:Ke.settings)==null?void 0:ze.userCatPawOpenApiBase)||"",Ir=((ct=(rt=p.bootstrap)==null?void 0:rt.settings)==null?void 0:ct.catPawOpenApiBase)||"",da=(dr==="user"?_r:_r||Ir).trim(),Dr=((dt=(ut=p.bootstrap)==null?void 0:ut.user)==null?void 0:dt.username)||"",pa=!!((Zt=(pt=p.bootstrap)==null?void 0:pt.settings)!=null&&Zt.openListQuarkTvMode)&&_a(v&&v.label?String(v.label):"")&&!!((or=(mr=p.bootstrap)==null?void 0:mr.settings)!=null&&or.openListApiBase)&&!!((Gt=($t=p.bootstrap)==null?void 0:$t.settings)!=null&&Gt.openListToken)&&!!((qt=(Jt=p.bootstrap)==null?void 0:Jt.settings)!=null&&qt.openListQuarkTvMount)&&!!Ce,Hr=async Mt=>{const It=await kr({apiBase:da,username:Dr,action:"play",spiderApi:d,payload:{flag:z,id:N},query:Mt&&typeof Mt=="object"?Mt:void 0}),br=Ve(It,da,Dr),Dt=Oe(br),wr=Ue(Dt),ha=Dt&&Dt.header&&typeof Dt.header=="object"?Dt.header:{},zr=!!(Dt&&typeof Dt=="object"&&Dt.proxyHint===!0);return{raw:It,payload:Dt,url:wr,rawHeaders:ha,proxyHintFromPayload:zr}};let rr=await Hr(pa?{quark_tv:"1"}:void 0);if(!rr.url){ye===Ut.seq&&(Y.value="无可用播放地址");return}const Oa=!!((cr=(Qt=p.bootstrap)==null?void 0:Qt.settings)!=null&&cr.goProxyEnabled)||rr.proxyHintFromPayload;let gr=rr.url,yr=rr.rawHeaders,fa=!1;if(pa){const Mt=String(((oa=(ur=p.bootstrap)==null?void 0:ur.settings)==null?void 0:oa.openListApiBase)||""),It=String(((la=(ia=p.bootstrap)==null?void 0:ia.settings)==null?void 0:la.openListToken)||""),br=String(((ua=(ca=p.bootstrap)==null?void 0:ca.settings)==null?void 0:ua.openListQuarkTvMount)||""),Dt=`TV_Server_${Ot(Dr)}`,wr=Mr(br),zr=(typeof Ce=="string"?Ce.trim():"").replace(/^\/+|\/+$/g,""),qa=`${wr}${Dt}/${zr}`.replace(/\/{2,}/g,"/").replace(/\/+$/g,"");let Er="";try{Er=await Ea(3,async()=>await Ca({apiBase:Mt,token:It,path:qa}))}catch{Er=""}let Cr=null;if(!Er)try{Cr=await Hr({quark_tv:"0"})}catch{}if(Er)gr=Er,yr={},fa=!0;else if(Cr&&Cr.url)gr=Cr.url,yr=Cr.rawHeaders||{};else try{rr=await Hr(void 0),rr&&rr.url&&(gr=rr.url,yr=rr.rawHeaders||{})}catch{}}try{const Mt=At(v&&v.label?String(v.label):""),It=await Aa(gr,yr,Mt,Oa&&!fa);It&&typeof It=="object"&&(typeof It.url=="string"&&It.url.trim()&&(gr=It.url.trim()),It.headers&&typeof It.headers=="object"&&(yr=It.headers))}catch(Mt){console.warn("[GoProxy] register failed:",Mt&&Mt.message?Mt.message:Mt)}if(ye!==Ut.seq)return;K.value=!1,de.value=gr,Me.value=yr,ke.value=Q,ce.value=ie;try{const Mt=(p.siteKey||"").trim(),It=(d||"").trim(),br=(p.videoId||"").trim(),Dt=ne.value||"";if(Mt&&It&&br&&Dt){const wr={siteKey:Mt,siteName:Le.value||"",spiderApi:It,videoId:br,videoTitle:Dt,videoPoster:Xe.value||xt()||"",videoRemark:(p.videoRemark||"").trim(),panLabel:(v&&v.label?String(v.label):"").trim(),playFlag:z,episodeIndex:ie>=0?ie:0,episodeName:xe};st.value=wr,await ir("/api/playhistory",{...wr},{dedupe:!1}),window.dispatchEvent(new CustomEvent("tv:play-history-updated"))}}catch{}}catch(dr){const _r=dr&&typeof dr.status=="number"?dr.status:0,Ir=dr&&dr.message||"请求失败";ye===Ut.seq&&(Y.value=_r?`HTTP ${_r}：${Ir}`:Ir)}finally{ye===Ut.seq&&(V.value=!1)}})();Ut.inFlight=Fe;try{await Fe}finally{Ut.inFlight===Fe&&(Ut.inFlight=null)}},Ma=()=>{K.value=!0},Ia=d=>{try{const v=d&&d.message?String(d.message):"";_e.value=v||"播放失败"}catch{_e.value="播放失败"}},vr=De(()=>V.value?"play_url":Y.value||_e.value?"error":S.value?"detail":P.value&&!de.value?"error":de.value&&!K.value?"play_info":de.value&&K.value?"ready":"idle"),Ta=De(()=>vr.value==="detail"||vr.value==="play_url"||vr.value==="play_info"),Pa=De(()=>{switch(vr.value){case"detail":return"视频加载中...";case"play_url":return"获取播放地址...";case"play_info":return"获取播放信息...";case"error":return _e.value||Y.value||P.value||"请求失败";case"idle":return"待播放";default:return"加载中..."}}),Jr=async()=>{ve.value=!1,te.value=!1,D.value=null;const d=(p.siteKey||"").trim(),v=(p.videoId||"").trim();if(!d||!v){ve.value=!0;return}const m=`${d}::${v}`;if(ue.inFlight&&ue.key===m){await ue.inFlight;return}ue.seq+=1;const E=ue.seq;ue.key=m;try{ue.inFlight=(async()=>{try{try{const X=await sr(`/api/playhistory/one${Br({siteKey:d,videoId:v})}`,{cacheMs:2e3});if(E!==ue.seq)return;if(X&&X.siteKey===d&&X.videoId===v){D.value=X;return}if(X==null){D.value=null;return}}catch{}const R=await sr(`/api/playhistory${Br({limit:50})}`,{cacheMs:2e3});if(E!==ue.seq)return;const N=(Array.isArray(R)?R:[]).find(X=>X&&X.siteKey===d&&X.videoId===v)||null;D.value=N}catch{E===ue.seq&&(D.value=null)}})(),await ue.inFlight}catch{E===ue.seq&&(D.value=null)}finally{E===ue.seq&&(ve.value=!0),ue.key===m&&ue.seq===E&&(ue.inFlight=null)}};jt(()=>x.value.length,async d=>{if(d){if(t.value){await ot({force:!0,allowFallback:!0});return}await ot({force:!1,allowFallback:!1})}}),jt(()=>o.value,async d=>{d&&(Qe.value||!x.value||!x.value.length||await ot({force:!0,allowFallback:!0}))}),jt(()=>[S.value,ve.value?"1":"0",Be.value,Ye.value.length,T.value].join("|"),()=>{if(!G.value&&!S.value&&ve.value&&Ye.value.length){if(!te.value&&ve.value&&D.value){const d=q.value,v=T.value,m=typeof D.value.panLabel=="string"?D.value.panLabel.trim():"",E=D.value.episodeIndex!=null?Number(D.value.episodeIndex):0,R=Number.isFinite(E)&&E>=0?Math.floor(E):0,z=xe=>String(xe||"").trim().replace(/#\d{1,3}\s*$/i,"").trim().toLowerCase();let N=null;if(m){const xe=z(m);N=re.value.find(Ce=>Ce&&z(Ce.label)===xe)||null,N&&N.key&&(q.value=N.key)}const X=N||Ge.value||null,Q=X&&Array.isArray(X.episodes)?X.episodes.length:0,ie=Q>0?Math.max(0,Math.min(R,Q-1)):0;if(T.value=ie,te.value=!0,d!==q.value||v!==T.value)return}T.value<0&&(T.value=0),G.value=!0,Zr()}}),jt(()=>[Lt.value?"1":"0",S.value?"1":"0",P.value?"1":"0",Be.value,Ye.value.length,Tt.value.length].join("|"),()=>{if(!S.value&&!P.value){if(!Lt.value){me.value&&(me.value=!1,oe.value=!1);return}if(Ye.value.length&&Tt.value.length===0){oe.value=!0,me.value=!0,T.value=-1;return}me.value&&Tt.value.length&&(oe.value=!1,me.value=!1)}},{immediate:!0}),jt(()=>[p.siteKey,p.videoId].join("|"),()=>{ge()},{immediate:!0}),jt(()=>[Be.value,Ye.value.length,T.value].join("|"),()=>{var xe;if(!Ye.value.length){Et.value="";return}const v=T.value,m=Xt.value,E=Lt.value,R=Number.isFinite(v)&&v>=0&&m&&m[v]&&typeof m[v]=="object"?m[v]:{episode:0},z=Number.isFinite(Number(R.episode))?Number(R.episode):0,N=E&&z>0?z:(Number.isFinite(v)&&v>=0?v:0)+1,X=Nt.value,Q=X.find(Ce=>N>=Ce.startNo&&N<=Ce.endNo),ie=Q&&Q.key||((xe=X[0])==null?void 0:xe.key)||"";ie&&ie!==Et.value&&(Et.value=ie),ee()});const Ba=De(()=>{const d=re.value;if(!d.length)return 0;let v=0;return d.forEach(m=>{const E=m&&Array.isArray(m.episodes)?m.episodes.length:0;E>v&&(v=E)}),v}),Qr=De(()=>{const d=pe.value.playFrom!=null?String(pe.value.playFrom):"",v=pe.value.playUrl!=null?String(pe.value.playUrl):"",m=`${d} ${v}`.toUpperCase();return/(2160P|2160|4K)/.test(m)?"4K":/(1080P|1080)/.test(m)?"1080P":/(720P|720)/.test(m)?"720P":""}),ea=De(()=>{if(!oe.value)return[];const d=Ye.value;return d.length?d.map((v,m)=>{const E=v&&v.url!=null?String(v.url):"",z=(lt(E)[0]||(v&&v.name!=null?String(v.name):"")||"").trim()||`第${m+1}集`;return{key:`${m}-${E}`,index:m,text:z}}):[]}),Nr=d=>{const v=Number(d);if(!(!Number.isFinite(v)||v<0)){if(ke.value&&ke.value===Be.value&&ce.value===v&&de.value){T.value=v;return}T.value=v,Zr()}},Fa=d=>{const v=m=>m?((m.vod_content!=null?String(m.vod_content):"")||(m.content!=null?String(m.content):"")||(m.desc!=null?String(m.desc):"")||"").trim():"";return d?Array.isArray(d.list)&&d.list[0]?v(d.list[0]):d.data&&Array.isArray(d.data.list)&&d.data.list[0]?v(d.data.list[0]):d.vod?v(d.vod):"":""},Ra=d=>{const m=d&&Array.isArray(d.list)&&d.list[0]||d&&d.data&&Array.isArray(d.data.list)&&d.data.list[0]||d&&d.vod||null||{},E=ye=>(m&&m[ye]!=null?String(m[ye]):"").trim(),R=E("vod_name")||E("name")||E("title"),z=E("vod_pic")||E("pic")||E("poster"),N=E("vod_year")||E("year"),X=E("vod_class")||E("vod_type")||E("type_name")||E("type"),Q=E("vod_remarks")||E("remark"),ie=E("vod_content")||E("content")||E("desc"),xe=E("vod_play_from")||E("play_from")||E("vod_playfrom")||E("vod_play_froms"),Ce=E("vod_play_url")||E("play_url")||E("vod_playurl")||E("vod_play_urls");return{title:R,poster:z,year:N,type:X,remark:Q,content:ie,playFrom:xe,playUrl:Ce}},Ft={key:"",seq:0,inFlight:null},ta=()=>{const d=e(p.videoTitle||""),v=String(p.videoYear||"").trim(),m=String(p.searchType||"").trim();return[d,v,m].join("|")};let ra=ta();const Or=async(d={})=>{var ie,xe;const{updateIntro:v=!1,updateMeta:m=!1}=d&&typeof d=="object"?d:{},E=(p.videoId||"").trim();if(!E)return;const R=(be.value||"").trim();if(!R)return;const z=g(),N=((xe=(ie=p.bootstrap)==null?void 0:ie.user)==null?void 0:xe.username)||"",X=`${z}::${N}::${R}::${E}`;if(Ft.inFlight&&Ft.key===X){await Ft.inFlight;return}Ft.seq+=1;const Q=Ft.seq;Ft.key=X,v&&(S.value=!0,P.value=""),Ft.inFlight=(async()=>{try{const Ce=await kr({apiBase:z,username:N,action:"detail",spiderApi:R,payload:{id:E}});if(Q!==Ft.seq)return;const ye=Ra(Ce),Fe=pe.value&&typeof pe.value=="object"?pe.value:{},Ke=!!m,ze=!Fe.title||!Fe.poster||!Fe.year,rt={...Fe,playFrom:ye.playFrom,playUrl:ye.playUrl};if((Ke||ze)&&(ye.title&&(rt.title=ye.title),ye.poster&&(rt.poster=ye.poster),ye.year&&(rt.year=ye.year),ye.type&&(rt.type=ye.type),ye.remark&&(rt.remark=ye.remark),ye.content&&(rt.content=ye.content)),pe.value=rt,v||!J.value){const ct=(ye.content||Fa(Ce)||J.value||"").trim();ct&&(J.value=ct)}}catch(Ce){const ye=Ce&&typeof Ce.status=="number"?Ce.status:0,Fe=Ce&&Ce.message||"请求失败";v&&Q===Ft.seq&&(P.value=ye?`HTTP ${ye}：${Fe}`:Fe)}finally{v&&Q===Ft.seq&&(S.value=!1),Ft.key===X&&Ft.seq===Q&&(Ft.inFlight=null)}})(),await Ft.inFlight},aa=De(()=>{switch((p.searchType||"").trim()){case"movie":return"电影";case"tv":return"电视剧";case"anime":return"动漫";case"show":return"综艺";default:return""}}),sa=d=>{if(!Z.value)return;const v=O.value;v&&d&&d.target&&v.contains(d.target)||(Z.value=!1)},na=d=>{Z.value&&d&&d.key==="Escape"&&(Z.value=!1)},qr=d=>{if(!k.value)return;const v=I.value;v&&d&&d.target&&v.contains(d.target)||(k.value=!1)},Na=()=>{h.value&&(k.value=!0)};return pr(()=>{Lo(),Jr(),u();try{const d=typeof navigator<"u"&&navigator.userAgent||"",v=/iPhone|iPod/i.test(d),m=document.getElementById("playPage");if(v&&m){let E=!1,R=0,z=0,N=!1;const X=20,Q=70,ie=Ke=>{const ze=Ke&&Ke.touches&&Ke.touches[0]?Ke.touches[0]:null;return ze?{x:ze.clientX||0,y:ze.clientY||0}:null},xe=Ke=>{const ze=ie(Ke);ze&&(R=ze.x,z=ze.y,E=R<=X,N=!1)},Ce=Ke=>{if(!E)return;const ze=ie(Ke);if(!ze)return;const rt=ze.x-R,ct=ze.y-z;if(!(rt<=0)){if(Math.abs(ct)>12&&Math.abs(ct)>Math.abs(rt)){E=!1,N=!1;return}if(rt>=Q&&rt>Math.abs(ct)*1.4){N=!0;try{Ke.preventDefault()}catch{}}}},ye=()=>{E=!1,N=!1},Fe=()=>{E&&N&&H(),ye()};m.addEventListener("touchstart",xe,{passive:!0}),m.addEventListener("touchmove",Ce,{passive:!1}),m.addEventListener("touchend",Fe,{passive:!0}),m.addEventListener("touchcancel",ye,{passive:!0}),M.push(()=>m.removeEventListener("touchstart",xe)),M.push(()=>m.removeEventListener("touchmove",Ce)),M.push(()=>m.removeEventListener("touchend",Fe)),M.push(()=>m.removeEventListener("touchcancel",ye))}}catch{}Or({updateIntro:!J.value,updateMeta:!0});try{const d=document.getElementById("playGrid"),v=document.getElementById("episodePanelResizer"),m=document.getElementById("episodePanel");if(d&&v&&m){const E="tv_server_episode_panel_width";let R=!1,z=0,N=0,X=0,Q=0,ie=0;const xe=(ze,rt,ct)=>Math.max(rt,Math.min(ct,ze)),Ce=ze=>{const rt=xe(ze,220,520);ie=rt,d.style.setProperty("--episode-panel-width",`${rt}px`)};try{const ze=localStorage.getItem(E),rt=ze!=null?Number(ze):NaN;Number.isFinite(rt)&&rt>0&&Ce(rt)}catch{}const ye=ze=>{if(!R)return;const ct=(ze&&typeof ze.clientX=="number"?ze.clientX:0)-z;X=xe(N-ct,220,520),!Q&&(Q=window.requestAnimationFrame(()=>{Q=0,Ce(X)}))},Fe=()=>{if(R){R=!1,Q&&(window.cancelAnimationFrame(Q),Q=0);try{ie&&localStorage.setItem(E,String(ie))}catch{}document.body.style.userSelect="",document.body.style.cursor="",d.classList.remove("is-resizing"),m.classList.remove("is-resizing"),window.removeEventListener("mousemove",ye,!0),window.removeEventListener("mouseup",Fe,!0)}},Ke=ze=>{d.classList.contains("episode-panel-collapsed")||(R=!0,z=ze.clientX,N=m.getBoundingClientRect().width||280,document.body.style.userSelect="none",document.body.style.cursor="col-resize",d.classList.add("is-resizing"),m.classList.add("is-resizing"),window.addEventListener("mousemove",ye,!0),window.addEventListener("mouseup",Fe,!0))};v.addEventListener("mousedown",Ke),M.push(()=>{try{Fe()}catch{}v.removeEventListener("mousedown",Ke)})}}catch{}try{const d=document.getElementById("episodeButtons");if(d){const m=R=>Math.max(3,Math.min(10,R)),E=()=>{const R=d.clientWidth||0;if(!R)return;const z=window.getComputedStyle?window.getComputedStyle(d):null,N=z?parseFloat(z.columnGap||z.gap||"12"):12,X=m(Math.floor((R+N)/(44+N)));d.style.setProperty("--episode-cols",String(X))};if(E(),window.addEventListener("resize",E),M.push(()=>window.removeEventListener("resize",E)),typeof ResizeObserver<"u"){const R=new ResizeObserver(()=>E());R.observe(d),M.push(()=>R.disconnect())}}}catch{}document.addEventListener("mousedown",sa,!0),document.addEventListener("keydown",na,!0),document.addEventListener("mousedown",qr,!0),M.push(()=>document.removeEventListener("mousedown",qr,!0));try{const d=document.getElementById("playerArea")||document.querySelector(".play-video-ratio"),v=document.getElementById("episodePanel");if(d&&v&&typeof ResizeObserver<"u"){const m=()=>{try{if(window.innerWidth<768){v.style.removeProperty("height");return}const R=d.getBoundingClientRect().height;if(!R)return;v.style.height=`${Math.round(R)}px`}catch{}};m(),window.requestAnimationFrame(()=>m()),window.requestAnimationFrame(()=>window.requestAnimationFrame(()=>m()));const E=new ResizeObserver(()=>m());E.observe(d),window.addEventListener("resize",m),M.push(()=>E.disconnect()),M.push(()=>window.removeEventListener("resize",m))}}catch{}try{const d=zt.value;if(d){const v=()=>ee(),m=()=>ee();if(window.addEventListener("resize",v),d.addEventListener("scroll",m,{passive:!0}),M.push(()=>window.removeEventListener("resize",v)),M.push(()=>d.removeEventListener("scroll",m)),typeof ResizeObserver<"u"){const E=new ResizeObserver(()=>v());E.observe(d),M.push(()=>E.disconnect())}ee()}}catch{}try{const d=()=>{h.value=!0,document.removeEventListener("mousemove",d,!0)};document.addEventListener("mousemove",d,!0),M.push(()=>document.removeEventListener("mousemove",d,!0))}catch{}try{const d=v=>{const m=v&&v.detail?Number(v.detail.delta):0;if(!Number.isFinite(m)||m===0)return;const E=Ye.value.length;if(!E)return;const R=Math.max(0,Math.min(E-1,T.value+(m>0?1:-1)));R!==T.value&&Nr(R)};window.addEventListener("tvplayer:episode",d),M.push(()=>window.removeEventListener("tvplayer:episode",d))}catch{}}),jt(()=>ne.value,()=>{r.value||u()}),jt(()=>Se.value,d=>{d==="sources"&&(r.value||x.value&&x.value.length||o.value||A())}),jt(()=>[p.siteKey,p.videoId].join("|"),()=>{G.value=!1,ue.seq+=1,Ft.seq+=1;const d=ta(),v=!!d&&d!==ra;ra=d,c(),o.value=!1,n.value="";const m=Number.isFinite(T.value)?Math.floor(T.value):0;v?(w(),u(),Or({updateIntro:!0,updateMeta:!0})):(_(),T.value=m>=0?m:0,Or({updateIntro:!1,updateMeta:!1})),Jr()}),Sr(()=>{c(),ue.seq+=1;try{j&&cancelAnimationFrame(j),j=0}catch{}M.splice(0).forEach(d=>{try{d()}catch{}}),document.removeEventListener("mousedown",sa,!0),document.removeEventListener("keydown",na,!0),document.removeEventListener("mousedown",qr,!0)}),jt(()=>re.value.map(d=>d.key).join(","),()=>{var m;const d=((m=re.value[0])==null?void 0:m.key)||"";if(!d){q.value="";return}if(!q.value){q.value=d;return}re.value.some(E=>E&&E.key===q.value)||(q.value=d)}),(d,v)=>(U(),W("main",Fi,[l("div",Ri,[l("div",Ni,[l("div",Oi,[l("button",{type:"button",class:"tv-icon-btn","aria-label":"返回",onClick:H},[...v[6]||(v[6]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"m15 18-6-6 6-6"})],-1)])]),l("div",qi,[l("h1",Di,[l("span",Hi,He(a.videoTitle),1)]),l("button",{type:"button",class:yt(["tv-icon-btn flex-shrink-0",se.value?"text-pink-600 dark:text-pink-400 border-pink-200/60 dark:border-pink-500/30":""]),disabled:Pe.value||!ht.value,"aria-label":"收藏/取消收藏",onClick:Ie},[se.value?(U(),W("svg",Vi,[...v[7]||(v[7]=[vt('<defs><linearGradient id="tvFavGradTop" x1="2" y1="4" x2="22" y2="22" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fb7185"></stop><stop offset="0.55" stop-color="#ec4899"></stop><stop offset="1" stop-color="#a855f7"></stop></linearGradient></defs><path fill-rule="evenodd" clip-rule="evenodd" fill="url(#tvFavGradTop)" d="M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 0 1-1.344-.728 25.18 25.18 0 0 1-3.67-3.295 24.257 24.257 0 0 1-3.168-4.269c-.63-1.001-.839-2.145-.73-3.253.108-1.108.532-2.166 1.235-3.048a4.793 4.793 0 0 1 3.462-1.795c1.567-.08 3.113.582 4.084 1.816.97-1.234 2.517-1.896 4.084-1.816a4.793 4.793 0 0 1 3.462 1.795c.703.882 1.127 1.94 1.235 3.048.109 1.108-.1 2.252-.73 3.253a24.257 24.257 0 0 1-3.168 4.269 25.18 25.18 0 0 1-3.67 3.295 15.247 15.247 0 0 1-1.344.728l-.022.012-.007.003a.752.752 0 0 1-.704 0Z"></path>',2)])])):(U(),W("svg",Ui,[...v[8]||(v[8]=[l("path",{d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"},null,-1)])]))],10,zi)])])]),l("div",Wi,[v[21]||(v[21]=vt('<div class="hidden lg:flex justify-end"><button id="episodePanelToggle" class="group relative flex items-center space-x-1.5 px-3 py-1.5 rounded-full bg-white/80 hover:bg-white dark:bg-gray-800/80 dark:hover:bg-gray-800 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 shadow-sm hover:shadow-md transition-all duration-200" type="button" title="隐藏选集面板"><svg id="episodePanelToggleIcon" class="w-3.5 h-3.5 text-gray-500 dark:text-gray-400 transition-transform duration-200 rotate-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg><span id="episodePanelToggleLabel" class="text-xs font-medium text-gray-600 dark:text-gray-300">隐藏</span><div id="episodePanelToggleDot" class="absolute -top-0.5 -right-0.5 w-2 h-2 rounded-full transition-all duration-200 bg-green-400"></div></button></div>',1)),l("div",Ki,[l("div",Xi,[l("div",Gi,[l("div",Yi,[de.value?(U(),Gr(Ci,{key:0,ref_key:"drPlayerRef",ref:s,url:de.value,poster:Te.value,headers:Me.value,title:ne.value,autoplay:!0,onLoadedmetadata:Ma,onError:Ia},null,8,["url","poster","headers","title"])):(U(),W("div",Zi)),vr.value!=="ready"?(U(),W("div",{key:2,class:yt(["play-player-overlay",{"play-player-overlay--error":vr.value==="error"}])},[l("div",Ji,[v[9]||(v[9]=l("svg",{class:"play-player-overlay__icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14 3H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14 3v6h6"})],-1)),l("div",Qi,He(Pa.value),1),Ta.value?(U(),W("div",el)):wt("",!0)])],2)):wt("",!0)])]),Tr(Bi,{url:$e.value,title:ne.value,onOpen:he},null,8,["url","title"])]),l("div",tl,[v[17]||(v[17]=l("div",{id:"episodePanelResizer",class:"episode-resizer","aria-hidden":"true"},null,-1)),l("div",rl,[l("div",al,[l("button",{id:"tabEpisodes",type:"button",class:yt(["flex-1 py-3 px-6 text-center cursor-pointer transition-all duration-200 font-medium",Se.value==="episodes"?"text-green-600 dark:text-green-400":"text-gray-700 hover:text-green-600 bg-black/5 dark:bg-white/5 dark:text-gray-300 dark:hover:text-green-400 hover:bg-black/3 dark:hover:bg-white/3"]),onClick:v[0]||(v[0]=m=>Se.value="episodes")}," 选集 ",2),l("button",{id:"tabSources",type:"button",class:yt(["flex-1 py-3 px-6 text-center cursor-pointer transition-all duration-200 font-medium",Se.value==="sources"?"text-green-600 dark:text-green-400":"text-gray-700 hover:text-green-600 bg-black/5 dark:bg-white/5 dark:text-gray-300 dark:hover:text-green-400 hover:bg-black/3 dark:hover:bg-white/3"]),onClick:v[1]||(v[1]=m=>Se.value="sources")}," 换源 ",2)]),kt(l("div",sl,[l("div",nl,[l("div",ol,[l("div",{ref_key:"panDropdownEl",ref:O,class:"custom-dropdown play-pan-dropdown"},[l("button",{type:"button",class:"custom-dropdown-btn play-pan-btn",disabled:re.value.length===0,onClick:v[2]||(v[2]=m=>Z.value=!Z.value)},He(qe.value),9,il),l("div",{class:yt(["custom-dropdown-list",{hidden:!Z.value}])},[(U(!0),W(ft,null,_t(re.value,m=>(U(),W("div",{key:m.key,class:yt(["custom-dropdown-item",{active:m.key===Be.value}]),role:"option",onClick:E=>we(m.key)},He(m.label),11,ll))),128)),re.value.length===0?(U(),W("div",cl,He(S.value?"加载中...":"暂无数据"),1)):wt("",!0)],2)],512)]),l("button",{id:"rawListBtn",type:"button",class:"episode-control episode-control--btn flex-shrink-0","data-active":oe.value?"true":"false",onClick:Ne},He(oe.value?"返回选集":"原始列表"),9,ul)]),kt(l("div",dl,[l("div",pl,[Rt.value.length?(U(),W("div",fl,[l("div",hl,[(U(!0),W(ft,null,_t(Rt.value,m=>(U(),W("button",{key:m.key,type:"button",class:"episode-season-btn","data-active":Number(m.season)===Number(Pt.value)?"true":"false",onClick:E=>fr(m.season)},He(m.label),9,vl))),128))])])):wt("",!0),l("div",ml,[l("div",{ref_key:"episodeGroupTabsEl",ref:zt,class:"episode-group-tabs",onScrollPassive:F},[(U(!0),W(ft,null,_t(Nt.value,m=>(U(),W("button",{key:m.key,type:"button",class:"episode-group-btn","data-active":m.key===tr.value?"true":"false",onClick:E=>Ee(m.key)},He(m.label),9,gl))),128))],544),kt(l("div",{class:"episode-group-more",ref_key:"episodeGroupMoreEl",ref:I,onMouseleave:v[4]||(v[4]=m=>k.value=!1)},[l("div",{class:"episode-group-more__btn",role:"button",tabindex:"0",onMouseenter:Na,onClick:v[3]||(v[3]=m=>k.value=!k.value)},[...v[10]||(v[10]=[l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],32),l("div",{class:yt(["episode-group-more__menu",{"episode-group-more__menu--open":k.value}])},[(U(!0),W(ft,null,_t(Nt.value,m=>(U(),W("button",{key:m.key,type:"button",class:"episode-group-more__item","data-active":m.key===tr.value?"true":"false",onClick:E=>{Ee(m.key),k.value=!1}},He(m.label),9,yl))),128))],2)],544),[[Wt,b.value.length]])])]),l("button",{id:"episodeSortBtn",type:"button",class:"flex-shrink-0 w-8 h-8 rounded-md flex items-center justify-center text-gray-700 hover:text-green-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:text-green-400 dark:hover:bg-white/20 transition-colors transform translate-y-[-4px]","aria-label":"切换集数排序",onClick:v[5]||(v[5]=m=>je.value=!je.value)},[...v[11]||(v[11]=[l("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})],-1)])])],512),[[Wt,!oe.value]]),kt(l("div",bl,[S.value?(U(),W("div",wl,[...v[12]||(v[12]=[l("div",{class:"tv-spinner","aria-hidden":"true"},null,-1),l("div",{class:"tv-center-loading__text"},"加载中...",-1)])])):P.value?(U(),W("div",xl,He(P.value),1)):ea.value.length===0?(U(),W("div",kl,"暂无原始列表")):(U(),W("div",Sl,[(U(!0),W(ft,null,_t(ea.value,m=>(U(),W("button",{key:m.key,type:"button",class:yt(["raw-list__row",{"raw-list__row--active":m.index===T.value}]),title:m.text,onClick:E=>Nr(m.index)},[l("span",El,He(m.text),1)],10,_l))),128))]))],512),[[Wt,oe.value]]),kt(l("div",Cl,[S.value?(U(),W("div",$l,[...v[13]||(v[13]=[l("div",{class:"tv-episode-overlay__inner"},[l("div",{class:"tv-spinner","aria-hidden":"true"}),l("div",{class:"tv-center-loading__text"},"加载中...")],-1)])])):P.value?(U(),W("div",jl,[l("div",Ll,[l("div",Al,He(P.value),1)])])):(U(),W(ft,{key:2},[nr.value.length?(U(!0),W(ft,{key:0},_t(nr.value,m=>(U(),W("button",{key:m.key,type:"button",class:yt(["episode-num-btn flex items-center justify-center text-sm font-medium rounded-md transition-all duration-200 whitespace-nowrap font-mono",m.index===T.value?"bg-green-500 text-white shadow-lg shadow-green-500/25 dark:bg-green-600":"bg-gray-200 text-gray-700 hover:bg-gray-300 hover:scale-105 dark:bg-white/10 dark:text-gray-300 dark:hover:bg-white/20"]),title:m.name,onClick:E=>Nr(m.index)},He(m.no),11,Ml))),128)):(U(),W("div",Il,[...v[14]||(v[14]=[l("div",{class:"tv-episode-overlay__inner"},[l("div",{class:"tv-center-loading__text"},"暂无选集")],-1)])]))],64))],512),[[Wt,!oe.value]])],512),[[Wt,Se.value==="episodes"]]),kt(l("div",Tl,[l("div",Pl,[(U(!0),W(ft,null,_t(fe.value,m=>(U(),W("div",{key:`${m.siteKey}::${m.videoId}`,class:yt(["source-card flex items-start gap-3 px-2 py-3 rounded-lg transition-all select-none duration-200 relative",m.active?"source-card--active":"source-card--idle"]),onClick:E=>m.active?null:Re(m)},[l("div",Fl,[m.poster?(U(),W("img",{key:0,src:m.poster,alt:m.title,loading:"lazy",decoding:"async",referrerpolicy:"no-referrer",class:"w-full h-full object-cover"},null,8,Rl)):(U(),W("div",Nl))]),l("div",Ol,[l("div",ql,[l("div",Dl,[l("h3",Hl,He(m.title||"未命名"),1)]),m.active&&Qr.value?(U(),W("div",zl,He(Qr.value),1)):wt("",!0)]),m.remark?(U(),W("div",Vl,[l("span",{class:"inline-flex max-w-full items-center truncate bg-orange-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-md shadow-sm",title:m.remark},He(m.remark),9,Ul)])):(U(),W("div",Wl)),l("div",Kl,[l("span",Xl,He(m.siteName||"站点"),1),l("span",Gl,He(m.active?`${Ba.value} 集`:"—"),1)])])],10,Bl))),128)),r.value||n.value||o.value||fe.value.length<=1?(U(),W("div",Yl,[r.value?(U(),W(ft,{key:0},[v[15]||(v[15]=l("div",{class:"tv-spinner","aria-hidden":"true"},null,-1)),v[16]||(v[16]=l("span",null,"正在加载...",-1))],64)):n.value?(U(),W("span",Zl,He(n.value),1)):(U(),W("span",Jl,"暂无更多"))])):wt("",!0)])],512),[[Wt,Se.value==="sources"]])])])]),l("div",Ql,[l("div",ec,[l("div",tc,[l("div",rc,[v[18]||(v[18]=l("div",{class:"play-detail__posterSkeleton","aria-hidden":"true"},null,-1)),Te.value?(U(),W("img",{key:0,src:Te.value,alt:ne.value,loading:"lazy",decoding:"async",referrerpolicy:"no-referrer",class:"play-detail__posterImg"},null,8,ac)):(U(),W("div",sc," 暂无封面 "))])]),l("div",nc,[l("div",oc,[l("h1",ic,[l("span",lc,He(ne.value||"未命名"),1)]),l("button",{type:"button",class:yt(["play-detail__favBtn",se.value?"is-active":""]),disabled:Pe.value||!ht.value,"aria-label":"收藏/取消收藏",onClick:Ie},[se.value?(U(),W("svg",uc,[...v[19]||(v[19]=[l("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 0 1-1.344-.728 25.18 25.18 0 0 1-3.67-3.295 24.257 24.257 0 0 1-3.168-4.269c-.63-1.001-.839-2.145-.73-3.253.108-1.108.532-2.166 1.235-3.048a4.793 4.793 0 0 1 3.462-1.795c1.567-.08 3.113.582 4.084 1.816.97-1.234 2.517-1.896 4.084-1.816a4.793 4.793 0 0 1 3.462 1.795c.703.882 1.127 1.94 1.235 3.048.109 1.108-.1 2.252-.73 3.253a24.257 24.257 0 0 1-3.168 4.269 25.18 25.18 0 0 1-3.67 3.295 15.247 15.247 0 0 1-1.344.728l-.022.012-.007.003a.752.752 0 0 1-.704 0Z"},null,-1)])])):(U(),W("svg",dc,[...v[20]||(v[20]=[l("path",{d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"},null,-1)])]))],10,cc)]),B.value.length?(U(),W("div",pc,[(U(!0),W(ft,null,_t(B.value,m=>(U(),W("span",{key:m,class:"play-pill"},He(m),1))),128))])):wt("",!0),l("div",fc,[S.value?(U(),W(ft,{key:0},[Pr("简介加载中...")],64)):!J.value&&P.value?(U(),W(ft,{key:1},[Pr(He(P.value),1)],64)):(U(),W(ft,{key:2},[Pr(He(J.value||"暂无简介"),1)],64))])])])])])])]))}},vc={class:"card"},mc={class:"brand"},gc={class:"field"},yc={class:"field"},bc={key:0,class:"error"},wc=["disabled"],xc={class:"footer"},kc={__name:"LoginPage",props:{bootstrap:{type:Object,required:!0}},setup(a){const p=typeof window<"u"&&window.__TV_SERVER_VERSION__||"V1.0.0",s=ae(""),x=ae(""),t=ae(""),e=ae(!1),u=async()=>{t.value="";const r=(s.value||"").trim(),n=x.value||"";if(!r||!n){t.value="请输入用户名和密码";return}e.value=!0;try{const o=await Qa("/api/login",{username:r,password:n});if(o&&o.success){window.location.href="/";return}t.value=o&&o.message||"登录失败"}catch(o){t.value=o&&o.message?String(o.message):"网络错误"}finally{e.value=!1}};return(r,n)=>(U(),W("div",vc,[l("div",mc,He(a.bootstrap.siteName),1),l("form",{id:"loginForm",onSubmit:it(u,["prevent"])},[l("div",gc,[kt(l("input",{class:"input","onUpdate:modelValue":n[0]||(n[0]=o=>s.value=o),name:"username",type:"text",placeholder:"输入用户名",autocomplete:"username"},null,512),[[ar,s.value]])]),l("div",yc,[kt(l("input",{class:"input","onUpdate:modelValue":n[1]||(n[1]=o=>x.value=o),name:"password",type:"password",placeholder:"输入访问密码",autocomplete:"current-password"},null,512),[[ar,x.value]])]),t.value?(U(),W("div",bc,He(t.value),1)):wt("",!0),l("button",{type:"submit",class:"btn",disabled:e.value},He(e.value?"登录中...":"登录"),9,wc)],32),l("div",xc,[l("span",null,He(et(p)),1),n[2]||(n[2]=Pr(" 已是最新",-1))])]))}},Sc=Rr(kc,[["__scopeId","data-v-a6e11f94"]]),_c={key:0,class:"min-h-screen w-full flex items-center justify-center p-6 bg-gradient-to-b from-[#e6f2fb] via-[#f8f9fa] to-[#f2f4f7]"},Ec={key:1,class:"app-shell w-full min-h-screen"},Cc={class:"hidden md:flex absolute top-4 right-6 z-[1100] items-center gap-4 top-actions"},$c={class:"relative"},jc={id:"userMenu",class:"user-menu hidden"},Lc={class:"user-menu__header"},Ac={class:"font-semibold text-gray-800"},Mc={class:"user-menu__badge"},Ic={key:0,id:"managePanelLink",class:"user-menu__item",href:"/dashboard"},Tc={class:"user-menu__footer"},Pc={class:"text-xs text-gray-500"},Bc={class:"min-h-[48px] flex items-center justify-between px-4"},Fc={class:"flex items-center gap-2"},Rc={class:"relative"},Nc={class:"tv-mobile-user-menu absolute right-0 mt-2 rounded-lg border border-gray-200/80 bg-white/95 shadow-lg backdrop-blur-xl overflow-hidden z-[1201] dark:border-white/10 dark:bg-[#0f172a]/95"},Oc={class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"},qc={class:"flex md:grid md:grid-cols-[auto_1fr] w-full min-h-screen md:min-h-auto"},Dc={class:"tv-sidebar-panel md:w-auto md:max-w-none"},Hc={class:"relative min-w-0 flex-1 transition-all duration-300"},zc={id:"homePage",class:"content-main flex-1 md:min-h-0 mb-14 md:mb-0 md:mt-0",style:{"padding-top":"var(--tv-topbar-h, calc(3rem + env(safe-area-inset-top)))","padding-bottom":"calc(3.5rem + env(safe-area-inset-bottom))"}},Vc={class:"px-2 sm:px-10 py-4 sm:py-8 overflow-visible"},Uc=["data-douban-data-proxy","data-douban-data-custom","data-douban-img-proxy","data-douban-img-custom","data-cat-api-base","data-user-role","data-user-cat-api-base","data-tv-user","data-search-thread-count","data-search-site-order","data-search-cover-site","data-magic-aggregate-rules"],Wc={class:"w-full"},Kc={id:"homeDoubanSections"},Xc={class:"tv-section"},Gc={class:"tv-section-head"},Yc={class:"tv-section"},Zc={class:"tv-section-head"},Jc={class:"tv-section"},Qc={class:"tv-section-head"},eu={class:"tv-section"},tu={class:"tv-section-head"},ru={class:"md:hidden"},au={id:"homeMobileBottomNav",class:"md:hidden fixed left-0 right-0 z-[600] bg-white/90 backdrop-blur-xl border-t border-gray-200/50 overflow-hidden",style:{bottom:"0","padding-bottom":"env(safe-area-inset-bottom)","min-height":"calc(3.5rem + env(safe-area-inset-bottom))"}},su={class:"flex items-center overflow-x-auto scrollbar-hide"},nu={class:"flex-shrink-0",style:{width:"20vw","min-width":"20vw"}},ou={class:"flex-shrink-0",style:{width:"20vw","min-width":"20vw"}},iu={class:"flex-shrink-0",style:{width:"20vw","min-width":"20vw"}},lu={class:"flex-shrink-0",style:{width:"20vw","min-width":"20vw"}},cu={id:"adminPage",class:"hidden w-full min-h-screen bg-gray-50 dark:bg-[#0b1220]"},uu={class:"flex min-h-screen"},du={class:"flex-1 flex flex-col"},pu={class:"flex-1 overflow-y-auto p-6 space-y-6"},fu={id:"adminSite",class:"admin-panel"},hu={class:"space-y-4"},vu=["placeholder"],Ur="tv_server_last_site_key",mu="tv_server_last_site_name",Wr="tv_server_home_view",gu={__name:"IndexPage",props:{bootstrap:{type:Object,required:!0}},setup(a){const s=a.bootstrap,x=typeof window<"u"&&window.__TV_SERVER_VERSION__||"V1.0.0",t=ae(!1);let e=0,u=!1;const r=ae(null),n=ae(!1),o=ae(!1),i=ae("home"),c=ae({kind:"home",siteName:""}),f=ae(0),g=ae({videoTitle:"",videoYear:"",searchType:"",siteKey:"",spiderApi:"",videoId:"",videoIntro:"",videoPoster:"",videoRemark:""});function y(G){window.dispatchEvent(new CustomEvent("tv:home-view",{detail:{view:G}}))}function C(){try{localStorage.setItem(Ur,"home"),localStorage.setItem(Wr,"home")}catch{}t.value=!1,i.value="home",y("home")}function A(G){const q=typeof G=="string"?G.trim():"";if(q){try{localStorage.setItem(Ur,"home"),localStorage.setItem(Wr,`douban:${q}`)}catch{}t.value=!1,i.value="home",y(`douban:${q}`)}}function H(){t.value=!1,i.value="search",y("search")}function w(){t.value=!1,i.value="favorites",y("fav")}function _(){t.value=!1,i.value="history",y("history")}function M(){o.value=!1,n.value=!n.value}function $(){n.value=!1,o.value=!o.value}function S(){o.value=!1;try{window.dispatchEvent(new CustomEvent("tv:open-user-settings"))}catch{}}const P=De(()=>{if((c.value&&c.value.kind?String(c.value.kind):"home")==="site"){const Z=(c.value&&typeof c.value.siteName=="string"?c.value.siteName:"").trim();if(Z)return Z}return(s&&s.siteName?String(s.siteName):"").trim()}),J=()=>{try{if(typeof window>"u")return;if((localStorage.getItem(Wr)||"").trim().startsWith("douban:")){c.value={kind:"douban",siteName:""},i.value="home";return}const q=(localStorage.getItem(Ur)||"").trim();if(q&&q!=="home"){let Z=(localStorage.getItem(mu)||"").trim();if(!Z){const O=typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(q):q.replace(/"/g,'\\"'),D=document.querySelector(`#tvSidebarDrawer [data-site-key="${O}"] .nav-label`);D&&D.textContent&&(Z=String(D.textContent).trim())}c.value={kind:"site",siteName:Z||q},i.value="";return}c.value={kind:"home",siteName:""},i.value="home"}catch{}},oe=()=>{if(t.value=!1,!u)return;const G=e;u=!1,e=0,ga(()=>{try{requestAnimationFrame(()=>window.scrollTo(0,G))}catch{try{window.scrollTo(0,G)}catch{}}})},me=G=>{const q=t.value;!q&&typeof window<"u"&&(e=window.scrollY||window.pageYOffset||0,u=!0);const Z=G&&G.detail&&typeof G.detail=="object"?G.detail:{};g.value={videoTitle:typeof Z.videoTitle=="string"?Z.videoTitle:"",videoYear:typeof Z.videoYear=="string"?Z.videoYear:"",searchType:typeof Z.searchType=="string"?Z.searchType:"",siteKey:typeof Z.siteKey=="string"?Z.siteKey:"",spiderApi:typeof Z.spiderApi=="string"?Z.spiderApi:"",videoId:typeof Z.videoId=="string"?Z.videoId:"",videoIntro:typeof Z.videoIntro=="string"?Z.videoIntro:"",videoPoster:typeof Z.videoPoster=="string"?Z.videoPoster:"",videoRemark:typeof Z.videoRemark=="string"?Z.videoRemark:""},f.value+=1,t.value=!0,q||ga(()=>{try{requestAnimationFrame(()=>window.scrollTo(0,0))}catch{try{window.scrollTo(0,0)}catch{}}})};pr(()=>{!s||!s.authenticated||(Ha(),Is(),J(),!(typeof window>"u")&&(window.addEventListener("tv:open-play",me),window.addEventListener("tv:exit-play",oe),window.addEventListener("tv:home-view",oe)))});let Se=null,je=null,T=null,V=null,Y=null,_e=null,Pe=null,se=null,de=null,Me=null,K=null;const ke=()=>{try{if(typeof window>"u"||!window.matchMedia||!window.matchMedia("(max-width: 767.98px)").matches)return;const G=document.getElementById("tvSidebarDrawer");if(!G)return;const q=G.querySelector(".tv-sidebar-panel");if(!q)return;const Z=window.innerWidth||0;if(!Z)return;const O=q.clientWidth||0,D=Math.ceil(Z*.33);let ve=Math.max(O||0,D);const te=24;q.querySelectorAll(".nav-label").forEach(fe=>{const Re=fe&&typeof fe.clientWidth=="number"?fe.clientWidth:0,ne=fe&&typeof fe.scrollWidth=="number"?fe.scrollWidth:0;if(!Re||!ne||ne<=Re)return;const $e=fe.closest(".nav-item"),he=$e&&typeof $e.clientWidth=="number"?$e.clientWidth:0,Xe=Math.max(0,he-Re)+ne+te;ve=Math.max(ve,Xe)});const pe=q.querySelector("#desktopSidebar .brand-box span");if(pe&&typeof pe.scrollWidth=="number"){const fe=pe.scrollWidth||0;fe&&(ve=Math.max(ve,fe+48))}const be=Math.ceil(ve/Z*100),Le=Math.min(70,Math.max(33,be));G.style.setProperty("--tv-drawer-w",`${Le}vw`)}catch{}},ce=()=>{try{const G=r.value;if(!G)return;const q=G.offsetHeight||0;document.documentElement.style.setProperty("--tv-topbar-h",`${q}px`)}catch{}};return jt(t,()=>{try{requestAnimationFrame(()=>ce())}catch{ce()}}),pr(()=>{if(typeof window>"u")return;ce();try{r.value&&typeof ResizeObserver<"u"&&(Se=new ResizeObserver(()=>ce()),Se.observe(r.value))}catch{Se=null}window.addEventListener("resize",ce,{passive:!0}),window.addEventListener("orientationchange",ce,{passive:!0}),window.addEventListener("resize",ke,{passive:!0}),window.addEventListener("orientationchange",ke,{passive:!0}),K=()=>{if(n.value)try{requestAnimationFrame(()=>ke())}catch{ke()}},window.addEventListener("tv:sidebar-sites-updated",K),je=Z=>{const O=Z&&Z.target?Z.target:null;if(!O||!O.closest){o.value=!1,n.value=!1;return}O.closest('[aria-label="用户菜单"]')||O.closest(".tv-mobile-user-menu")||(o.value=!1,n.value&&!O.closest('[aria-label="菜单"]')&&!O.closest("#tvSidebarDrawer .tv-sidebar-panel")&&(n.value=!1))},window.addEventListener("click",je);const G={active:!1,moved:!1,x:0,y:0,isOutside:!1},q=Z=>!Z||!Z.closest?!0:Z.closest('[aria-label="菜单"]')?!1:!Z.closest("#tvSidebarDrawer .tv-sidebar-panel");V=Z=>{if(!n.value)return;const O=Z&&Z.target?Z.target:null;q(O)&&(G.active=!0,G.moved=!1,G.isOutside=!0,G.x=typeof Z.clientX=="number"?Z.clientX:0,G.y=typeof Z.clientY=="number"?Z.clientY:0)},Y=Z=>{if(!G.active||!G.isOutside)return;const O=(typeof Z.clientX=="number"?Z.clientX:0)-G.x,D=(typeof Z.clientY=="number"?Z.clientY:0)-G.y;Math.abs(O)+Math.abs(D)>10&&(G.moved=!0)},_e=()=>{if(!G.active||!G.isOutside)return;const Z=!G.moved;G.active=!1,G.isOutside=!1,G.moved=!1,Z&&setTimeout(()=>{n.value=!1},0)},document.addEventListener("pointerdown",V,{capture:!0}),document.addEventListener("pointermove",Y,{capture:!0}),document.addEventListener("pointerup",_e,{capture:!0}),document.addEventListener("pointercancel",_e,{capture:!0}),Pe=Z=>{if(!n.value)return;const O=Z&&Z.target?Z.target:null;if(!q(O))return;const ve=Z.touches&&Z.touches[0]?Z.touches[0]:null;G.active=!0,G.moved=!1,G.isOutside=!0,G.x=ve&&typeof ve.clientX=="number"?ve.clientX:0,G.y=ve&&typeof ve.clientY=="number"?ve.clientY:0},se=Z=>{if(!G.active||!G.isOutside)return;const O=Z.touches&&Z.touches[0]?Z.touches[0]:null,D=O&&typeof O.clientX=="number"?O.clientX:0,ve=O&&typeof O.clientY=="number"?O.clientY:0,te=D-G.x,ue=ve-G.y;Math.abs(te)+Math.abs(ue)>10&&(G.moved=!0)},de=()=>{if(!G.active||!G.isOutside)return;const Z=!G.moved;G.active=!1,G.isOutside=!1,G.moved=!1,Z&&setTimeout(()=>{n.value=!1},0)},Me=()=>{G.active=!1,G.isOutside=!1,G.moved=!1},document.addEventListener("touchstart",Pe,{capture:!0,passive:!0}),document.addEventListener("touchmove",se,{capture:!0,passive:!0}),document.addEventListener("touchend",de,{capture:!0,passive:!0}),document.addEventListener("touchcancel",Me,{capture:!0,passive:!0}),T=Z=>{const O=Z&&Z.detail&&typeof Z.detail=="object"?Z.detail:{},D=typeof O.kind=="string"?O.kind.trim():"",ve=typeof O.siteName=="string"?O.siteName:"";D&&(c.value={kind:D,siteName:ve},D==="home"||D==="douban"?i.value="home":D==="search"?i.value="search":D==="favorites"?i.value="favorites":D==="history"?i.value="history":D==="site"&&(i.value=""),n.value=!1)},window.addEventListener("tv:mobile-context",T)}),jt(n,G=>{if(G)try{requestAnimationFrame(()=>ke())}catch{ke()}},{immediate:!0}),Sr(()=>{typeof window>"u"||(window.removeEventListener("tv:open-play",me),window.removeEventListener("tv:exit-play",oe),window.removeEventListener("tv:home-view",oe))}),Sr(()=>{try{Se&&Se.disconnect()}catch{}if(Se=null,!(typeof window>"u")){window.removeEventListener("resize",ce),window.removeEventListener("orientationchange",ce),window.removeEventListener("resize",ke),window.removeEventListener("orientationchange",ke),je&&window.removeEventListener("click",je),T&&window.removeEventListener("tv:mobile-context",T),K&&window.removeEventListener("tv:sidebar-sites-updated",K);try{V&&document.removeEventListener("pointerdown",V,!0)}catch{}try{Y&&document.removeEventListener("pointermove",Y,!0)}catch{}try{_e&&document.removeEventListener("pointerup",_e,!0)}catch{}try{_e&&document.removeEventListener("pointercancel",_e,!0)}catch{}try{Pe&&document.removeEventListener("touchstart",Pe,!0)}catch{}try{se&&document.removeEventListener("touchmove",se,!0)}catch{}try{de&&document.removeEventListener("touchend",de,!0)}catch{}try{Me&&document.removeEventListener("touchcancel",Me,!0)}catch{}je=null,T=null,K=null,V=null,Pe=null,Y=null,_e=null,se=null,de=null,Me=null}}),(G,q)=>!et(s)||!et(s).authenticated?(U(),W("div",_c,[Tr(Sc,{bootstrap:et(s)||{}},null,8,["bootstrap"])])):(U(),W("div",Ec,[l("div",Cc,[q[10]||(q[10]=vt('<button id="themeToggleBtn" class="top-action-btn" aria-label="切换主题" type="button"><svg class="theme-icon sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2m0 16v2m10-10h-2M4 12H2m15.364-7.364-1.414 1.414M8.05 17.95l-1.414 1.414m12.728 0-1.414-1.414M8.05 6.05 6.636 4.636"></path></svg><svg class="theme-icon moon hidden" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z"></path></svg></button>',1)),l("div",$c,[q[9]||(q[9]=l("button",{id:"userMenuBtn",class:"top-action-btn","aria-label":"用户菜单",type:"button"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-user"},[l("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),l("circle",{cx:"12",cy:"7",r:"4"})])],-1)),l("div",jc,[l("div",Lc,[l("div",null,[q[4]||(q[4]=l("div",{class:"text-xs text-gray-500"},"当前用户",-1)),l("div",Ac,He(et(s).user.username),1)]),l("span",Mc,He(et(s).user.role==="admin"?"管理员":et(s).user.role==="shared"?"共享":"用户"),1)]),q[7]||(q[7]=l("button",{id:"userSettingsBtn",class:"user-menu__item",type:"button"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("circle",{cx:"12",cy:"12",r:"3"}),l("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 8 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H2a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 3.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 8 4.6a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z"})]),l("span",null,"设置")],-1)),et(s).user.role==="admin"?(U(),W("a",Ic,[...q[5]||(q[5]=[vt('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7 7"></path><path d="M12 11l1.5 1.5"></path><rect width="18" height="11" x="3" y="3" rx="2"></rect><path d="M7 7h.01"></path><path d="M17 7h.01"></path><path d="M3 11h11"></path></svg><span>管理面板</span>',2)])])):wt("",!0),q[8]||(q[8]=vt('<div class="user-menu__divider"></div><a class="user-menu__item danger" href="/logout"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 17h8"></path><path d="M13 7h8"></path><path d="M13 12h8"></path><path d="M3 7l6 5-6 5V7Z"></path></svg><span>登出</span></a>',2)),l("div",Tc,[l("span",Pc,He(et(x)),1),q[6]||(q[6]=l("span",{class:"status-dot"},null,-1))])])])]),kt(l("header",{ref_key:"mobileHeaderEl",ref:r,class:"md:hidden fixed top-0 left-0 right-0 z-[999] w-full bg-white/70 backdrop-blur-xl border-b border-gray-200/50 shadow-sm",style:{"padding-top":"env(safe-area-inset-top)"}},[l("div",Bc,[l("div",{class:"flex items-center gap-2"},[l("button",{type:"button",class:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 transition-colors","aria-label":"菜单",onClick:M},[...q[11]||(q[11]=[l("svg",{class:"w-full h-full",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])])]),l("div",Fc,[q[15]||(q[15]=l("div",{class:"w-10 h-10"},null,-1)),l("div",Rc,[l("button",{type:"button",class:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 transition-colors","aria-label":"用户菜单",onClick:it($,["stop"])},[...q[12]||(q[12]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-user w-full h-full"},[l("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),l("circle",{cx:"12",cy:"7",r:"4"})],-1)])]),kt(l("div",Nc,[l("button",{type:"button",class:"tv-mobile-user-item w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100/60 dark:text-gray-100 dark:hover:bg-white/10",onClick:S},[...q[13]||(q[13]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("circle",{cx:"12",cy:"12",r:"3"}),l("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09A1.65 1.65 0 0 0 8 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H2a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 3.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 8 4.6a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z"})],-1),l("span",null,"设置",-1)])]),q[14]||(q[14]=vt('<a class="tv-mobile-user-item w-full px-3 py-2 text-sm text-red-600 hover:bg-red-50/60 dark:text-red-400 dark:hover:bg-white/10" href="/logout"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 17h8"></path><path d="M13 7h8"></path><path d="M13 12h8"></path><path d="M3 7l6 5-6 5V7Z"></path></svg><span>登出</span></a>',1))],512),[[Wt,o.value]])])])]),l("div",Oc,[l("button",{type:"button",class:"text-2xl font-bold text-green-600 tracking-tight hover:opacity-80 transition-opacity max-w-[60vw] truncate",onClick:C},He(P.value),1)])],512),[[Wt,!t.value]]),l("div",qc,[l("div",{id:"tvSidebarDrawer",class:yt(["tv-sidebar-drawer z-[1200] md:z-auto",{"is-open":n.value}])},[l("div",Dc,[Tr(Es,{bootstrap:et(s),"active-page":t.value?"play":"home","site-nav-variant":"index","show-site-nav-overlays":""},null,8,["bootstrap","active-page"])])],2),l("div",Hc,[kt(l("div",null,[l("main",zc,[l("div",Vc,[l("div",{id:"homeDoubanConfig",class:"hidden","data-douban-data-proxy":et(s).settings.doubanDataProxy,"data-douban-data-custom":et(s).settings.doubanDataCustom,"data-douban-img-proxy":et(s).settings.doubanImgProxy,"data-douban-img-custom":et(s).settings.doubanImgCustom,"data-cat-api-base":et(s).user.role==="user"?et(s).settings.userCatPawOpenApiBase||"":et(s).settings.userCatPawOpenApiBase||et(s).settings.catPawOpenApiBase||"","data-user-role":et(s).user.role,"data-user-cat-api-base":et(s).settings.userCatPawOpenApiBase||"","data-tv-user":et(s).user.username,"data-search-thread-count":et(s).settings.searchThreadCount,"data-search-site-order":JSON.stringify(et(s).settings.searchSiteOrder||[]),"data-search-cover-site":et(s).settings.searchCoverSite||"","data-magic-aggregate-rules":JSON.stringify(et(s).settings.magicAggregateRules||[])},null,8,Uc),q[26]||(q[26]=l("div",{id:"homeSegToggle",class:"mb-8 flex justify-center"},[l("div",{class:"seg-toggle relative inline-flex bg-gray-300/80 rounded-full p-1"},[l("button",{id:"segHomeBtn",type:"button",class:"seg-btn active relative z-10 w-16 px-3 py-1 text-xs sm:w-20 sm:py-2 sm:text-sm rounded-full font-semibold transition-all duration-200 cursor-pointer text-gray-900"},"首页"),l("button",{id:"segFavBtn",type:"button",class:"seg-btn relative z-10 w-16 px-3 py-1 text-xs sm:w-20 sm:py-2 sm:text-sm rounded-full font-semibold transition-all duration-200 cursor-pointer text-gray-700 hover:text-gray-900"},"收藏夹")])],-1)),l("div",Wc,[q[24]||(q[24]=vt('<section id="homeContinueSection" class="tv-section hidden"><div class="tv-section-head"><h2 class="tv-section-title">继续观看</h2></div><div class="relative"><div id="homeContinueRow" class="tv-scroll-row" style="min-height:clamp(210px,35vw,380px);"></div></div></section><section id="homeFavoritesSection" class="tv-section hidden"><div class="tv-section-head px-4 sm:px-6"><h2 class="tv-section-title">收藏夹</h2></div><div class="px-4 sm:px-6"><div id="homeFavoritesGrid" class="douban-grid"></div><div id="homeFavoritesEmpty" class="hidden text-sm text-gray-500 dark:text-gray-400 py-10 text-center select-none">暂无收藏</div></div></section><div id="homeSiteSections" class="hidden"></div>',3)),l("div",Kc,[l("section",Xc,[l("div",Gc,[q[16]||(q[16]=l("h2",{class:"tv-section-title"},"热门电影",-1)),l("button",{type:"button",class:"more-link",onClick:q[0]||(q[0]=Z=>A("movie"))},"查看更多")]),q[17]||(q[17]=l("div",{class:"relative"},[l("div",{id:"homeHotMovieRow",class:"tv-scroll-row",style:{"min-height":"clamp(210px,35vw,380px)"}},[l("div",{class:"w-full flex items-center justify-center text-sm text-gray-400 dark:text-gray-500 select-none"}," 加载中... ")])],-1))]),l("section",Yc,[l("div",Zc,[q[18]||(q[18]=l("h2",{class:"tv-section-title"},"热门剧集",-1)),l("button",{type:"button",class:"more-link",onClick:q[1]||(q[1]=Z=>A("tv"))},"查看更多")]),q[19]||(q[19]=l("div",{class:"relative"},[l("div",{id:"homeHotTvRow",class:"tv-scroll-row",style:{"min-height":"clamp(210px,35vw,380px)"}},[l("div",{class:"w-full flex items-center justify-center text-sm text-gray-400 dark:text-gray-500 select-none"}," 加载中... ")])],-1))]),l("section",Jc,[l("div",Qc,[q[20]||(q[20]=l("h2",{class:"tv-section-title"},"新番放送",-1)),l("button",{type:"button",class:"more-link",onClick:q[2]||(q[2]=Z=>A("anime"))},"查看更多")]),q[21]||(q[21]=l("div",{class:"relative"},[l("div",{id:"homeBangumiRow",class:"tv-scroll-row",style:{"min-height":"clamp(210px,35vw,380px)"}},[l("div",{class:"w-full flex items-center justify-center text-sm text-gray-400 dark:text-gray-500 select-none"}," 加载中... ")])],-1))]),l("section",eu,[l("div",tu,[q[22]||(q[22]=l("h2",{class:"tv-section-title"},"热门综艺",-1)),l("button",{type:"button",class:"more-link",onClick:q[3]||(q[3]=Z=>A("show"))},"查看更多")]),q[23]||(q[23]=l("div",{class:"relative"},[l("div",{id:"homeHotShowRow",class:"tv-scroll-row",style:{"min-height":"clamp(210px,35vw,380px)"}},[l("div",{class:"w-full flex items-center justify-center text-sm text-gray-400 dark:text-gray-500 select-none"}," 加载中... ")])],-1))])]),q[25]||(q[25]=l("div",{id:"homeDoubanBrowse",class:"hidden"},[l("div",{class:"douban-browse-header"},[l("div",{class:"douban-browse-header__row"},[l("button",{id:"doubanBrowseBackBtn",type:"button",class:"tv-icon-btn hidden flex-shrink-0","aria-label":"返回"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"m15 18-6-6 6-6"})])]),l("div",{class:"min-w-0"},[l("div",{id:"doubanBrowseTitle",class:"douban-browse-title"},"电影"),l("div",{class:"douban-browse-subtitle"},"来自豆瓣的精选内容")])])]),l("div",{class:"douban-filter-panel"},[l("div",{class:"douban-filter-row"},[l("div",{class:"douban-filter-label"},"分类"),l("div",{id:"doubanFilterCategory",class:"douban-chip-group",role:"tablist"})]),l("div",{class:"douban-filter-row"},[l("div",{id:"doubanFilterSecondaryLabel",class:"douban-filter-label"},"地区"),l("div",{id:"doubanFilterArea",class:"douban-chip-group",role:"tablist"})])]),l("div",{id:"doubanBrowseStatus",class:"douban-browse-status hidden"},"加载中..."),l("div",{id:"doubanBrowseGrid",class:"douban-grid douban-browse-grid"})],-1))])])]),q[27]||(q[27]=vt('<main id="searchPage" class="content-main flex-1 md:min-h-0 mb-14 md:mb-0 md:mt-0 hidden" style="padding-top:var(--tv-topbar-h, calc(3rem + env(safe-area-inset-top)));padding-bottom:calc(3.5rem + env(safe-area-inset-bottom));"><div class="px-4 sm:px-10 py-4 sm:py-8 overflow-visible mb-10"><div class="mb-8"><form id="searchForm" class="max-w-2xl mx-auto"><div class="relative"><svg class="absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400 dark:text-gray-500" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><input id="searchInput" type="text" placeholder="搜索电影、电视剧..." autocomplete="off" class="w-full h-12 rounded-lg bg-gray-50/80 py-3 pl-10 pr-12 text-sm text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-400 focus:bg-white border border-gray-200/50 shadow-sm dark:bg-gray-800 dark:text-gray-300 dark:placeholder-gray-500 dark:focus:bg-gray-700 dark:border-gray-700"><button id="clearQueryBtn" type="button" class="absolute right-3 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors dark:text-gray-500 dark:hover:text-gray-300 hidden" aria-label="清除搜索内容"><svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button></div></form></div><div class="max-w-[95%] mx-auto mt-6 overflow-visible"><section id="searchResultsSection" class="tv-section hidden"><div class="tv-section-head"><h2 class="tv-section-title">搜索结果</h2><div id="searchResultsSummary" class="tv-section-status"></div></div><div id="searchResultsStatus" class="text-center text-gray-500 py-8 dark:text-gray-400 hidden"></div><div id="searchResultsList" class="space-y-6"></div></section><section id="searchHistorySection" class="tv-section hidden"><div class="tv-section-head"><h2 class="tv-section-title">搜索历史</h2><div class="tv-section-actions"><button id="clearHistoryBtn" type="button" class="tv-link-danger">清空</button></div></div><div id="searchHistoryChips" class="flex flex-wrap gap-2"></div></section></div></div></main>',1))],512),[[Wt,!t.value]]),t.value?(U(),Gr(hc,za({key:f.value,bootstrap:et(s)},g.value),null,16,["bootstrap"])):wt("",!0)])]),l("div",ru,[l("nav",au,[l("ul",su,[l("li",nu,[l("button",{type:"button",class:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",onClick:C},[(U(),W("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:yt(["lucide lucide-house h-6 w-6",i.value==="home"?"text-green-600":"text-gray-500"])},[...q[28]||(q[28]=[l("path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"},null,-1),l("path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},null,-1)])],2)),l("span",{class:yt(i.value==="home"?"text-green-600":"text-gray-600")},"首页",2)])]),l("li",ou,[l("button",{type:"button",class:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",onClick:w},[(U(),W("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:yt(["lucide lucide-heart h-6 w-6",i.value==="favorites"?"text-green-600":"text-gray-500"])},[...q[29]||(q[29]=[l("path",{d:"M20.84 4.61c-1.54-1.33-3.77-1.32-5.3.02L12 8.09l-3.54-3.46c-1.53-1.34-3.76-1.35-5.3-.02-1.73 1.5-1.84 4.08-.35 5.74L12 21l9.19-10.65c1.49-1.66 1.38-4.24-.35-5.74z"},null,-1)])],2)),l("span",{class:yt(i.value==="favorites"?"text-green-600":"text-gray-600")},"收藏",2)])]),l("li",iu,[l("button",{type:"button",class:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",onClick:H},[(U(),W("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:yt(["lucide lucide-search h-6 w-6",i.value==="search"?"text-green-600":"text-gray-500"])},[...q[30]||(q[30]=[l("circle",{cx:"11",cy:"11",r:"8"},null,-1),l("path",{d:"m21 21-4.3-4.3"},null,-1)])],2)),l("span",{class:yt(i.value==="search"?"text-green-600":"text-gray-600")},"搜索",2)])]),l("li",lu,[l("button",{type:"button",class:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",onClick:_},[(U(),W("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:yt(["lucide lucide-clock h-6 w-6",i.value==="history"?"text-green-600":"text-gray-500"])},[...q[31]||(q[31]=[l("circle",{cx:"12",cy:"12",r:"10"},null,-1),l("path",{d:"M12 6v6l4 2"},null,-1)])],2)),l("span",{class:yt(i.value==="history"?"text-green-600":"text-gray-600")},"历史",2)])]),l("li",{class:"flex-shrink-0",style:{width:"20vw","min-width":"20vw"}},[l("button",{type:"button",class:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",onClick:S},[...q[32]||(q[32]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-settings h-6 w-6 text-gray-500"},[l("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.51a2 2 0 0 1 1-1.72l.15-.1a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),l("circle",{cx:"12",cy:"12",r:"3"})],-1),l("span",{class:"text-gray-600"},"设置",-1)])])])])])]),l("div",cu,[l("div",uu,[q[38]||(q[38]=vt('<aside class="sidebar bg-white/70 dark:bg-[#0d1624] border-r border-gray-200/60 dark:border-white/10 w-64 p-4 pt-6"><div class="text-xl font-bold text-green-600 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-dashboard"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M3 9h18"></path><path d="M9 21V9"></path></svg> 管理后台 </div><nav class="space-y-1"><a data-admin="site" class="admin-nav nav-item group flex items-center rounded-lg px-3 py-2 text-gray-700 dark:text-gray-100 hover:bg-gray-100/60 dark:hover:bg-white/10 gap-3" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house h-5 w-5 text-gray-500 group-hover:text-green-600 dark:group-hover:text-green-400"><path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"></path><path d="M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg><span class="nav-label">站点设置</span></a><a data-admin="user" class="admin-nav nav-item group flex items-center rounded-lg px-3 py-2 text-gray-700 dark:text-gray-100 hover:bg-gray-100/60 dark:hover:bg-white/10 gap-3" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users h-5 w-5 text-gray-500 group-hover:text-green-600 dark:group-hover:text-green-400"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg><span class="nav-label">用户管理</span></a><a data-admin="video" class="admin-nav nav-item group flex items-center rounded-lg px-3 py-2 text-gray-700 dark:text-gray-100 hover:bg-gray-100/60 dark:hover:bg-white/10 gap-3" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-film h-5 w-5 text-gray-500 group-hover:text-green-600 dark:group-hover:text-green-400"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M7 3v18"></path><path d="M3 7.5h4"></path><path d="M3 12h18"></path><path d="M3 16.5h4"></path><path d="M17 3v18"></path><path d="M17 7.5h4"></path><path d="M17 16.5h4"></path></svg><span class="nav-label">视频源管理</span></a><a data-admin="live" class="admin-nav nav-item group flex items-center rounded-lg px-3 py-2 text-gray-700 dark:text-gray-100 hover:bg-gray-100/60 dark:hover:bg-white/10 gap-3" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-radio h-5 w-5 text-gray-500 group-hover:text-green-600 dark:group-hover:text-green-400"><path d="M4.9 19.1C1 15.2 1 8.8 4.9 4.9"></path><path d="M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5"></path><circle cx="12" cy="12" r="2"></circle><path d="M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5"></path><path d="M19.1 4.9C23 8.8 23 15.1 19.1 19"></path></svg><span class="nav-label">直播源管理</span></a></nav></aside>',1)),l("div",du,[q[37]||(q[37]=l("div",{class:"flex items-center justify-between px-6 py-4 border-b border-gray-200/70 dark:border-white/10 bg-white/80 dark:bg-[#0d1624]/80 backdrop-blur-md"},[l("div",{class:"text-lg font-semibold text-gray-800 dark:text-gray-100"},"站点配置"),l("div",{class:"flex items-center gap-3"},[l("button",{id:"adminBackBtn",class:"px-3 py-1.5 rounded-lg text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-white/10 dark:text-gray-100 dark:hover:bg-white/15"},"返回首页")])],-1)),l("div",pu,[l("section",fu,[q[35]||(q[35]=vt('<h3 class="text-base font-semibold text-gray-800 dark:text-gray-100 mb-4 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-settings h-5 w-5"><path d="M12 15v.01"></path><path d="M12 3v2"></path><path d="m14.6 4.5-1 1.73"></path><path d="M18.4 7l-1.73 1"></path><path d="M21 12h-2"></path><path d="m19.4 17-1.73-1"></path><path d="m14.6 19.5-1-1.73"></path><path d="M12 19v2"></path><path d="m9.4 19.5 1-1.73"></path><path d="M4.6 17l1.73-1"></path><path d="M3 12h2"></path><path d="m4.6 7 1.73 1"></path><path d="m9.4 4.5 1 1.73"></path><circle cx="12" cy="12" r="3"></circle></svg> 站点设置 </h3>',1)),l("div",hu,[l("div",null,[q[33]||(q[33]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1"},"站点名称",-1)),l("input",{class:"w-full rounded-lg border border-gray-300 dark:border-white/10 bg-white dark:bg-[#0f172a] px-3 py-2 text-sm text-gray-900 dark:text-gray-100",placeholder:et(s).siteName},null,8,vu)]),q[34]||(q[34]=vt('<div><label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">站点公告</label><textarea rows="3" class="w-full rounded-lg border border-gray-300 dark:border-white/10 bg-white dark:bg-[#0f172a] px-3 py-2 text-sm text-gray-900 dark:text-gray-100" placeholder="本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性负责。"></textarea></div><div><label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">豆瓣数据代理</label><select class="w-full rounded-lg border border-gray-300 dark:border-white/10 bg-white dark:bg-[#0f172a] px-3 py-2 text-sm text-gray-900 dark:text-gray-100"><option>豆瓣 CDN By CMLiussss（腾讯云）</option><option>官方直连</option><option>自定义代理</option></select><p class="text-xs text-gray-500 dark:text-gray-400 mt-1">选择获取豆瓣数据的方式</p></div><div><label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">豆瓣图片代理</label><select class="w-full rounded-lg border border-gray-300 dark:border-white/10 bg-white dark:bg-[#0f172a] px-3 py-2 text-sm text-gray-900 dark:text-gray-100"><option>豆瓣 CDN By CMLiussss（腾讯云）</option><option>官方直连</option><option>自定义代理</option></select><p class="text-xs text-gray-500 dark:text-gray-400 mt-1">选择获取豆瓣图片的方式</p></div><div><label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">搜索接口可拉取最大页数</label><input class="w-full rounded-lg border border-gray-300 dark:border-white/10 bg-white dark:bg-[#0f172a] px-3 py-2 text-sm text-gray-900 dark:text-gray-100" placeholder="5"></div>',4))])]),q[36]||(q[36]=vt('<section id="adminUser" class="admin-panel hidden"><div class="text-sm text-gray-500 dark:text-gray-400">用户管理内容占位</div></section><section id="adminVideo" class="admin-panel hidden"><div class="text-sm text-gray-500 dark:text-gray-400">视频源管理内容占位</div></section><section id="adminLive" class="admin-panel hidden"><div class="text-sm text-gray-500 dark:text-gray-400">直播源管理内容占位</div></section>',3))])])])]),Tr(jo,{bootstrap:et(s)},null,8,["bootstrap"])]))}};(async()=>{const a=await Va("index");a&&a.siteName&&(document.title=a.siteName),Ua(gu,{bootstrap:a}).mount("#app")})();
